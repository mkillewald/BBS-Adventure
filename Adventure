/**************************************************************************\
    $VER: BBS Adventure, v0.4 (Jul-11-2019) by k1ds3ns4t10n of P H E N O M 
\**************************************************************************/
options results;signal on SYNTAX;signal on ERROR;signal on IOERR
a=sourceline(2);parse var a . ", "ver" ("vdate")" .
tr=transmit;se=sendstring;gc=getchar;gu=getuser;gs=getscratch;mg=maygetchar
parse source . . fp .; df=left(fp,max(lastpos('/',fp),lastpos(':',fp)))
changewhere "BBS Adventure "||ver
/**************************************************************************\
**                                                                        **
**  BBS Adventure                              -X-caliber BBS             **
**    a PHENOM PRODUCTIONS release               bbs.aholix.net:6800      **
**    by k1ds3ns4t10n (Mike Killewald)                                    **
**                                                                        **
**  A tribute to Adventure for the Atari 2600                             **
**    by Warren Robinett                                                  **
**                                                                        **
**  Change Log:                                                           **
**    v0.4 Jul-24-2019 flashlight optimized, inverse draw routines        **
**                     optimized, dragon code started but not yet         **
**                     enabled                                            **
**    v0.3 Jul-11-2019 bat 100% working, fixed grab object at edge of     **
**                     screen on entering new room bug                    **
**    v0.2 Jun-23-2019 added bridge, chalice, magnet and magic dot        **
**                     added ability to grab item at edge of wall         **
**                     added messages and secret room activation          **
**    v0.1 Jun-16-2019 first public demo 70% complete                     **
**    v0.0 Jun-5-2019  first version                                      **
**                                                                        **
\**************************************************************************/

/* debug switches */
debug=0         /* 0 = disable debug mode,   1 = enable debug mode   */
debug_flash=0   /* 0 = disable flash debug,  1 = enable flash debug  */
debug_magnet=0  /* 0 = disable magnet debug, 1 = enable magnet debug */
debug_bat=0     /* 0 = disable bat debug,    1 = enable bat debug    */
debug_dragon=0  /* 0 = disable dragon debug, 1 = enable dragon debug */

/* system options */
flashlight=3    /* 0=disabled, 1=small, 2=medium, 3=large (default) */
bat_enable=0    /* 0=bat disabled, 1=bat enabled (default) */
dragon_enable=0 /* 0=dragons disabled, 1=dragons enabled (default) */

/* default game settings */
difficulty=1    /* 1=level 1 (default), 2=level 2, 3=level 3 */
attack=0        /* 0=dragons delay before attack (default), 1=dragons attack instantly */
fear=0          /* 0=dragons do not fear sword (default), 1=dragons fear sword */ 

/* dragon attack delay */
instantattack=1.5 /* 1.5 seconds */
delayedattack=3   /* 3 seconds */

/* player state constants */
PL_ALIVE=0
PL_DEAD=1

/* dragon state constants */
DR_ALIVE=0
DR_ATTACK=1
DR_DEAD=2
DR_FULL=3

/* direction constants */
D_LEFT=-1
D_RIGHT=1
D_UP=-1
D_DOWN=1

/* other defined constants */
MAP_SHIFT=-1
N1=-1 /* used for representing -1 as a node name */

/* used for boundary checks only! */
/* changing these values will not */ 
/* adapt the users display        */
minline=1; maxline=24; mincol=2; maxcol=79; castleline=16

clear_scr="[40mf1@4" /* black background, clear screen, disable more */
park="f0" /* RETURNs cursor to home position without clearing screen */

menu_yadv=1  /* menu y advance */
obj.pl.room=0  /* splash screen */
game_running=0;
difftotal=0 

CALL RANDOM(,,time('s'))  /* seed random number generator */
CALL DRAW_PHENOM
CALL INIT_KINGDOM
CALL DRAW_BG
/* CALL DELAY(15) */

/* option items text */
attack_items.0="delayed"
attack_items.1="instant"
fear_items.0="off"
fear_items.1=" on"

indicator.f = ">"  /* forward indicator */
indicator.b = "<"  /* back indicator */

/** MENU SYSTEM **/
MAIN_MENU:
  tab.cur=0
  mpos.x=27; mpos.y=7  /* menu top left corner */
  item.x=mpos.x+4; item.y=mpos.y+3; /* current item position */
  item.cur=0; item.tot=5  /* current item, total items */
  indicator.cur=indicator.f
  item.hc="[40;37;1m"  /* item highight color */
  item.nc="[0;40;37m "  /* item normal color */
  
  IF game_running==0 THEN CALL MAIN_ITEMS
  ELSE CALL IN_GAME_ITEMS

  se "[" || mpos.y + 0|| ";" || mpos.x || "H[1;40;30m€ﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂ€[0m"
  se "[" || mpos.y + 1|| ";" || mpos.x || "H[1;40;30m€ [33mBBS Adventure       " || ver || " [30m€[0m"
  se "[" || mpos.y + 2|| ";" || mpos.x || "H[1;40;30m€                          [1;30m€[0m"
  se "[" || mpos.y + 3|| ";" || mpos.x || "H[1;40;30m€   "||item.hc||indicator.cur||mitem.0||"   [1;30m€[0m"
  se "[" || mpos.y + 4|| ";" || mpos.x || "H[1;40;30m€   "||item.nc||mitem.1||"   [1;30m€[0m"
  se "[" || mpos.y + 5|| ";" || mpos.x || "H[1;40;30m€   "||item.nc||mitem.2||"   [1;30m€[0m"
  se "[" || mpos.y + 6|| ";" || mpos.x || "H[1;40;30m€   "||item.nc||mitem.3||"   [1;30m€[0m"
  se "[" || mpos.y + 7|| ";" || mpos.x || "H[1;40;30m€   "||item.nc||mitem.4||"   [1;30m€[0m"
  se "[" || mpos.y + 8|| ";" || mpos.x || "H[1;40;30m€                          [1;30m€[0m"
  se "[" || mpos.y + 9|| ";" || mpos.x || "H[1;40;30m€ [36mbbs[22m.[1maholix[22m.[1mnet [22mPort:[1m6800 [30m€"
  se "[" || mpos.y + 10|| ";" || mpos.x || "H[1;40;30m€‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹€[0m"
  se park
  
  /* main menu loop */
  DO FOREVER
    mg
    IF result~="NOCHAR" THEN d=C2D(result)
    ELSE d=-999
    SELECT
      WHEN d==113 THEN SIGNAL QUIT               /* q */
      WHEN d==111 THEN SIGNAL OPTIONS            /* o */
      WHEN d==99 THEN SIGNAL CONTROLS            /* c */
      WHEN d==98 THEN SIGNAL ABOUT               /* b */
      WHEN d==103 THEN DO 
        IF game_running==0 THEN SIGNAL START   /* g  Start Game  */
        ELSE DO                                /* g  Resume Game */
          CALL REFRESH
          SIGNAL RESUME
        END                    
      END
      WHEN game_running==1 & d==114 THEN SIGNAL REINCARNATE  /* r */
      WHEN d==32 | d==13 THEN DO                 /* Space or Enter */
        IF game_running==0 THEN CALL MAIN_SELECT
        ELSE CALL IN_GAME_SELECT
      END
      WHEN d==97 | d==68 THEN CALL PREV_TAB  /* a or <-- "D" */
      WHEN d==100 | d==67 THEN CALL NEXT_TAB /* d or --> "C" */
      WHEN d==119 | d==65 THEN DO  /* w or up arrow "A" */
        IF item.cur==4 THEN indicator.cur=indicator.f         
        CALL PREV_ITEM
      END
      WHEN d==115 | d==66 THEN DO  /* s or down arrow "B" */
        IF item.cur==3 THEN indicator.cur=indicator.b
        CALL NEXT_ITEM
      END
      OTHERWISE NOP
    END
  
    CALL CHECK
  END                           
RETURN 

MAIN_ITEMS:
  mitem.0=" Start [32mG[37mame        "  
  mitem.1=" [32mO[37mptions           "  
  mitem.2=" [32mC[37montrols          "  
  mitem.3=" A[32mb[37mout             "  
  mitem.4=" [32mQ[37muit to BBS       "  
RETURN

MAIN_SELECT:
  SELECT
    WHEN item.cur==0 THEN SIGNAL START
    WHEN item.cur==1 THEN SIGNAL OPTIONS
    WHEN item.cur==2 THEN SIGNAL CONTROLS
    WHEN item.cur==3 THEN SIGNAL ABOUT
    WHEN item.cur==4 THEN SIGNAL QUIT
    OTHERWISE NOP
  END
RETURN

IN_GAME_ITEMS:
  mitem.0=" Back to [32mG[37mame      "  
  mitem.1=" [32mO[37mptions           "  
  mitem.2=" [32mC[37montrols          "  
  mitem.3=" [32mR[37meincarnate       "  
  mitem.4=" [32mQ[37muit to BBS       "  
RETURN

IN_GAME_SELECT:
  SELECT
    WHEN item.cur==0 THEN DO
      CALL REFRESH
      SIGNAL RESUME
    END
    WHEN item.cur==1 THEN SIGNAL OPTIONS
    WHEN item.cur==2 THEN SIGNAL CONTROLS
    WHEN item.cur==3 THEN SIGNAL REINCARNATE
    WHEN item.cur==4 THEN SIGNAL QUIT
    OTHERWISE NOP
  END
RETURN

OPTIONS:
  tab.cur=1
  mpos.x=27; mpos.y=7  /* menu top left corner */
  IF game_running==0 THEN DO
    item.x=mpos.x+4; item.y=mpos.y+2; /* current item position */
    item.cur=0; item.tot=4  /* current item, total items */
  END
  ELSE DO
    item.cur=3;
  END
  indicator.cur = indicator.f
  item.hc="[40;37;1m"  /* item highight color */
  item.nc="[0;40;37m "  /* item normal color */ 
  CALL OPTIONS_ITEMS  
  se "[" || mpos.y + 0|| ";" || mpos.x || "H[0;1;40;30m€ﬂ[43m [33mOptions [40;30mﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂ€"
  se "[" || mpos.y + 1|| ";" || mpos.x || "H[1;40;30m€                          €"  
  IF game_running==0 THEN se "[" || mpos.y + 2|| ";" || mpos.x || "H[1;40;30m€   "||item.hc||indicator.cur||mitem.0||"   [1;30m€[0m"
  ELSE se "[" || mpos.y + 2|| ";" || mpos.x || "H[1;40;30m€   "||item.nc||mitem.0||"   [1;30m€[0m"
  se "[" || mpos.y + 3|| ";" || mpos.x || "H[1;40;30m€   "||item.nc||mitem.1||"   [1;30m€[0m"
  se "[" || mpos.y + 4|| ";" || mpos.x || "H[1;40;30m€   "||item.nc||mitem.2||"   [1;30m€[0m"  
  se "[" || mpos.y + 5|| ";" || mpos.x || "H[1;40;30m€                          €"
  se "[" || mpos.y + 6|| ";" || mpos.x || "H[1;40;30m€                          €"
  se "[" || mpos.y + 7|| ";" || mpos.x || "H[1;40;30m€                          €"
  se "[" || mpos.y + 8|| ";" || mpos.x || "H[1;40;30m€                          €"
  IF game_running==0 THEN se "[" || mpos.y + 9|| ";" || mpos.x || "H[1;40;30m€   "||item.nc||mitem.3||"  [1;30m€"
  ELSE se "[" || mpos.y + 9|| ";" || mpos.x || "H[1;40;30m€   "||item.hc||indicator.b||mitem.3||"  [1;30m€"
  se "[" || mpos.y + 10|| ";" || mpos.x || "H[1;40;30m€‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹€"
  if game_running==0 THEN DO 
    CALL DIFFQUIP
  END
  CALL DIFFBAR
  se park
  
  /* options menu loop */
  DO FOREVER
    mg
    IF result~="NOCHAR" THEN d=C2D(result)
    ELSE d=-999
    SELECT
      WHEN d==113 | d==98 THEN SIGNAL MAIN_MENU  /* q or b (Back to main) */
      WHEN d==103 THEN DO 
        IF game_running==0 THEN SIGNAL START   /* g  Start Game  */
        ELSE DO                                /* g  Resume Game */
          CALL REFRESH
          SIGNAL RESUME
        END 
      END
      WHEN game_running==0 & d==105 THEN CALL SHORTCUT_OPTIONS_SELECT(0,2) /* i (Difficulty)   */
      WHEN game_running==0 & d==107 THEN CALL SHORTCUT_OPTIONS_SELECT(1,3) /* k (Attack)       */
      WHEN game_running==0 & d==102 THEN CALL SHORTCUT_OPTIONS_SELECT(2,4) /* f (Sword Fear)   */
      WHEN d==32 | d==13 THEN CALL OPTIONS_SELECT  /* Space or Enter */
      WHEN d==97 | d==68 THEN CALL PREV_TAB  /* a or <-- "D" */
      WHEN d==100 | d==67 THEN CALL NEXT_TAB  /* d or --> "C" */
      WHEN game_running==0 & (d==119 | d==65) THEN DO  /* w or up arrow "A"*/
        indicator.cur=indicator.f
        IF item.cur==3 THEN DO
          menu_yadv=5
        END  
        CALL OPTIONS_ITEMS
        CALL PREV_ITEM
        CALL QUIP_SELECT
      END
      WHEN game_running==0 & (d==115 | d==66) THEN DO  /* s or down arrow "B" */
        IF item.cur==2 THEN DO
          menu_yadv=5
          indicator.cur=indicator.b
        END
        ELSE indicator.cur=indicator.f
        CALL OPTIONS_ITEMS
        CALL NEXT_ITEM
        CALL QUIP_SELECT
      END
      OTHERWISE NOP
    END 
    CALL CHECK
  END
RETURN

OPTIONS_ITEMS:
  IF game_running==0 THEN DO
    mitem.0=" [37mD[32mi[37mfficulty:   [36m" || difficulty || "   "
    mitem.1=" [37mAttac[32mk[37m: [36m" || attack_items.attack || "   "
    mitem.2=" [37mSword [32mF[37mear: [36m" || fear_items.fear || "   "
    mitem.3=" [32mB[37mack to Main Menu  "
  END
  ELSE DO
    mitem.0=" [37mDifficulty:   [36m" || difficulty || "   "
    mitem.1=" [37mAttack: [36m" || attack_items.attack || "   "
    mitem.2=" [37mSword Fear: [36m" || fear_items.fear || "   "
    mitem.3=" [32mB[37mack to Main Menu  "
  END
RETURN

SHORTCUT_OPTIONS_SELECT:
  ARG item_to_activate, item_y_pos
  i=item.cur
  se "["||item.y||";"||item.x||"H"||item.nc||mitem.i
  item.cur=item_to_activate; item.x=mpos.x+4; item.y=mpos.y+item_y_pos;
  i = item.cur; indicator.cur=indicator.f
  se "["||item.y||";"||item.x||"H"||item.hc||indicator.cur||mitem.i
  CALL OPTIONS_SELECT
RETURN

OPTIONS_SELECT:
  SELECT
    WHEN item.cur==0 THEN CALL OPTIONS0
    WHEN item.cur==1 THEN CALL OPTIONS1
    WHEN item.cur==2 THEN CALL OPTIONS2
    WHEN item.cur==3 THEN SIGNAL MAIN_MENU
    OTHERWISE NOP
  END
RETURN

DIFFBAR:
  difftotal=0
  SELECT
    WHEN difficulty==1 THEN difftotal=difftotal+2
    WHEN difficulty==2 THEN difftotal=difftotal+6
    WHEN difficulty==3 THEN difftotal=difftotal+10
  END
  IF attack==1 THEN difftotal=difftotal+4
  IF fear==1 THEN difftotal=difftotal+4
  SELECT
    WHEN difftotal<=2 THEN diffbar="[0;32m˛˛[1;30m                "
    WHEN difftotal>2 & difftotal<=4 THEN diffbar="[0;32m˛˛˛˛[1;30m              "
    WHEN difftotal>4 & difftotal<=6 THEN diffbar="[1;32m˛˛˛˛˛˛[30m            "
    WHEN difftotal>6 & difftotal<=8 THEN diffbar="[1;32m˛˛˛˛˛˛˛˛[30m          "
    WHEN difftotal>8 & difftotal<=10 THEN diffbar="[1;33m˛˛˛˛˛˛˛˛˛˛[30m        "
    WHEN difftotal>10 & difftotal<=12 THEN diffbar="[1;33m˛˛˛˛˛˛˛˛˛˛˛˛[30m      "
    WHEN difftotal>12 & difftotal<=14 THEN diffbar="[1;31m˛˛˛˛˛˛˛˛˛˛˛˛˛˛[30m    "
    WHEN difftotal>14 & difftotal<=16 THEN diffbar="[1;31m˛˛˛˛˛˛˛˛˛˛˛˛˛˛˛˛[1;30m  "
    WHEN difftotal>16 & difftotal<=18 THEN diffbar="[1;31m˛˛˛˛˛˛˛˛˛˛˛˛˛˛˛˛˛˛"
    OTHERWISE NOP
  END
  IF game_running=0 THEN row=8
  ELSE row=7
  se "[" || mpos.y + row || ";" || mpos.x + 4 || "H[1;40;30m[" || diffbar || "[1;30m]"
  se park
RETURN

QUIP_SELECT:
  SELECT
    WHEN item.cur==0 THEN CALL DIFFQUIP
    WHEN item.cur==1 THEN CALL ATTACKQUIP
    WHEN item.cur==2 THEN CALL FEARQUIP
    OTHERWISE CALL CLEARQUIP
  END
RETURN

CLEARQUIP:
  se "[" || mpos.y + 6 || ";" || mpos.x + 4 || "H" || "                    "
  se "[" || mpos.y + 7 || ";" || mpos.x + 4 || "H" || "                    "
  se park
RETURN

DIFFQUIP:
  diffquip.1="2 castles, 2 dragons,"
  diffquip.2="no bat, small kingdom"
  diffquip.3="3 castles, 3 dragons,"
  diffquip.4="1 bat, full kingdom  " 
  diffquip.5="3 castles, 3 dragons,"
  diffquip.6="1 bat, random objects"
  
  i= difficulty + (difficulty-1)
  j= i+1
  se "[0;36m"
  se "[" || mpos.y + 6 || ";" || mpos.x + 4 || "H" || diffquip.i
  se "[" || mpos.y + 7 || ";" || mpos.x + 4 || "H" || diffquip.j
  se park
RETURN

ATTACKQUIP:  
  attackquip.0="dragons wait a bit   "
  attackquip.1="before attacking     "
  attackquip.2="dragons attack       "
  attackquip.3="instantly            "
  
  i=attack*2
  j=i+1
  se "[0;36m"
  se "[" || mpos.y + 6 || ";" || mpos.x + 4 || "H" || attackquip.i
  se "[" || mpos.y + 7 || ";" || mpos.x + 4 || "H" || attackquip.j
  se park
RETURN

FEARQUIP:  
  fearquip.0="dragons do not fear  "
  fearquip.1="the sword            "
  fearquip.2="dragons run from the "
  fearquip.3="sword                "
  
  i=fear*2
  j=i+1
  se "[0;36m"
  se "[" || mpos.y + 6 || ";" || mpos.x + 4 || "H" || fearquip.i
  se "[" || mpos.y + 7 || ";" || mpos.x + 4 || "H" || fearquip.j
  se park
RETURN

OPTIONS0:  /* difficulty */
  IF game_running==1 THEN RETURN
  IF difficulty==3 THEN difficulty=1 
  ELSE difficulty=difficulty+1
  IF item.cur==0 THEN intensity=1
  ELSE intensity=0    
  se "[" || mpos.y + 2 || ";" || mpos.x + 20 || "H[" || intensity || ";36m" || difficulty
  CALL DIFFQUIP
  CALL DIFFBAR
RETURN

OPTIONS1:  /* dragon attack */
  IF game_running==1 THEN RETURN
  IF attack==1 THEN attack=0
  ELSE attack=attack+1
  IF item.cur==1 THEN intensity=1
  ELSE intensity=0
  se "[" || mpos.y + 3 || ";" || mpos.x + 14 || "H[" || intensity || ";36m" || attack_items.attack
  CALL ATTACKQUIP
  CALL DIFFBAR
RETURN

OPTIONS2:  /* sword fear */
  IF game_running==1 THEN RETURN
  IF fear==1 THEN fear=0
  ELSE fear=fear+1
  IF item.cur==2 THEN intensity=1
  ELSE intensity=0    
  se "[" || mpos.y + 4 || ";" || mpos.x + 18 || "H[" || intensity || ";36m" || fear_items.fear
  CALL FEARQUIP
  CALL DIFFBAR
RETURN

CONTROLS:
  tab.cur=2
  mpos.x=27; mpos.y=7  /* menu top left corner */
  item.x=mpos.x+4; item.y=mpos.y+9; /* current item position */
  item.cur=0; item.tot=1  /* current item, total items */
  se "[" || mpos.y + 0|| ";" || mpos.x || "H[0;1;40;30m€ﬂﬂﬂﬂﬂﬂﬂﬂ[0;43;30m [1;33mControls [40;30mﬂﬂﬂﬂﬂﬂﬂﬂ€"
  se "[" || mpos.y + 1|| ";" || mpos.x || "H€[1;36m Move/       Select/Drop: [1;30m€"
  se "[" || mpos.y + 2|| ";" || mpos.x || "H€[1;36m Navigate:    [32mEnter  [0mor   [1;30m€"
  se "[" || mpos.y + 3|| ";" || mpos.x || "H€[1;32m   W          [32mSpacebar    [1;30m€"
  se "[" || mpos.y + 4|| ";" || mpos.x || "H€[1;32m  A S D                   [1;30m€"
  se "[" || mpos.y + 5|| ";" || mpos.x || "H€[0m   or        [1;36mIn Game:     [1;30m€"
  se "[" || mpos.y + 6|| ";" || mpos.x || "H€[1;32m  cursor       M[0menu        [1;30m€"
  se "[" || mpos.y + 7|| ";" || mpos.x || "H€[1;32m  keys        [32mR[0medraw      [1;30m€"
  se "[" || mpos.y + 8|| ";" || mpos.x || "H€[1;30m                          [1;30m€"
  se "[" || mpos.y + 9|| ";" || mpos.x || "H€[1;37m   < [32mB[37mack to Main Menu    [1;30m€"
  se "[" || mpos.y + 10|| ";" || mpos.x || "H€‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹‹€"
  se park
  
  /* controls menu loop */
  DO FOREVER
    mg
    IF result~="NOCHAR" THEN d=C2D(result)
    ELSE d=-999
    SELECT
      WHEN d==113 | d==98 THEN SIGNAL MAIN_MENU  /* q or b Back to Main Menu */
      WHEN d==103 THEN DO 
        IF game_running==0 THEN SIGNAL START   /* g  Start Game  */
        ELSE DO                                /* g  Resume Game */
          CALL REFRESH
          SIGNAL RESUME
        END 
      END
      WHEN d==32 | d==13 THEN CALL CONTROLS_SELECT  /* Space or Enter */
      WHEN d==97 | d==68 THEN CALL PREV_TAB   /* a or <-- "D" */
      WHEN d==100 | d==67 THEN CALL NEXT_TAB  /* d or --> "C" */
      WHEN d==119 | d==65 THEN CALL PREV_ITEM  /* w or up arrow "A" */
      WHEN d==115 | d==66 THEN CALL NEXT_ITEM  /* s or down arrow "B" */
      OTHERWISE NOP
    END
  
    CALL CHECK
  END
RETURN

CONTROLS_SELECT:
  SELECT
    WHEN item.cur==0 THEN SIGNAL MAIN_MENU
    OTHERWISE NOP
  END
RETURN

ABOUT:
  tab.cur=3
  mpos.x=27; mpos.y=7  /* menu top left corner */
  item.x=mpos.x+4; item.y=mpos.y+9; /* current item position */
  item.cur=0; item.tot=1  /* current item, total items */
  se "[" || mpos.y + 0|| ";" || mpos.x || "H[0;1;40;30m€ﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂ[0;43;30m [1;33mAbout [40;30mﬂ€"
  se "[" || mpos.y + 1|| ";" || mpos.x || "H€[1;33m BBS Adventure       " || ver || " [30m€"
  se "[" || mpos.y + 2|| ";" || mpos.x || "H€[0;36m a [1;37mPHENOM PRODUCTIONS     [1;30m€"
  se "[" || mpos.y + 3|| ";" || mpos.x || "H€[0;36m release by [1;37mk1ds3ns4t10n  [1;30m€"
  se "[" || mpos.y + 4|| ";" || mpos.x || "H€[0;36m of: [1;36m-X-[0;36mcaliber BBS       [1;30m€"
  se "[" || mpos.y + 5|| ";" || mpos.x || "H€[0;36m     bbs.aholix.net:6800  [1;30m€"
  se "[" || mpos.y + 6|| ";" || mpos.x || "H€[0;36m much love and respect to [1;30m€"
  se "[" || mpos.y + 7|| ";" || mpos.x || "H€[0;36m Adventure on the Atari   [1;30m€"
  se "[" || mpos.y + 8|| ";" || mpos.x || "H€[0;36m 2600 by: [1;36mWarren Robinett [1;30m€"
  se "[" || mpos.y + 9|| ";" || mpos.x || "H€[1;37m   < [32mB[37mack to Main Menu    [30m€"
  se park
  
  /* about menu loop */
  DO FOREVER
    mg
    IF result~="NOCHAR" THEN d=C2D(result)
    ELSE d=-999
    SELECT
      WHEN d==113 | d==98 THEN SIGNAL MAIN_MENU  /* q or b Back to Main Menu */
      WHEN d==103 THEN DO 
        IF game_running==0 THEN SIGNAL START   /* g  Start Game  */
        ELSE DO                                /* g  Resume Game */
          CALL REFRESH
          SIGNAL RESUME
        END  
      END
      WHEN d==32 | d==13 THEN CALL ABOUT_SELECT  /* Space or Enter */ 
      WHEN d==97 | d==68 THEN CALL PREV_TAB  /* a or <-- "D" */
      WHEN d==100 | d==67 THEN CALL NEXT_TAB  /* d or --> "C" */
      WHEN d==119 | d==65 THEN CALL PREV_ITEM  /* w or up arrow "A" */
      WHEN d==115 | d==66 THEN CALL NEXT_ITEM  /* s or down arrow "B" */
      OTHERWISE NOP
    END 
    CALL CHECK
  END
RETURN

ABOUT_SELECT:
  SELECT
    WHEN item.cur==0 THEN SIGNAL MAIN_MENU
    OTHERWISE NOP
  END
RETURN

NEXT_ITEM:
  IF item.cur==item.tot-1 THEN RETURN  
  i = item.cur  
  se "["||item.y||";"||item.x||"H"||item.nc||mitem.i
  item.cur = item.cur + 1
  item.y = item.y + menu_yadv
  menu_yadv=1  /* after using menu_yadv, RETURN it to default value */ 
  i = item.cur
  se "["||item.y||";"||item.x||"H"||item.hc||indicator.cur||mitem.i
  se park
RETURN

PREV_ITEM:
  IF item.cur==0 THEN RETURN  
  i = item.cur  
  se "["||item.y||";"||item.x||"H"||item.nc||mitem.i
  item.cur = item.cur - 1
  item.y = item.y - menu_yadv
  menu_yadv=1  /* after using menu_yadv, RETURN it to default value */
  i = item.cur
  se "["||item.y||";"||item.x||"H"||item.hc||indicator.cur||mitem.i
  se park
RETURN

NEXT_TAB:
  IF tab.cur==3 THEN RETURN  
  tab.cur = tab.cur + 1
  CALL TAB_JUMP
RETURN

PREV_TAB:
  IF tab.cur==0 THEN RETURN;  
  tab.cur = tab.cur - 1
  CALL TAB_JUMP
RETURN

TAB_JUMP:
  SELECT
    WHEN tab.cur==0 THEN SIGNAL MAIN_MENU
    WHEN tab.cur==1 THEN SIGNAL OPTIONS
    WHEN tab.cur==2 THEN SIGNAL CONTROLS
    WHEN tab.cur==3 THEN SIGNAL ABOUT
    OTHERWISE NOP
  END
RETURN

DRAW_PHENOM:
  se clear_scr
  CALL PHENOM_LOGO
  displayed=":"
  count=0
  start= time('r')
  DO WHILE count<phenommaxline
    line= RANDOM(1, phenommaxline)
    IF INDEX(displayed, ":"||line||":")==0 THEN DO
      displayed=displayed||line||":"
      count=count+1
      se "["||6+line||";1H"||phenom.line
      CALL DELAY(2)
    END
    IF time('e') > 1.3 THEN DO
      se "[7;1H"
      DO i=1 TO phenommaxline
        tr phenom.i
      END
      count=999
    END
    CALL CHECK
  END
  se park
  CALL DELAY(75)
RETURN

/* TODO: replace uses of:
     CALL <function>
     RETURN
     
     with:
     SIGNAL <function> */

/** GAME START **/
START:
  start= time('r') /* reset interval timer */
  game_running=1

  CALL INIT_OBJECTS  /* init objects */
  
  IF difficulty==1 THEN DO
    obj.knub.room=0
    maxdragon=1  /* will generate two dragons */  
    obj.rhindle.room=0
  END
  ELSE IF difficulty==2 THEN DO
    CALL EXPAND_KINGDOM
    /* set level 2 item locations */
    obj.ykey.room=9  
    obj.bkey.room=25
    obj.wkey.room=6
    obj.sword.room=17
    obj.bridge.room=11
    obj.chalice.room=20
    obj.magnet.room=14
  END
  ELSE IF difficulty==3 THEN DO
    CALL EXPAND_KINGDOM
    /* randomize item locations */
    DO i=0 TO maxitem  
      o=item.i
      IF obj.o.lvl3.0 ~=0 THEN obj.o.room = RANDOM(obj.o.lvl3.0, obj.o.lvl3.1)
    END
    /* randomize creature locations */
    /* DO i=0 TO maxcreature  
      o=item.i
      IF obj.o.lvl3.0 =0 THEN obj.o.room = random(obj.o.lvl3.0, obj.o.lvl3.1, time('s'))
    END */
  END
  
  IF attack==1 THEN DO
    DO i=0 TO maxdragon
      drago=dragon.i
      obj.drago.atkwait=instantattack
    END
  END
  
  IF fear==1 THEN DO  /* dragons fear SWORD */
    fear.yorgle.max=1
    fear.yorgle.0="SWORD"
    fear.yorgle.1="YKEY"
    fear.grundle.0="SWORD" 
    fear.rhindle.0="SWORD"
  END
    
  REINCARNATE:
  CALL INIT_PLAYER  /* init player */
  CALL INIT_FLASHLIGHT /* init flashlight */
  CALL RESET_DRAGONS

  CALL DRAW_BG
  CALL DRAW_OBJS
  CALL DRAW_PL
  
  /* main loop */
  RESUME:
  DO FOREVER
    obj.pl.dx=0; obj.pl.dy=0; obj.pl.dirx=0; obj.pl.diry=0  /* reset player x,y movement */ 
    
    mg
    IF result~="NOCHAR" THEN d=C2D(result)
    ELSE d=-999
    SELECT
      WHEN d==113 | d==109 THEN CALL MAIN_MENU /* q or m */
      WHEN d==32 | d==13 THEN CALL DROP(1)     /* Space or Enter */
      WHEN d==119 | d==65 THEN obj.pl.diry=-1  /* CALL MV_U */  /* w or up arrow (A) */
      WHEN d==115 | d==66 THEN obj.pl.diry=1   /* CALL MV_D */ /* s or down arrow (B) */
      WHEN d==100 | d==67 THEN obj.pl.dirx=1   /* CALL MV_R */ /* d or --> (C) */
      WHEN d==97 | d==68 THEN obj.pl.dirx=-1   /* CALL MV_L */  /* a or <-- (D) */
      WHEN d==114 THEN CALL REFRESH            /* r */
      WHEN d==112 THEN DO                      /* p */
        IF debug==1 THEN debug=0
        ELSE debug=1
        CALL REFRESH
      END
      OTHERWISE NOP
    END
    
    CALL PLAYER_MOVE
    
    CALL MAGNET_SEEK
    CALL MAGNETISM
    
    IF difficulty~=1 & bat_enable==1 THEN DO
      CALL BAT_SEEK
      CALL BAT_ANIM
      CALL BAT_MOVE
    END
    
    IF dragon_enable>0 THEN DO
      DO i=0 TO maxdragon
        d=dragon.i
        IF obj.d.state>=DR_DEAD THEN ITERATE i
        CALL DRAGON_GUARD(d)
        CALL DRAGON_FLEE(d)
        CALL DRAGON_MOVE(d)
      END
    END
       
    CALL CHECK
  END

QUIT:
  se "[0mf1}"
  exit
  
DEBUG:
  IF game_running~=1 THEN RETURN
  se "[1;2HRoom:"|| rm || " Gates W:" || obj.wgate.locked || " B:" || obj.bgate.locked || " Y:" || obj.ygate.locked
  se "[2;2HExits T:" || k.rm.te || " R:" || k.rm.re || " B:" || k.rm.be || " L:" || k.rm.le || " CI:" || k.rm.ci || " CO:" || k.rm.co
RETURN

DEBUG_PL:
  IF game_running~=1 THEN RETURN
  se "[3;2HPL.X:"||obj.pl.x||" PL.Y:"||obj.pl.y||" PL.DIRX:"||obj.pl.dirx||" PL.DIRY:"||obj.pl.diry||" PL.S:"||obj.pl.state"  "
  IF flashlight>0 & debug_flashl==1 THEN se "[43m[4;2HFlash X:"||obj.light.x||" Y:"||obj.light.y||" W:"||obj.light.w||" H:"||obj.light.h||"        "
RETURN

DEBUG_MAGNET:
  IF game_running~=1 | debug_magnet~=1 THEN RETURN
  dbmwo=obj.magnet.want
  se "[5;2HM.W:" || dbmwo || " M.BUSY:" || obj.magnet.busy|| "             " 
  IF dbmwo~="NONE" THEN se " owDX:" || obj.dbmwo.dx || " owDY:" || obj.dbmwo.dy || "              "
  se "[6;2HC.R:"||obj.chalice.room||" C.X:"||obj.chalice.x||" C.Y:"||obj.chalice.y||" C.DIRX:"||obj.chalice.dirx||" C.DIRY:"||obj.chalice.diry||"     "  
RETURN

DEBUG_BAT:  /* TODO: finish */
  IF game_running~=1 | debug_bat~=1 THEN RETURN
  se "[5;2H"||k.rm.c||"B.R:"||obj.knub.room||" B.X:"||obj.knub.x||" B.Y:"||obj.knub.y||" B.W:"||obj.knub.want||" B.FU:"||obj.knub.fedup||" B.S:"||obj.knub.seek||" B.E:"||obj.knub.equip||" B.DY:"||obj.knub.dy||"     " 
RETURN

DEBUG_DRAGON:  /* TODO: finish */
  IF game_running~=1 | debug_dragon~=1 THEN RETURN
  se "[5;2HY.R:"||obj.yorgle.room||" Y.X:"||obj.yorgle.x||" Y.Y:"||obj.yorgle.y||" Y.DIRX:"||obj.yorgle.dirx||" Y.DIRY:"||obj.yorgle.diry||" Y.W:"||obj.yorgle.want||" Y.F:"||obj.yorgle.fear||"      "
  se "[6;2HY.DX:"||obj.yorgle.dx||" Y.DY:"||obj.yorgle.dy||"        "
RETURN

DEBUG_STEPPER:
  gc
  IF result=="Q" THEN exit
RETURN

REFRESH:  /* redraw entire screen */
  rm=obj.pl.room
  CALL DRAW_BG
  IF flashlight~=0 & k.rm.dark==1 THEN CALL DRAW_FLASHLIGHT
  CALL DRAW_OBJS
  CALL DRAW_PL
RETURN

DRAW_BG:  /* draw background (not in main loop) */
  /* draw layer 0 */
  CALL DRAW_ROOM
  IF DEBUG==1 THEN CALL DEBUG
RETURN
  
DRAW_ROOM:
  se clear_scr
  rm=obj.pl.room
  mp=k.rm.map
  DO i=1 TO maxline
    IF k.rm.dark==1 THEN line="[40m "k.rm.c|| COPIES(" ", maxcol-mincol+1)  /* no need to draw invisible walls */
    ELSE line="[40m "k.rm.c||k.mp.i
    m_index = INDEX(line,"M")
    IF m_index ~=0 & rm~=0 THEN DO
      newline = LEFT(line,m_index-1) || "[0;30;47m€"k.rm.c || RIGHT(line,length(line)-m_index)
      line = newline
    END
    IF i==maxline THEN DO
      se line 
      se park
    END
    ELSE tr line
  END
RETURN

/* TODO: fix equipped object being drawn in wrong room on castle exit if grap/drop occurs on exit */
DRAW_PL:  /* draw player */
  rm=obj.pl.room
  IF rm==0 THEN RETURN
  IF OK2DRAWOBJ("PL")==0 THEN RETURN
  
  CALL DRAW_FLASHLIGHT_WITH_MOTION
  
  CALL EQUIP("PL")  /* handle any equipped object */
  
  /* draw player */
  se "["||obj.pl.y||";"||obj.pl.x||"H"||k.rm.c||"€€"
  
  IF debug==1 THEN CALL DEBUG_PL    
  se park
RETURN

ERASE_PL:
  rm=obj.pl.room
  IF rm==0 THEN RETURN
  mp=k.rm.map 
  
  /* erase equipped object */
  /* TODO: clarify this by moving this into ERASE_OBJECT */
  IF obj.pl.equip~="NONE" THEN CALL ERASE_OBJECT(obj.pl.equip)
  IF obj.pl.equip=="KNUBBERRUB" & obj.knubberrub.equip~="NONE" THEN CALL ERASE_OBJECT(obj.knubberrub.equip)
   
  IF OK2DRAWOBJ("PL")==0 THEN RETURN
    
  /* fix for castle exit player/gate interaction */
  DO j=0 to maxgate
    g=gate.j
    IF COLLIDE_NOW("PL", g)==1 THEN RETURN
  END
  
  /* erase player */  
  line=obj.pl.y
  str = SUBSTR(k.mp.line, obj.pl.x+MAP_SHIFT, obj.pl.w+1)  /* +1 for how width is indexed */
  /* handle the side barriers */
  m_index = INDEX(str,"M")
  IF m_index ~=0 THEN DO
    newstr = LEFT(str,m_index-1) || "[0;30;47m€" || k.rm.c || RIGHT(str,length(str)-m_index)
    str = newstr
  END
  IF flashlight~=0 & k.rm.dark==1 THEN erasecolor="[43m"
  ELSE erasecolor=k.rm.c
  se "["||obj.pl.y||";"||obj.pl.x||"H"||erasecolor||str
RETURN

GET_FLASHLIGHT_SIZE:
  /* determine x,y position of flashlight using player offsets, but we need modify our calculation
     slightly when player is outside of screen bounds,such as when entering a new room  */
  IF obj.pl.x < mincol THEN obj.light.x=mincol-obj.light.offx
  ELSE IF obj.pl.x > maxcol THEN obj.light.x=(maxcol-1)-obj.light.offx
  ELSE obj.light.x=obj.pl.x-obj.light.offx
    
  IF obj.pl.y < minline THEN obj.light.y=minline-obj.light.offy
  ELSE IF obj.pl.y > maxline THEN obj.light.y=maxline-obj.light.offy
  ELSE obj.light.y=obj.pl.y-obj.light.offy
  
  /* determine flashlight width and height */
  obj.light.w=flash_width-1  /* -1 to align with how other obj w is indexed */
  obj.light.h=flash_height-1  /* -1 to align with how other obj h is indexed */
  
  /* finally, we need to clip the flashlight at the screen edges */
  /* handle left screen edge */
  IF obj.light.x<mincol THEN DO
    obj.light.dw=mincol-(obj.light.x)
    obj.light.w=obj.light.w-(obj.light.dw)
    obj.light.x=mincol
  END
  
  /* handle top screen edge */
  IF obj.light.y<minline THEN DO 
    obj.light.dh=minline-(obj.light.y)
    obj.light.h=obj.light.h-(obj.light.dh)
    obj.light.y=minline
  END
  
  /* handle right screen edge */
  IF obj.light.x+obj.light.w>maxcol THEN DO
    obj.light.dw=obj.light.x+obj.light.w-maxcol
    obj.light.w=obj.light.w-obj.light.dw
  END
  
  /* handle bottom screen edge */
  IF obj.light.y+obj.light.h>maxline THEN DO
    obj.light.dh=obj.light.y+obj.light.h-maxline
    obj.light.h=obj.light.h-obj.light.dh
  END
RETURN

DRAW_FLASHLIGHT:  /* used by REFRESH and DRAW_OBJS */
  rm=obj.pl.room
  mp=k.rm.map
  obj.light.room=rm
  IF flashlight==0 | k.rm.dark==0 THEN RETURN
  
  CALL GET_FLASHLIGHT_SIZE
  
  DO i=0 TO obj.light.h
    line=obj.light.y+i
    se "["||line||";"||obj.light.x||"H[0;43;37m"|| SUBSTR(k.mp.line, obj.light.x-1, obj.light.w+1)
  END 
RETURN

/* TODO: clean this up */
DRAW_FLASHLIGHT_WITH_MOTION: /* draw flashlight in motion (erase where its been) */
  rm=obj.pl.room
  mp=k.rm.map
  IF flashlight==0 | k.rm.dark==0 THEN RETURN
  IF obj.light.drawn==0 THEN DO  /* skip drawing flashlight when entering new roon */
    obj.light.drawn=1
    RETURN
  END
  
  CALL GET_FLASHLIGHT_SIZE
  
  drawx=0
  erasex=0
  drawxpos=obj.light.x
  drawy=0
  erasey=0
  loopstart=0
  loopend=obj.light.h
  mapstart=obj.light.x+MAP_SHIFT
  maplength=obj.light.w+1  /* +1 for how obj width is indexed  */
  
  /* check for movement in x direction */
  IF obj.pl.dirx==-1 THEN DO
    /* player and flashlight are moving left */
    IF obj.light.x>=mincol THEN drawx=-1 /* not less than the left edge of screen */
    IF obj.light.x+obj.light.w<maxcol THEN erasex=1  /* not at right edge of screen */
  END
  ELSE IF obj.pl.dirx==1 THEN DO
    /* player and flashlight are moving right */
    IF obj.light.x+obj.light.w<=maxcol THEN drawx=1 /* not greater than the right edge of screen */
    IF obj.light.x>mincol THEN erasex=-1  /* not at left edge of screen */
  END
  
  /* check for movement in y direction */
  IF obj.pl.diry==-1 THEN DO
    /* player and flashlight are moving up */
    drawy=-1
    IF obj.light.y+obj.light.h<maxline THEN DO  /* not at bottom edge of screen */
      erasey=1  
      loopend=obj.light.h+1
    END
  END
  ELSE IF obj.pl.diry==1 THEN DO
    /* dro is moving down */
    drawy=1 
    IF obj.light.y>minline THEN DO   /* not at the top edge of screen */
      erasey=-1
      loopstart=-1
    END
  END
  
  /* loop sets up each line of flashlight */
  DO i=loopstart TO loopend BY 1
    line=obj.light.y+(i) 
    result_str=""
    
    /* handle start of line */ 
    IF erasex==-1 THEN DO     
      IF mapstart-obj.pl.dx < mincol-1 THEN DO
        drawxpos=mincol
        emapstart=mincol
        elength=1
      END
      ELSE DO
        drawxpos=obj.light.x-obj.pl.dx
        emapstart=mapstart-obj.pl.dx
        elength=obj.pl.dx
      END
      result_str=result_str||"[0;47;37m"|| COPIES(" ", elength)
    END
    ELSE IF drawx==-1 THEN DO
      drawxpos=obj.light.x
      result_str=result_str||"[0;43;37m"|| SUBSTR(k.mp.line, mapstart, obj.pl.dx)
    END
    
    /* handle line */
    IF i==-1 THEN DO
      /* this is a line above the flashlight */
      /* check if need to erase top line */
      IF erasey==-1 THEN DO
        result_str=result_str||"[0;47;37m"|| COPIES(" ", maplength)
      END
      ELSE ITERATE i  /* skip this loop iteration */
    END
    ELSE IF i==obj.light.h+1 THEN DO
      /* this is a line below the flashlight */
      /* check if need to erase bottom line */
      IF erasey==1 THEN DO
        result_str=result_str||"[0;47;37m"|| COPIES(" ", maplength)
      END
      ELSE ITERATE i  /* skip this loop iteration */
    END
    ELSE DO
      /* this is a flashlight line */
      IF (i==0 & drawy==-1) | (i==obj.light.h & drawy==1) THEN DO
        
        flashline=SUBSTR(k.mp.line, mapstart, maplength)
        
        /* add new flashlight line */
        result_str=result_str||"[0;43;37m"||flashline
      END
      ELSE DO
        /* skip over already drawn portion of flashlight */
        IF drawx==-1 THEN DO
          skiplength=maplength-obj.pl.dx
        END
        ELSE IF drawx==1 THEN DO
          skiplength=maplength-obj.pl.dx
        END
        ELSE DO
          skiplength=maplength
        END
        result_str=result_str||"["||skiplength||"C"
      END
    END
    
    /* handle end of line */
    IF erasex==1 THEN DO
      IF obj.light.x+obj.light.w < maxcol-1 THEN elength=obj.pl.dx
      ELSE elength=1
      result_str=result_str||"[0;47;37m"|| COPIES(" ", elength)
    END
    ELSE IF drawx==1 THEN DO
      result_str=result_str||"[0;43;37m"|| SUBSTR(k.mp.line, mapstart+maplength-obj.pl.dx, obj.pl.dx)
    END
    
    IF line==maxline THEN result_str=result_str||park  /* fix for flashlight wrapping on last line */
    se "["||line||";"||drawxpos||"H"||result_str
    
    /* check for line collision with other objects */
    /* TODO: optimize this so we're not drawing the flashlight line first and the object line 2nd */
    DO j=0 TO maxdrawitem
      o=item.j
      IF obj.pl.equip~=o & obj.knub.equp~=o & COLLIDE_BY_LINE("LIGHT", line, o)==1 THEN DO
        IF o=="BRIDGE" THEN CALL DRAW_BRIDGE_LINE(line)
        ELSE IF obj.o.type=="dragon" | obj.o.type=="inverse" THEN CALL DRAW_INVERSE_OBJ_LINE(o, line)
        ELSE CALL DRAW_OBJ_LINE(o, line)
      END
    END
  END
RETURN

DRAW_OBJS:  /* draw objects (not in the main loop) */
   CALL DRAW_FLASHLIGHT
  
  /* draw items */
  DO i=0 TO maxitem
    o=item.i
    /* draw objects in current room that are not equipped by player or knubberrub */ 
    IF obj.o.room==obj.pl.room & obj.pl.equip~=o & obj.knubberrub.equip~=o THEN DO
      CALL DRAW_OBJECT(o)
    END
  END  
  /* draw gates */
  DO i=0 TO maxgate
    o=gate.i
    IF obj.o.room==obj.pl.room THEN DO
      CALL draw_gate(o)
    END
  END
  /* draw msg's */
  IF obj.pl.room==30 THEN DO
    IF msg_toggle==1 THEN msg_toggle=0
    ELSE msg_toggle=1
    CALL DRAW_MSG(msg_toggle)
    CALL DRAW_MSG(2)
    CALL DRAW_MSG(3)
  END
  /* draw dead or stuffed dragons */
  DO i=0 TO maxdragon
    d=dragon.i
    IF (obj.d.state==DR_DEAD | obj.d.state=DR_FULL) & obj.knubberrub.equip~=d THEN CALL DRAW_DRAGON(d)
  END
RETURN

OK2DRAWOBJ: /* check if ok to draw object */
  ARG o
  IF obj.o.x<mincol | obj.o.x+obj.o.w>maxcol | obj.o.y<minline | obj.o.y+obj.o.h>maxline THEN RETURN 0 /* don't draw */
  ELSE IF o~="PL" & GATE_COLLIDE(o)==1 THEN RETURN 0  /* dont draw */
  ELSE IF MSG_COLLIDE(o)==1 THEN RETURN 0  /* don't draw */
  ELSE RETURN 1  /* draw item */
RETURN

DRAW_MSG:
  ARG n
  m=msg.n
  rm=obj.pl.room
  DO l=0 TO obj.m.h
    se "["||obj.m.y+l||";"||obj.m.x||"H"||obj.m.col||obj.m.spr.l
  END
  se park
RETURN

/* TODO: fix item interactions */
DRAW_OBJECT:  
  ARG dro
  IF OK2DRAWOBJ(dro)==0 | obj.dro.room ~= obj.pl.room THEN RETURN
  ELSE IF dro=="BRIDGE" THEN SIGNAL DRAW_BRIDGE
  ELSE IF obj.dro.type=="inverse" | obj.dro.type=="dragon" THEN DO
    CALL DRAW_INVERSE_OBJECT(dro)
    RETURN
  END
  ELSE IF dro=="KNUBBERRUB" THEN DO 
    CALL DRAW_BAT
    CALL EQUIP("KNUBBERRUB")
    RETURN
  END
  DO j=0 TO obj.dro.h
    CALL DRAW_OBJ_LINE(dro, obj.dro.y+j)
  END
  se park
RETURN

BUILD_OBJ_LINE:  
  /* requires dro, drawline, spr_str, map_str, map_start, and map_len defined before calling */
  /* sets result_line for use by draw functions */ 
  
  /* TODO: optimize color stacking */
  /* loop through each character of the map string and insert bg color based on map character found */
  result_line=""
  DO m=1 TO map_len
    spr_char = SUBSTR(spr_str, m, 1)
    map_char = SUBSTR(map_str, m, 1)
    SELECT
      WHEN map_char==" " THEN DO
        /* select bgcolor */
        IF flashlight~=0 & k.rm.dark==1 & COLLIDE_BY_CHAR("LIGHT", drawline, map_start+m)==1 THEN bgcolor="[43m"
        ELSE bgcolor=k.rm.bc
        /* select character data */
        IF spr_char=="E" THEN char_data=map_char
        ELSE char_data=spr_char
        result_line=result_line||obj.dro.col||bgcolor||char_data
      END
      WHEN map_char=="€" THEN DO
        IF spr_char=="E" THEN result_line=result_line||k.rm.c||map_char
        ELSE result_line=result_line||obj.dro.col||k.rm.bc2||spr_char
      END
      WHEN map_char=="M" THEN DO
        IF spr_char=="E" THEN result_line=result_line||"[0;30;47m€"
        ELSE result_line=result_line||obj.dro.col||"[40m"||spr_char
      END
      OTHERWISE NOP
    END
  END 
RETURN

DRAW_OBJ_LINE:
  ARG dro, drawline /*, start, length */
  rm=obj.pl.room
  mp=k.rm.map
  
  /* get object sprite line */
  spri=drawline-obj.dro.y
  spr_str=obj.dro.spr.spri
  
  /* get map data underneath the sprite line */
  map_len=obj.dro.w+1  /* +1 for how width is indexed */
  map_start=obj.dro.x+MAP_SHIFT
  map_str= SUBSTR(k.mp.drawline, map_start, map_len)
  
  call BUILD_OBJ_LINE  
  se "["||drawline||";"||obj.dro.x||"H"||result_line
RETURN

DRAW_OBJECT_WITH_MOTION: /* draw object in motion (erase where its been) */
  ARG dro
  IF OK2DRAWOBJ(dro)==0 | obj.dro.room ~= obj.pl.room | (obj.dro.dirx==0 & obj.dro.diry==0) THEN RETURN
  IF dro=="BRIDGE" THEN DO
    CALL DRAW_BRIDGE_WITH_MOTION
    RETURN
  END
  ELSE IF obj.dro.type=="inverse" THEN DO
    CALL DRAW_INVERSE_OBJECT_WITH_MOTION(dro)
    RETURN
  END
  ELSE IF dro=="KNUBBERRUB" THEN DO 
    CALL DRAW_BAT
    CALL EQUIP("KNUBBERRUB")
    RETURN
  END
  
  rm=obj.pl.room
  mp=k.rm.map
  
  erasex=0
  outerloopstart=0
  outerloopend=obj.dro.h
  map_start=obj.dro.x+MAP_SHIFT
  map_len=obj.dro.w+1  /* +1 for how obj width is indexed */ 
  
  /* check for movement in x direction */
  IF obj.dro.dirx==-1 & obj.dro.x+obj.dro.w<maxcol THEN DO
    /* dro is moving left and not at right edge of screen bounds */
    /* we will need to erase one char position to the right of dro */
    erasex=1 
  END
  ELSE IF obj.dro.dirx==1 & obj.dro.x>mincol THEN DO
    /* dro is moving right and not at left edge of screen bounds */
    /* we will need to erase one char position to the left of dro */
    erasex=-1  
  END
  
  /* check for movement in y direction */
  IF obj.dro.diry==-1 & obj.dro.y+obj.dro.h<maxline THEN DO
    /* dro is moving up and not at bottom edge of screen bounds */
    /* we will need to erase one line below dro */
    outerloopend=obj.dro.h+1
  END
  ELSE IF obj.dro.diry==1 & obj.dro.y>minline THEN DO
    /* dro is moving down and not at top edge of screen bounds */ 
    /* we will need to erase one line above dro */
    outerloopstart=-1
  END
           
  /* outer loop goes through each line of sprite */ 
  DO j=outerloopstart TO outerloopend BY 1
    drawline=obj.dro.y+(j)
    drawxpos=obj.dro.x
    /* IF drawline<minline | drawline>maxline THEN ITERATE */ /* skip loop iteration if line is out of bounds */
    
    /* get current line of sprite to work on */
    IF j==-1 | j==obj.dro.h+1 THEN DO
      /* this is either 1 line above or 1 line below dro sprite, so we are "erasing" on y */
      spr_str=COPIES("E", obj.dro.w+1)
    END
    ELSE spr_str=obj.dro.spr.j
                
    /* check if we need to erase 1 char to left of sprite */
    IF erasex==-1 THEN DO
      drawxpos=drawxpos-1
      spr_str="E"||spr_str
      map_start=(obj.dro.x-1)-1   /* (original value)-1, due to being inside loop */
      map_len=(obj.dro.w+1)+1  /* (original value)+1, due to being inside loop */
    END
    /* check if we need to erase 1 char to right of sprite */
    ELSE IF erasex==1 THEN DO
      spr_str=spr_str||"E"
      map_len=(obj.dro.w+1)+1  /* (original value)+1, due to being inside loop */
    END 
    
    /* get map data that is layered "undeneath" the sprite line */  
    map_str= SUBSTR(k.mp.drawline, map_start, map_len) 
     
    call BUILD_OBJ_LINE
    se "["||drawline||";"||drawxpos||"H"||result_line         
  END
  se park
RETURN

DRAW_INVERSE_OBJECT: /* draw object whose bg is fg. what if C A T really spelled DOG? */
  ARG dro
  IF OK2DRAWOBJ(dro)==0 | obj.dro.room ~= obj.pl.room THEN RETURN
  DO j=0 TO obj.dro.h
    CALL DRAW_INVERSE_OBJ_LINE(dro, obj.dro.y+j)
  END
  se park
RETURN

BUILD_INVERSE_OBJ_LINE:
  /* requires dro, drawline, spr_str, map_str, map_start and map_len defined before calling */
  /* sets result_line for use by draw functions */ 
  
  /* TODO: optimize color stacking */
  /* loop through each character of the map string and insert bg color based on map character found */
  result_line=""
  DO m=1 TO map_len     
    spr_char= SUBSTR(spr_str, m, 1)  
    map_char= SUBSTR(map_str, m, 1)
    SELECT
      WHEN map_char==" " THEN DO
        /* select fg color */
        IF flashlight~=0 & k.rm.dark==1 & COLLIDE_BY_CHAR("LIGHT", drawline, map_start+m)==1 THEN fgcolor="[0;33m"
        ELSE fgcolor="[0;37m"
          
        IF spr_char=="E" THEN DO
          bgcolor="[47m"
          char_data="€"
        END
        ELSE DO
          bgcolor=obj.dro.col
          char_data=spr_char
        END         
        result_line=result_line||fgcolor||bgcolor||char_data
      END 
      WHEN map_char=="€" THEN DO 
        IF spr_char=="E" THEN result_line=result_line||k.rm.c||map_char
        ELSE IF spr_char==" " THEN result_line=result_line||k.rm.fc||obj.dro.col||spr_char
        ELSE result_line=result_line||k.rm.fc||obj.dro.col||spr_char
      END
      WHEN map_char=="M" THEN DO
        IF spr_char=="E" THEN result_line=result_line||"[0;30;47m€"
        ELSE IF spr_char==" " THEN result_line=result_line||obj.dro.col||spr_char
        ELSE result_line=result_line||"[0;30m"||obj.dro.col||spr_char
      END
      OTHERWISE NOP
    END
  END
RETURN       

DRAW_INVERSE_OBJ_LINE:
  ARG dro, drawline /*, start, length */
  rm=obj.pl.room
  mp=k.rm.map
  
  /* get object sprite line */
  spri=drawline-obj.dro.y
  IF obj.dro.type=="dragon" & obj.dro.dirx==1 THEN DO
    spr_str= REVERSE(obj.dro.spr.spri)
  END
  ELSE spr_str=obj.dro.spr.spri
    
  /* get map data underneath item's sprite line */
  map_len= obj.dro.w+1  /* +1 for how width is indexed */
  map_start= obj.dro.x+MAP_SHIFT
  map_str= SUBSTR(k.mp.drawline, map_start, map_len) 
  
  CALL BUILD_INVERSE_OBJ_LINE
  se "["||drawline||";"||obj.dro.x||"H"||result_line  /* ||k.rm.fc */
RETURN

/* TODO: fix draw/erase issues with screen edges */
DRAW_INVERSE_OBJECT_WITH_MOTION: /* draw object whose bg is fg. what if C A T really spelled DOG? */
  ARG dro
  IF OK2DRAWOBJ(dro)==0 | obj.dro.room ~= obj.pl.room | (obj.dro.dirx==0 & obj.dro.diry==0) THEN RETURN
  rm=obj.pl.room
  mp=k.rm.map
  
  erasex=0
  outerloopstart=0
  outerloopend=obj.dro.h
  map_start=obj.dro.x+MAP_SHIFT
  map_len=obj.dro.w+1  /* +1 for how obj width is indexed */ 
  
  /* check for movement in x direction */
  IF obj.dro.dirx==-1 & obj.dro.x+obj.dro.w<maxcol THEN DO
    /* dro is moving left and not at right edge of screen bounds */
    /* we will need to erase one char position to the right of dro */
    erasex=1 
  END
  ELSE IF obj.dro.dirx==1 & obj.dro.x>mincol THEN DO
    /* dro is moving right and not at left edge of screen bounds */
    /* we will need to erase one char position to the left of dro */
    erasex=-1  
  END
  
  /* check for movement in y direction */
  IF obj.dro.diry==-1 & obj.dro.y+obj.dro.h<maxline THEN DO
    /* dro is moving up and not at bottom edge of screen bounds */
    /* we will need to erase one line below dro */
    outerloopend=obj.dro.h+1
  END
  ELSE IF obj.dro.diry==1 & obj.dro.y>minline THEN DO
    /* dro is moving down and not at top edge of screen bounds */ 
    /* we will need to erase one line above dro */
    outerloopstart=-1
  END
       
  /* TODO: this loop is very similar to DRAW_INVERSE_OBJ_LINE, try to combine/code reduce */      
  /* outer loop goes through each line of sprite */ 
  DO j=outerloopstart TO outerloopend BY 1
    drawline=obj.dro.y+(j)
    drawxpos=obj.dro.x
    /* IF drawline<minline | drawline>maxline THEN ITERATE */ /* skip loop iteration if line is out of bounds */
    
    /* get current line of sprite to work on */
    IF j==-1 | j==obj.dro.h+1 THEN DO
      /* this is either 1 line above or 1 line below dro sprite, so we are "erasing" on y */
      spr_str= COPIES("E", obj.dro.w+1)
    END
    ELSE DO
      IF obj.dro.type=="dragon" & obj.dro.dirx==1 THEN DO
        spr_str=REVERSE(obj.dro.spr.j) 
      END
      ELSE spr_str=obj.dro.spr.j
    END
                
    /* check if we need to erase 1 char to left of sprite */
    IF erasex==-1 THEN DO
      drawxpos=drawxpos-1
      spr_str="E"||spr_str
      map_start=(obj.dro.x-1)-1   /* (original value)-1, due to being inside loop */
      map_len=(obj.dro.w+1)+1  /* (original value)+1, due to being inside loop */
    END
    /* check if we need to erase 1 char to right of sprite */
    ELSE IF erasex==1 THEN DO
      spr_str=spr_str||"E"
      map_len=(obj.dro.w+1)+1  /* (original value)+1, due to being inside loop */
    END 
    
    /* get map data that is layered "undeneath" the sprite line */  
    map_str= SUBSTR(k.mp.drawline, map_start, map_len) 
    
    CALL BUILD_INVERSE_OBJ_LINE
    se "["||drawline||";"||drawxpos||"H"||result_line       
  END
  se park
RETURN

DRAW_BRIDGE:
  IF OK2DRAWOBJ("BRIDGE")==0 | obj.bridge.room ~= obj.pl.room THEN RETURN
  DO j=0 TO obj.bridge.h
    CALL DRAW_BRIDGE_LINE(obj.bridge.y+j)
  END
  se park
RETURN

DRAW_BRIDGE_LINE:
  ARG drawline
  spri=drawline-obj.bridge.y
  spr_str=obj.bridge.spr.spri
  IF spri==0 | spri==obj.bridge.h THEN drawbridgexpos=obj.bridge.x /* this is either the first or last line */
  ELSE drawbridgexpos=obj.bridge.x+2 /* this is an interior brige line */
  se "["||drawline||";"||drawbridgexpos||"H"||obj.bridge.col||spr_str||"["||obj.bridge.gap||"C"||spr_str
RETURN

DRAW_BRIDGE_WITH_MOTION:
  xdir=obj.bridge.dirx
  ydir=obj.bridge.diry
  IF OK2DRAWOBJ("BRIDGE")==0 | obj.bridge.room ~= obj.pl.room | (xdir==0 & ydir==0) THEN RETURN
  	
  rm=obj.pl.room
  mp=k.rm.map	

  erasex=0
  outerloopstart=0
  outerloopend=obj.bridge.h

  /* check for movement in x direction */
  IF xdir==D_LEFT & obj.bridge.x+obj.bridge.w<maxcol THEN DO
    /* bridge is moving left and not at right edge of screen bounds */
    /* we will need to erase one char position to the right of bridge */
    erasex=1 
  END
  ELSE IF xdir==D_RIGHT & obj.bridge.x>mincol THEN DO
    /* bridge is moving right and not at left edge of screen bounds */
    /* we will need to erase one char position to the left of bridge */
    erasex=-1  
  END
  
  /* check for movement in y direction */
  IF ydir==D_UP & obj.bridge.y+obj.bridge.h<maxline THEN DO
    /* bridge is moving up and not at bottom edge of screen bounds */
    /* we will need to erase one line below bridge */
    outerloopend=obj.bridge.h+1
  END
  ELSE IF ydir==D_DOWN & obj.bridge.y>minline THEN DO
    /* bridge is moving down and not at top edge of screen bounds */ 
    /* we will need to erase one line above bridge */
    outerloopstart=-1
  END

  /* outer loop goes through each line of sprite */ 
  DO j=outerloopstart TO outerloopend BY 1
    drawline=obj.bridge.y+(j)
    /* IF drawline<minline | dratwline>maxline THEN ITERATE */ /* skip loop iteration if line is out of bounds */
    
    /* get lines of sprite data to work on */ 
    spr_str1=bwm.1.xdir.ydir.j
    spr_str2=bwm.2.xdir.ydir.j
    
    /* init drawx offsets */
    drawxoff1=0
    drawxoff2=0
    
    /* check if we need to erase 1 char to left of sprite */
    IF erasex==-1 THEN DO
    	IF xdir==D_RIGHT & ydir==0 & (j==0 | j==5) THEN DO
    		spr_str1="E"||spr_str1
    		drawxoff1=-1
    	END
    	ELSE IF xdir==D_RIGHT & ydir==D_UP & (j==1 | j==6) THEN DO
    		spr_str1="E"||spr_str1
    		drawxoff1=-1
    	END
    	ELSE IF xdir==D_RIGHT & ydir==D_DOWN & (j==-1 | j==4) THEN DO
    		spr_str1="E"||spr_str1
    		drawxoff1=-1
    	END
    END
    /* check if we need to erase 1 char to right of sprite */
    ELSE IF erasex==1 THEN DO
    	IF xdir==D_LEFT & ydir==0 & (j==0 | j==5) THEN spr_str2=spr_str2||"E"
      ELSE IF xdir==D_LEFT & ydir==D_UP & (j==1 | j==6) THEN spr_str2=spr_str2||"E"
      ELSE IF xdir==D_LEFT & ydir==D_DOWN & (j==-1 | j==4) THEN spr_str2=spr_str2||"E"	
    END
    
    /* get drawxpos1 */
    IF INDEX(spr_str1, "X")~=0 THEN drawxoff1= drawxoff1+ VERIFY(spr_str1, "X") -1
    drawxpos1=obj.bridge.x+(drawxoff1)
    
    /* get drawxpos2 */
    IF xdir==D_RIGHT & LEFT(spr_str2, 1)~="X" THEN drawxoff2=-1
    ELSE IF xdir==D_LEFT & LEFT(spr_str2, 1)=="X" THEN drawxoff2=1
    drawxpos2=obj.bridge.x+obj.bridge.p2xoff+(drawxoff2)
    
    /* strip X from sprite data */
    spr_str1= STRIP(spr_str1, "L", "X") 
    spr_str2= STRIP(spr_str2, "L", "X") 
    
    /* get map data underneath spr_str1 and loop through characters of spr_str1 and insert erase color as needed */
    dro="BRIDGE"
    spr_str=spr_str1
    map_start=drawxpos1+MAP_SHIFT
    map_len= LENGTH(spr_str1)
    map_str= SUBSTR(k.mp.drawline, map_start, map_len)
    CALL BUILD_INVERSE_OBJ_LINE
    result_str1=result_line
    
    /* get map data underneath spr_str2 and loop through characters of spr_str2 and insert erase color as needed */
    spr_str=spr_str2
    map_start=drawxpos2+MAP_SHIFT
    map_len= LENGTH(spr_str2)
    map_str= SUBSTR(k.mp.drawline, map_start, map_len)
    CALL BUILD_INVERSE_OBJ_LINE
    result_str2=result_line
    
    se "["||drawline||";"||drawxpos1||"H"||result_str1||"["||drawline||";"||drawxpos2||"H"||result_str2
  END
  se park
RETURN

ERASE_BRIDGE:
  IF OK2DRAWOBJ("BRIDGE")==0 | obj.bridge.room ~= obj.pl.room THEN RETURN
  rm=obj.pl.room
  mp=k.rm.map
  DO j=0 TO obj.bridge.h
    drawline=obj.bridge.y+j
    
    /* get map data under bridge */
    IF j==0 | j==obj.bridge.h THEN DO
      /* this is first or last line of bridge */
      erasebridgexpos=obj.bridge.x
      map_str= SUBSTR(k.mp.drawline, erasebridgexpos+MAP_SHIFT, obj.bridge.w+1)  /* +1 for how width is indexed */
      str1= LEFT(map_str, obj.bridge.foot)
      str2= RIGHT(map_str, obj.bridge.foot)
    END
    ELSE DO
      erasebridgexpos=obj.bridge.x+2
      map_str= SUBSTR(k.mp.drawline, erasebridgexpos+MAP_SHIFT, obj.bridge.gap+2)  /* bridge gap plus one space on each side */
      str1= LEFT(map_str, 1)
      str2= RIGHT(map_str, 1)
    END
    
    /* TODO: optimize color stacking */
    /* loop through characters of str1 and str2 and insert color as needed */
    start1=erasebridgexpos+MAP_SHIFT
    start2=obj.bridge.x+obj.bridge.p2xoff+MAP_SHIFT
    str_len= LENGTH(str1) /* both str1 and str2 will be the same length */
    result_str1=""
    result_str2=""
    DO char=1 TO str_len
      /* get char of str1 and determine erasecol */
      map_char1= SUBSTR(str1, char, 1)
      IF flashlight~=0 & k.rm.dark==1 & COLLIDE_BY_CHAR("LIGHT", drawline, start1+char)==1 THEN erasecol=k.rm.fc||"[43m"
      ELSE erasecol=k.rm.c
      result_str1=result_str1||erasecol||map_char1
      
      /* get char of str2 and determine erasecol */
      map_char2= SUBSTR(str2, char, 1)
      IF flashlight~=0 & k.rm.dark==1 & COLLIDE_BY_CHAR("LIGHT", drawline, start2+char)==1 THEN erasecol=k.rm.fc||"[43m"
      ELSE erasecol=k.rm.c
      result_str2=result_str2||erasecol||map_char2    
    END
    
    /* handle the side barriers */
    m_index= INDEX(result_str1, "M")
    IF m_index~=0 THEN DO
      newstr1= LEFT(result_str1, m_index-1) || "[0;30;47m€" || RIGHT(result_str1, LENGTH(result_str1)-m_index)
      result_str1 = newstr1
    END
    m_index= INDEX(result_str2,"M")
    IF m_index~=0 THEN DO
      newstr2= LEFT(result_str2, m_index-1) || "[0;30;47m€" || RIGHT(result_str2, LENGTH(result_str2)-m_index)
      result_str2 = newstr2
    END
          
    se "["||drawline||";"||erasebridgexpos||"H"||result_str1||"["||obj.bridge.gap||"C"||result_str2
  END
  se park
RETURN

ERASE_OBJECT:
  ARG dro
  IF OK2DRAWOBJ(dro)==0 | obj.dro.room ~= obj.pl.room THEN RETURN
  IF dro=="BRIDGE" THEN DO
    CALL ERASE_BRIDGE
    RETURN
  END
  rm=obj.pl.room
  mp=k.rm.map
  DO j=obj.dro.y TO obj.dro.y+obj.dro.h
    str = SUBSTR(k.mp.j, obj.dro.x+MAP_SHIFT, obj.dro.w+1)  /* +1 for how width is inedexed */
    /* handle the side barriers */
    m_index = INDEX(str,"M")
    IF m_index ~=0 THEN DO
      newstr = LEFT(str,m_index-1) || "[0;30;47m€" || k.rm.c || RIGHT(str,length(str)-m_index)
      str = newstr
    END
    IF (flashlight~=0 & k.rm.dark==1) & (obj.pl.equip==dro | COLLIDE_BY_LINE(dro, j, "LIGHT")==1) THEN erasecolor="[0;43m"
    ELSE erasecolor=k.rm.c
    se "["||j||";"||obj.dro.x||"H"||erasecolor||str
  END
  se park
RETURN

DRAW_GATE:    
  ARG dro
    
  DO j=0 TO obj.dro.h
    se "["||obj.dro.y+j||";"||obj.dro.x||"H"||obj.dro.col||obj.dro.spr.j
  END
  se park
RETURN

DRAW_DRAGON:  /* TODO: finish */
  ARG dro
  CALL DRAW_INVERSE_OBJECT_WITH_MOTION(dro)
RETURN

ERASE_DRAGON:  /* TODO: finish */
  ARG dro
  CALL ERASE_OBJECT(dro)
RETURN

DRAW_BAT:  /* called by BAT_MOVE in main loop */
  IF OK2DRAWOBJ(knub)==0 | obj.knub.room~=obj.pl.room THEN RETURN
  CALL EQUIP(knub)
  CALL DRAW_INVERSE_OBJECT_WITH_MOTION(knub)
RETURN

ERASE_BAT:
  /* erase equipped object */
  IF obj.knubberrub.equip~="NONE" THEN CALL ERASE_OBJECT(obj.knubberrub.equip)
  /* erase knubberrub */
  CALL ERASE_OBJECT("KNUBBERRUB")
RETURN

PLAYER_MOVE:
  IF obj.pl.state==PL_DEAD | (obj.pl.dirx==0 & obj.pl.diry==0) THEN RETURN
  CALL EXIT_WITH_MOTION("PL") 
  
  IF obj.pl.dirx==-1 & obj.pl.x==mincol+1 THEN obj.pl.dx=1 
  ELSE IF obj.pl.dirx==1 & obj.pl.x==maxcol-2 THEN obj.pl.dx=1  
  ELSE obj.pl.dx=2 
  obj.pl.dy=1
  
  /* do player-gate collision detect */
  IF GATE_COLLIDE("PL")==1 THEN RETURN
    
  /* do player-msg collision detect */
  IF MSG_COLLIDE("PL")==1 THEN RETURN
    
  /* do player-dragon collision detect */
  IF DRAGON_COLLIDE("PL")==1 THEN DO
    IF obj.pl.dx==2 THEN DO
      /* moving 2 char failed, lets try 1 char */
      obj.pl.dx=1
      IF DRAGON_COLLIDE("PL")==1 THEN RETURN
    END
    ELSE RETURN
  END
    
  /* do map collision detect */
  IF WALL("PL")==1 THEN DO
    CALL ITEM_WALL_CHECK
    IF obj.pl.dx==2 THEN DO
      /* moving 2 char failed, lets try 1 char */
      obj.pl.dx=1
      IF WALL("PL")==1 THEN DO
        CALL ITEM_WALL_CHECK
        RETURN
      END
    END
    ELSE RETURN
  END
  
  /* OK 2 move player */
  
  /* do item collision detect */
  DO i=0 TO maxgrabitem
    o=item.i
    IF o=="BRIDGE" & obj.knubberrub.equip~=o & BRIDGE_COLLIDE("PL")==1 THEN NOP /* allow pl to walk across bridge */
    ELSE IF o==knub & (obj.knub.fedup==0 | obj.knub.fedup>400) & WILL_COLLIDE("PL", o)==1 THEN CALL GRAB("PL", o)
    ELSE IF obj.knubberrub.equip~=o & WILL_COLLIDE("PL", o)==1 THEN CALL GRAB("PL", o)
  END
  CALL ERASE_PL
  CALL MOVE("PL",1,1)
  CALL DRAW_PL
RETURN

MOVE:  /* moves the desired object */
  ARG mo, movex, movey
  IF TRUNC(obj.mo.dx)==0 & TRUNC(obj.mo.dy)==0 THEN RETURN
  IF movex==1 THEN obj.mo.x=obj.mo.x+(TRUNC(obj.mo.dx)*obj.mo.dirx)
  ELSE obj.mo.dirx=0
  IF movey==1 THEN obj.mo.y=obj.mo.y+(TRUNC(obj.mo.dy)*obj.mo.diry)
  ELSE obj.mo.diry=0
RETURN 

GETDIR:           
  ARG pos1, pos2, hop
  IF pos1<pos2 THEN RETURN -1
  ELSE IF pos1>pos2 THEN RETURN 1
  ELSE IF hop==1 & pos1==pos2 THEN RETURN 1
  ELSE NOP
RETURN 0

/* TODO optimize erasing the object */  
EQUIP:
  ARG being
  IF obj.being.equip=="NONE" THEN RETURN
  eo=obj.being.equip
  CALL ERASE_OBJECT(eo)
  obj.eo.room=obj.being.room
  obj.eo.x=obj.being.x+obj.eo.offset.x
  obj.eo.y=obj.being.y+obj.eo.offset.y
  /* obj.eo.dirx=obj.being.dirx
  obj.eo.diry=obj.being.diry */
  CALL DRAW_OBJECT(eo)
RETURN

GRAB:
  ARG being, gro
  IF obj.being.equip==gro THEN RETURN
  IF obj.being.equip~="NONE" THEN CALL DROP(0)
  obj.being.equip=gro
  obj.gro.offset.x=obj.gro.x-obj.being.x
  obj.gro.offset.y=obj.gro.y-obj.being.y
  /* hacky knubberrub grab offset fix */
  IF being=="KNUBBERRUB" THEN DO
    obj.gro.offset.x=obj.gro.offset.x+obj.being.dirx
    obj.gro.offset.y=obj.gro.offset.y+obj.being.diry
  END
  IF being=="PL" THEN se "b1" /* BEEP! */
RETURN

DROP:
  ARG beep
  IF obj.pl.equip=="NONE" THEN RETURN
  drpo=obj.pl.equip
  obj.drpo.offset.x=0
  obj.dro.offset.y=0
  /* obj.drpo.dirx=0
  obj.drpo.diry=0 */
  obj.pl.equip="NONE"
  CALL EXIT_OBJ(dro)
  
  /* fix for bug where item gets trapped under gate*/
  DO j=0 TO maxgate
    g=gate.j
    IF COLLIDE_NOW(dro, g)==1 THEN obj.dro.y=obj.g.y+obj.g.h+1
  END
  
  IF beep==1 THEN se "b1" /* BEEP! */
RETURN

UNLOCK:
  ARG g
  IF obj.g.locked==0 THEN RETURN
  obj.g.locked=0
  obj.g.spr.0=_gate.3
  CALL GATE_OP(g)
RETURN

LOCK:
  ARG g
  IF obj.g.locked==1 THEN RETURN
  obj.g.locked=1
  obj.g.spr.0=_gate.0
  CALL GATE_CL(g)
RETURN

GATE_CL:  /* close gate animation */
  ARG g
  IF debug==1 THEN CALL DEBUG 

  DO i=0 to 2
    obj.g.h=obj.g.h+1
    IF WILL_COLLIDE("PL", g)==1 THEN CALL ERASE_PL
    se obj.g.col||"["||obj.g.y+i||";"||obj.g.x||"H"||obj.g.spr.2||"["||obj.g.y+i+1||";"||obj.g.x||"H"||obj.g.spr.3
    IF WILL_COLLIDE("PL", g)==1 THEN DO 
      obj.pl.y=obj.pl.y+1
      CALL DRAW_PL
    END
    se park
    IF i~=2 THEN CALL DELAY(5)
  END
  obj.g.h=3
RETURN

GATE_OP:  /* open gate animation */
  ARG g
  IF debug==1 THEN CALL DEBUG   
  
  DO i=3 TO 1 by -1
    se obj.g.col||"["||obj.g.y+i||";"||obj.g.x||"H    ["||(obj.g.y+i)-1||";"||obj.g.x||"H"||obj.g.spr.3
    se park
    IF i~=1 THEN CALL DELAY(5) 
  END
  obj.g.h=0
RETURN

COLLIDE_NOW:  /* detect if object1 and object2 are colliding now */
  ARG o1, o2
  IF obj.o1.room==obj.o2.room &,                  /* o1 and o2 are in same room and   */ 
     obj.o2.x+obj.o2.w >= obj.o1.x &,             /* o2 right edge > o1 left edge and */
     obj.o2.y+obj.o2.h >= obj.o1.y &,             /* o2 bottom edge > o1 top edge and */
     obj.o2.x <= obj.o1.x+obj.o1.w &,             /* o2 left edge < o1 right edge and */
     obj.o2.y <= obj.o1.y+obj.o1.h THEN RETURN 1  /* o2 top edge < o1 bottom edge     */
  ELSE RETURN 0
RETURN 0

WILL_COLLIDE:  /* detect if object1 and object2 will collide (with object 1 in motion) */
  ARG o1, o2
  IF obj.o1.dx>1 THEN obj.o1.vx=obj.o1.dx*obj.o1.dirx
  ELSE obj.o1.vx=obj.o1.dirx
  IF obj.o1.dy>1 THEN obj.o1.vy=obj.o1.dy*obj.o1.diry
  ELSE obj.o1.vy=obj.o1.diry
  IF obj.o1.room==obj.o2.room &,                              /* o1 and o2 are in same room and   */ 
     obj.o2.x+obj.o2.w >= obj.o1.x+(obj.o1.vx) &,             /* o2 right edge > o1 left edge and */
     obj.o2.y+obj.o2.h >= obj.o1.y+(obj.o1.vy) &,             /* o2 bottom edge > o1 top edge and */
     obj.o2.x <= obj.o1.x+obj.o1.w+(obj.o1.vx) &,             /* o2 left edge < o1 right edge and */
     obj.o2.y <= obj.o1.y+obj.o1.h+(obj.o1.vy) THEN RETURN 1  /* o2 top edge < o1 bottom edge     */
  ELSE RETURN 0
RETURN 0

COLLIDE_BY_LINE:  /* detect if o2 collides with current line being drawn of o1 */
  ARG o1, drawline, o2
  
  /* TODO: do something about this hacky flashlight fix */
  /* need to make this code apply to all objects in motion with erasex */
  IF o1=="LIGHT" & erasex==-1 THEN DO
    o1xleft=obj.o1.x-obj.pl.dx
    o1xright=obj.o1.x+obj.o1.w
  END
  ELSE IF o1=="LIGHT" & erasex==1 THEN DO
    o1xleft=obj.o1.x
    o1xright=obj.o1.x+obj.o1.w+obj.pl.dx
  END 
  ELSE DO
    o1xleft=obj.o1.x
    o1xright=obj.o1.x+obj.o1.w
  END
  
  IF obj.o2.room==obj.pl.room &,
    drawline >= obj.o2.y &,
    drawline <= obj.o2.y+obj.o2.h &,
    obj.o2.x+obj.o2.w >= o1xleft &,
    obj.o2.x <= o1xright THEN RETURN 1
  ELSE RETURN 0
RETURN 0

COLLIDE_BY_CHAR:  /* detect if xpos collides with current char being drawn of o1 */
  ARG o1, drawline, xpos
  IF drawline >= obj.o1.y &,
    drawline <= obj.o1.y+obj.o1.h &,
    xpos >= obj.o1.x &,
    xpos <= obj.o1.x+obj.o1.w THEN RETURN 1
  ELSE RETURN 0
RETURN 0

DRAGON_COLLIDE:  /* check if object collides with dead or attacking dragons */
  ARG o
  DO j=0 to maxdragon
    d=dragon.j
    IF (obj.d.state==DR_DEAD | obj.d.state==DR_ATTACK) & WILL_COLLIDE(o, d)==1 THEN RETURN 1
  END
RETURN 0

MSG_COLLIDE:  /* check if object collides with msg in secret room */
  ARG o
  DO j=0 to maxmsg
    m=msg.j
    IF WILL_COLLIDE(o, m)==1 THEN RETURN 1
  END
RETURN 0

GATE_COLLIDE:  /* check if object collides with gate */
  ARG o  
  DO j=0 TO maxgate
    g=gate.j
    IF WILL_COLLIDE(o, g)==1 THEN DO
      IF obj.g.key==o & obj.g.locked==1 THEN DO 
        CALL UNLOCK(g)
        CALL DRAW_OBJECT(o)
      END
      /* ELSE IF obj.g.key==o & obj.g.locked==0 THEN CALL LOCK(g) */
      RETURN 1 /* o collides with gate */
    END
  END
RETURN 0 /* no collision */

BRIDGE_COLLIDE: /* check if p is on bridge */
  ARG p
  obj.p.vx=obj.p.dx*obj.p.dirx
  obj.p.vy=obj.p.dy*obj.p.diry
  IF WILL_COLLIDE(p, "BRIDGE")==1 & obj.p.x+(obj.p.vx)>=obj.bridge.x+3 & obj.p.x+(obj.p.vx)<=obj.bridge.x+obj.bridge.w-4 &,
    obj.p.y+(obj.p.vy)>=obj.bridge.y & obj.p.y+(obj.p.vy)<=obj.bridge.y+obj.bridge.h THEN RETURN 1
RETURN 0 /* p not on bridge */

WALL: /* detect collision with wall or barrier */
  ARG wo
  IF wo=="PL" & obj.pl.equip~="BRIDGE" & BRIDGE_COLLIDE("PL")==1 THEN RETURN 0 /* allow player to walk over walls */
  rm=obj.pl.room
  mp=k.rm.map
  obj.wo.vx=obj.wo.dx*obj.wo.dirx
  obj.wo.vy=obj.wo.dy*obj.wo.diry
  IF obj.wo.x+(obj.wo.vx)-1<=0 THEN RETURN 0 /* hacky fix to left exit bug */
  DO l=obj.wo.y+(obj.wo.vy) TO obj.wo.y+obj.wo.h+(obj.wo.vy)
    /* for each line of the object, check map chars under object */
    str= SUBSTR(k.mp.l, obj.wo.x+(obj.wo.vx)+MAP_SHIFT, obj.wo.w+1)  /* +1 due to how obj.o.w is indexed */
    IF INDEX(str, "€") ~=0 THEN DO
      /* wall found */
      bufferflush
      RETURN 1   
    END
    ELSE IF INDEX(str, "M") ~=0 THEN DO
      /* barrier found */
      IF SECRET()==1 THEN RETURN 0  /* TODO: is this line needed? */
      IF obj.pl.room == obj.dot.room THEN RETURN 0
      bufferflush
      RETURN 1
    END 
  END
RETURN 0 /* wall or barrier not found, RETURN 0 */

ITEM_WALL_CHECK:
  DO i=0 TO maxitem
    wco=item.i
    IF WILL_COLLIDE("PL", wco)==1 & BRIDGE_COLLIDE("PL")~=1 THEN DO
      CALL GRAB("PL", wco)
      LEAVE
    END
  END
RETURN

/* in main loop */
/* TODO: fix magnet only wants highest pri item, need to compare with original */
MAGNET_SEEK:  /* magnet will seek an item based on priority */
  DO i=0 TO maxmagnetitem
    mso = item.i
    IF obj.magnet.busy==0 & obj.mso.room==obj.magnet.room & obj.pl.equip~=mso & obj.knubberrub.equip~=mso THEN DO
      obj.magnet.want=mso
      obj.magnet.busy=1
      LEAVE i
    END
  END
RETURN

/* in main loop */ 
MAGNETISM:  /* move wanted object toward magnet */ 
  IF obj.magnet.want=="NONE" THEN RETURN   
  mwo=obj.magnet.want
  IF obj.magnet.busy==1 & obj.mwo.room==obj.magnet.room & obj.pl.equip~=mwo & obj.knubberrub.equip~=mwo THEN DO
    IF obj.mwo.x==obj.magnet.x & obj.mwo.y==obj.magnet.y+obj.magnet.h+1 THEN DO  /* wanted item is on magnet */
      obj.magnet.busy=0
      obj.magnet.want="NONE"
      obj.mwo.dx=0; obj.mwo.dy=0
      obj.mwo.dirx=0; obj.mwo.diry=0
    END
    ELSE DO /* move item to magnet */
      obj.mwo.dirx= GETDIR(obj.magnet.x, obj.mwo.x)
      obj.mwo.diry= GETDIR(obj.magnet.y+obj.magnet.h+1, obj.mwo.y)
      obj.mwo.dx=obj.mwo.dx+obj.mwo.spdx
      obj.mwo.dy=obj.mwo.dy+obj.mwo.spdy
      IF obj.mwo.dx>=1 & obj.mwo.dy>=1 THEN DO
        CALL EXIT_WITH_MOTION(mwo)
        CALL MOVE(mwo,1,1)  /* move x and y */
        CALL DRAW_OBJECT_WITH_MOTION(mwo)
        obj.mwo.dx=0; obj.mwo.dy=0
        obj.mwo.dirx=0; obj.mwo.diry=0
      END
      ELSE IF obj.mwo.dx>=1 THEN DO
        CALL EXIT_WITH_MOTION(mwo)
        CALL MOVE(mwo,1,0)  /* move x only */
        CALL DRAW_OBJECT_WITH_MOTiON(mwo)
        obj.mwo.dx=0
        obj.mwo.dirx=0
      END
      ELSE IF obj.mwo.dy>=1 THEN DO
        CALL EXIT_WITH_MOTION(mwo)
        CALL MOVE(mwo,0,1)  /* move y only */
        CALL DRAW_OBJECT_WITH_MOTION(mwo) 
        obj.mwo.dy=0
        obj.mwo.diry=0
      END
    END
  END
  
  /* handle case where magnet leaves the room */
  IF obj.mwo.room~=obj.magnet.room THEN DO
    obj.magnet.busy=0
    obj.magnet.want="NONE"
    obj.mwo.dx=0; obj.mwo.dy=0
    obj.mwo.dirx=0; obj.mwo.diry=0
  END
  IF debug==1 THEN CALL DEBUG_MAGNET 
RETURN

/* in main loop */
/* TODO: fix bat/equiped object interaction after long player hold and release */
BAT_SEEK:
  IF obj.knub.fedup==0 THEN obj.knub.seek=1 
  ELSE DO
    obj.knub.fedup=obj.knub.fedup+1
    IF obj.knub.fedup==obj.knub.maxfedup THEN obj.knub.fedup=0
  END
  IF obj.knub.seek==1 THEN DO
    DO kwi=0 TO want.knub.max
      kwo=want.knub.kwi  /* eg. "SWORD" */        
      IF obj.knub.want=="NONE" & obj.kwo.room==obj.knub.room & kwo~=obj.knub.equip THEN DO
        obj.knub.want=kwo
        LEAVE kwi
      END
    END
    IF obj.knub.want~="NONE" & obj.kwo.room==obj.knub.room & obj.knub.equip~=obj.knub.want THEN CALL BAT_STEAL
    ELSE obj.knub.want="NONE"
  END
RETURN

/* in main loop */
BAT_ANIM:
  pfrm=TRUNC(obj.knub.frame)
  obj.knub.frame=obj.knub.frame+obj.knub.animspd
  IF obj.knub.frame>=(obj.knub.maxframe+1) THEN obj.knub.frame=0
  nfrm=TRUNC(obj.knub.frame)
  IF nfrm~=pfrm THEN DO
    DO j=0 TO obj.knub.h
      obj.knub.spr.j=_bat.nfrm.j
    END
    CALL DRAW_INVERSE_OBJECT(knub)
  END
RETURN

/* in main loop */
BAT_MOVE:  /* TODO:  fix item interaction */
  obj.knub.dx=obj.knub.dx+obj.knub.spdx
  obj.knub.dy=obj.knub.dy+obj.knub.spdy
  /* added a small window where knubberrub is not grabbable by the player */
  /* IF (obj.knub.fedup==0 | obj.knub.fedup>400) & obj.pl.equip~=knub & WILL_COLLIDE(knub, "PL")==1 THEN CALL GRAB("PL", knub) */ 
  IF obj.knub.dx>=1 & obj.knub.dy>=1 THEN DO
    IF obj.pl.equip~=knub THEN DO 
      CALL EXIT_WITH_MOTION(knub)
      CALL MOVE(knub,1,1)  /* move x and y */
      CALL DRAW_BAT
    END
    obj.knub.dx=0; obj.knub.dy=0
  END
  ELSE IF obj.knub.dx>=1 THEN DO
    IF obj.pl.equip~=knub THEN DO
      CALL EXIT_WITH_MOTION(knub)
      CALL MOVE(knub,1,0)  /* move x only */
      CALL DRAW_BAT
    END
    obj.knub.dx=0
  END
  ELSE IF obj.knub.dy>=1 THEN DO
    IF obj.pl.equip~=knub THEN DO
      CALL EXIT_WITH_MOTION(knub)
      CALL MOVE(knub,0,1)  /* move y only */
      CALL DRAW_BAT
    END
    obj.knub.dy=0
  END 
  IF debug==1 THEN CALL DEBUG_BAT
RETURN

/* in main loop */
BAT_STEAL:
  IF obj.knub.want=="NONE" THEN RETURN
  kswo=obj.knub.want  /* eg. "SWORD" */
  IF obj.pl.equip~=knub THEN DO
    tdirx=GETDIR(obj.kswo.x, obj.knub.x)
    tdiry=GETDIR(obj.kswo.y, obj.knub.y)
    IF tdirx==0 & tdiry==0 THEN NOP /* because this would freeze knubby */
    ELSE DO
      obj.knub.dirx=tdirx 
      obj.knub.diry=tdiry
    END 
  END
  IF WILL_COLLIDE(knub, kswo)==1 THEN DO
    IF obj.pl.equip==kswo THEN obj.pl.equip="NONE"
    CALL GRAB(knub, kswo)
    obj.knub.seek=0; obj.knub.want="NONE"; obj.knub.fedup=1
  END
RETURN

/* in main loop */
DRAGON_GUARD: 
  ARG drago
  DO dwi=0 TO want.drago.max
    dwo=want.drago.dwi
    IF obj.dwo.room==obj.drago.room THEN DO
      obj.drago.want=dwo
      LEAVE dwi
    END
    ELSE obj.drago.want="NONE"
  END
RETURN

/* in main loop */
DRAGON_FLEE: 
  ARG drago
  DO dfi=0 TO fear.drago.max
    dfo=fear.drago.dfi
    IF obj.dfo.room==obj.drago.room THEN DO
      obj.drago.fear=dfo
      LEAVE dfi
    END
    ELSE obj.drago.fear="NONE"
  END
RETURN

/* in main loop */
DRAGON_MOVE:
  ARG drago
  dfo=obj.drago.fear
  dwo=obj.drago.want
  
  IF dfo~="NONE" & obj.dfo.room==obj.drago.room  THEN DO    
    tdirx=GETDIR(obj.drago.x, obj.dfo.x)
    tdiry=GETDIR(obj.drago.y, obj.dfo.y)
    IF tdirx==0 & tdiry==0 THEN NOP  /* to avoid freezing (with fright) */
    ELSE DO
      obj.drago.dirx=tdirx
      obj.drago.diry=tdiry
    END
  END
  ELSE IF dwo~="NONE" & obj.dwo.room==obj.drago.room THEN DO
    tdirx=GETDIR(obj.dwo.x, obj.drago.x)
    tdiry=GETDIR(obj.dwo.y, obj.drago.y) /* TODO: fix drago hop */
    /* IF tdirx==0 & tdiry==0 THEN NOP 
    ELSE DO */
      obj.drago.dirx=tdirx
      obj.drago.diry=tdiry
    /* END */
  END
  
  /* check for impalement */
  IF obj.drago.state==DR_ALIVE & COLLIDE_NOW(drago, "SWORD") THEN DO
    obj.drago.state=DR_DEAD
    DO i=0 TO obj.drago.h
      obj.drago.spr.i=_dragon.DR_DEAD.i
    END
    CALL DRAW_INVERSE_OBJECT(drago)
    RETURN
  END
  
  /* should dragon attack? */
  IF obj.drago.state==DR_ALIVE & WILL_COLLIDE(drago, "PL") THEN DO
    obj.drago.state=DR_ATTACK
    DO i=0 TO obj.drago.h
      obj.drago.spr.i=_dragon.DR_ATTACK.i
    END
    obj.drago.atkstart= time('s')
    CALL DRAW_INVERSE_OBJECT(drago)
    RETURN
  END
  
  /* was player eaten? */
  /* TODO: fix item interactions */
  now= time('s')
  atkwindow=now-obj.drago.atkstart
  IF obj.drago.state==DR_ATTACK & atkwindow>1 & atkwindow<3 & WILL_COLLIDE(drago, "PL") THEN DO
    obj.pl.state=PL_DEAD
    CALL ERASE_PL
    obj.pl.x=obj.drago.x+1
    obj.pl.y=obj.drago.y+4
    obj.drago.state=DR_FULL
    obj.drago.atkstart=0
    DO i=0 TO obj.drago.h
      obj.drago.spr.i=_dragon.DR_ALIVE.i
    END
    CALL DRAW_INVERSE_OBJECT(drago)
    CALL DRAW_PL
    RETURN
  END
  ELSE IF obj.drago.state==DR_ATTACK & atkwindow>2 THEN DO
    obj.drago.state=DR_ALIVE
    obj.drago.atkstart=0
    DO i=0 TO obj.drago.h
      obj.drago.spr.i=_dragon.DR_ALIVE.i
    END
  END
  ELSE IF obj.drago.state==DR_ATTACK THEN RETURN
    
  /* OK 2 move dragon */

  obj.drago.dx=obj.drago.dx+obj.drago.spdx
  obj.drago.dy=obj.drago.dy+obj.drago.spdy
  IF obj.drago.dx>=1 & obj.drago.dy>=1 THEN DO
    IF obj.knub.equip~=drago THEN DO 
      CALL EXIT_WITH_MOTION(drago)
      CALL MOVE(drago,1,1)  /* move x and y */
      CALL DRAW_DRAGON(drago)
    END
    obj.drago.dx=0; obj.drago.dy=0
  END
  ELSE IF obj.drago.dx>=1 THEN DO
    IF obj.knub.equip~=drago THEN DO
      CALL EXIT_WITH_MOTION(drago)
      CALL MOVE(drago,1,0)  /* move x only */
      CALL DRAW_DRAGON(drago)
    END
    obj.drago.dx=0
  END
  ELSE IF obj.drago.dy>=1 THEN DO
    IF obj.knub.equip~=drago THEN DO
      CALL EXIT_WITH_MOTION(drago)
      CALL MOVE(drago,0,1)  /* move y only */
      CALL DRAW_DRAGON(drago)
    END
    obj.drago.dy=0
  END 
  IF debug==1 THEN CALL DEBUG_DRAGON
RETURN

RESET_DRAGONS:
  DO i=0 TO maxdragon
    d=dragon.i
    obj.d.state=DR_ALIVE  /* born again! */
    DO j=0 TO obj.d.h
      obj.d.spr.j=_dragon.DR_ALIVE.j
    END
  END
RETURN

SECRET:  /* TODO: fix trigger/untrigger with bat (fixed? need to test) */
  IF obj.pl.room==3 & obj.dot.room==3 THEN DO
    /* player and dot are both in room 3, we just need any other item or a dragon */
    
    /* check for any other item also in room 3 */
    DO s=0 TO maxsecretitem
      o=item.s
      IF obj.o.room==3 THEN DO
        k.3.re=30
        RETURN 1 /* dot in room 3 along with any other item */
      END
      ELSE k.3.re=1
    END
    
    /* any other item not found, check for a dragon */
    DO s=0 TO maxdragon
      d=dragon.s
      IF obj.d.room==3 THEN DO
        k.3.re=30
        RETURN 1
      END
      ELSE k.3.re=1
    END
  END
RETURN 0

EXIT_OBJ:  /* perform exit occurred on an object without motion */
  ARG exo
  exorm=obj.exo.room
  IF obj.exo.x+obj.exo.w>maxcol THEN CALL RIGHT_EXIT(exo, 0)
  ELSE IF obj.exo.x<mincol THEN CALL LEFT_EXIT(exo, 0)
  ELSE IF obj.exo.y<minline THEN CALL TOP_EXIT(exo)
  ELSE IF k.exorm.ci~=0 & obj.exo.x>37 & obj.exo.x<43 & obj.exo.y<castleline THEN CALL CASTLE_ENTRANCE(exo)
  ELSE IF obj.exo.y+obj.exo.h>maxline THEN DO 
    IF k.exorm.co==0 THEN CALL BOTTOM_EXIT(exo)
    ELSE CALL CASTLE_EXIT(exo)
  END   
RETURN

EXIT_WITH_MOTION:  /* perform exit on a object with motion */
  ARG exo
  exorm=obj.exo.room
  IF obj.exo.dirx>0 & obj.exo.x+obj.exo.w>=maxcol THEN DO
    IF exo==knub THEN CALL ERASE_BAT
    ELSE IF obj.exo.type=="dragon" THEN CALL ERASE_DRAGON(exo)
    ELSE call ERASE_OBJECT(exo)
    CALL RIGHT_EXIT(exo)
    RETURN 1
  END
  ELSE IF obj.exo.dirx<0 & obj.exo.x<=mincol THEN DO
    IF exo==knub THEN CALL ERASE_BAT
    ELSE IF obj.exo.type=="dragon" THEN CALL ERASE_DRAGON(exo)
    ELSE call ERASE_OBJECT(exo)
    CALL LEFT_EXIT(exo)
    RETURN 1
  END
  ELSE IF obj.exo.diry<0 THEN DO
     IF obj.exo.y<=minline THEN DO
       IF exo==knub THEN CALL ERASE_BAT
       ELSE IF obj.exo.type=="dragon" THEN CALL ERASE_DRAGON(exo)
       CALL TOP_EXIT(exo)
       RETURN 1
     END
     ELSE IF k.exorm.ci~=0 & obj.exo.x>37 & obj.exo.x<43 & obj.exo.y==castleline THEN DO
       IF exo==knub THEN CALL ERASE_BAT
       ELSE IF obj.exo.type=="dragon" THEN CALL ERASE_DRAGON(exo)
       ELSE call ERASE_OBJECT(exo)
       CALL CASTLE_ENTRANCE(exo)
       RETURN 1
     END
  END
  ELSE IF obj.exo.diry>0 & obj.exo.y+obj.exo.h>=maxline THEN DO   
    IF k.exorm.co==0 THEN DO
      IF exo==knub THEN CALL ERASE_BAT
      ELSE IF obj.exo.type=="dragon" THEN CALL ERASE_DRAGON(exo)
      ELSE call ERASE_OBJECT(exo)
      CALL BOTTOM_EXIT(exo)
      RETURN 1
    END
    ELSE DO
      IF exo==knub THEN CALL ERASE_BAT
      ELSE IF obj.exo.type=="dragon" THEN CALL ERASE_DRAGON(exo)
      ELSE call ERASE_OBJECT(exo)
      CALL CASTLE_EXIT(exo)
      RETURN 1 
    END
  END   
RETURN 0

TOP_EXIT:
  ARG exo
  crm=obj.exo.room
  IF k.crm.te==0 THEN RETURN  
  IF exo=="PL" THEN obj.exo.y=maxline-(obj.exo.diry)  /* diry should be -1 or 0 */
  ELSE obj.exo.y=maxline-obj.exo.h
  CALL NEXTROOM(exo, k.crm.te)
RETURN

BOTTOM_EXIT:
  ARG exo
  crm=obj.exo.room
  IF k.crm.be==0 THEN RETURN
  IF exo=="PL" THEN obj.exo.y=minline-obj.exo.diry  /* diry should be +1 or 0 */
  ELSE obj.exo.y=minline
  CALL NEXTROOM(exo, k.crm.be)
RETURN

LEFT_EXIT:
  ARG exo
  crm=obj.exo.room
  IF k.crm.le==0 THEN RETURN
  IF exo=="PL" THEN obj.exo.x=maxcol-(obj.exo.dirx)  /* dirx should be -1 or 0 */
  ELSE obj.exo.x=maxcol-obj.exo.w
  CALL NEXTROOM(exo, k.crm.le)
RETURN

RIGHT_EXIT:
  ARG exo
  crm=obj.exo.room
  IF k.crm.re==0 THEN RETURN
  IF exo=="PL" THEN obj.exo.x=mincol-(obj.exo.dirx+obj.exo.w)  /* dirx should be +1 or 0 */
  ELSE obj.exo.x=mincol
  CALL NEXTROOM(exo, k.crm.re)
RETURN

CASTLE_ENTRANCE:
  ARG exo
  crm=obj.exo.room
  IF k.crm.ci==0 THEN RETURN 
  IF exo=="PL" THEN obj.exo.y=maxline-(obj.exo.diry)  /* diry should be -1 or 0 */
  ELSE obj.exo.y=maxline-obj.exo.h
  CALL NEXTROOM(exo, k.crm.ci)
RETURN

CASTLE_EXIT:
  ARG exo
  crm=obj.exo.room
  IF k.crm.co==0 THEN RETURN      
  IF exo=="PL" THEN DO
    obj.exo.x=40; obj.exo.y=castleline-obj.exo.diry  /* diry should be +1 */
  END
  ELSE DO 
    obj.exo.x=40; obj.exo.y=castleline
  END
  CALL NEXTROOM(exo, k.crm.co)
RETURN

NEXTROOM:
  ARG exo, next_room
  obj.exo.room=next_room
  IF exo=="PL" THEN DO
    rm=next_room
    CALL DRAW_BG
    CALL DRAW_OBJS
    obj.light.drawn=0    
    IF rm==3 THEN CALL SECRET
    bufferflush
  END
RETURN

EXPAND_KINGDOM:  /* set up full size kingdom for difficulty 2 and 3 */
  k.1.be=15
  k.2.be=17
  k.3.be=10
  k.27.te=22; k.27.re=22; k.27.be=22; k.27.le=22
  k.28.be=12
  k.29.te=12
RETURN

INIT_PLAYER:  
  obj.pl.room=17
  obj.pl.x=40
  obj.pl.y=20
  obj.pl.w=1
  obj.pl.h=0
  obj.pl.dx=0
  obj.pl.dy=0
  obj.pl.spdx=1
  obj.pl.spdy=1
  obj.pl.dirx=0
  obj.pl.diry=0
  obj.pl.equip="NONE"
  obj.pl.state=PL_ALIVE
RETURN

INIT_FLASHLIGHT:  
  /* set default flashlight height and width (keep even numbers here) */
  SELECT
    WHEN flashlight==1 THEN flash_width=10  /* small flashlight */
    WHEN flashlight==2 THEN flash_width=14  /* medium flashlight */
    WHEN flashlight==3 THEN flash_width=18  /* large flashlight */
    OTHERWISE NOP
  END
  flash_height=flash_width/2
  obj.light.offx=(flash_width-2)/2   /* -2 due to player width */
  obj.light.offy=(flash_height-1)/2  /* -1 due to player height */
  obj.light.drawn=0
  
  RESET_FLASHLIGHT:  
  obj.light.w=flash_width-1  /* -1 to align with how other obj w is indexed */
  obj.light.h=flash_height-1  /* -1 to align with how other obj h is indexed */
  
  CALL GET_FLASHLIGHT_SIZE
RETURN
  
INIT_OBJECTS:
  /* sprite data */
  _gate.0="◊◊◊◊"
  _gate.1="◊◊◊◊"
  _gate.2="◊◊◊◊"
  _gate.3="ŒŒŒŒ"

  _dot.0="."
  _key.0="“ƒo"
  _sword.0="<--"
  
  _magnet.0="€ﬂ€"
  _magnet.1=" € "
  
  /* original bat sprites */
  /* _bat.0.0="ﬂ€€€€€€‹"
     _bat.0.1="ﬂ€€€€€€‹"
     _bat.0.2="€ﬂ‹  ‹ﬂ€"
     _bat.0.3="ﬂ ‹€€‹ ﬂ"
     _bat.0.4=" €€€€€€ "
     _bat.0.5="‹€€€€€€‹" 
    
     _bat.1.0=" €€€€€€ "
     _bat.1.1="  €€€€  "
     _bat.1.2="‹ ‹  ‹ ‹"
     _bat.1.3="€‹‹€€‹‹€" */    
  
  _bat.maxframe=1
  _bat.0.0=" €€€ "
  _bat.0.1=" ‹ ‹ "
  _bat.0.2="‹‹€‹‹"
  
  _bat.1.0="€€€€€"
  _bat.1.1="ﬂ‹ ‹ﬂ"
  _bat.1.2=" ‹€‹ "

  /* original dragon sprites */
  /* _dragon.0.0="€€€€ﬂ  ﬂ"
     _dragon.0.1="    ﬂﬂ ‹"
     _dragon.0.2="€€€€‹ ‹€"
     _dragon.0.3="€€€ﬂﬂ ﬂ€"
     _dragon.0.4="€ﬂ      "
     _dragon.0.5="  ‹€€€  "
     _dragon.0.6="  €€€ﬂ  "
     _dragon.0.7="‹‹    ‹‹"
     _dragon.0.8="ﬂ€€€ ﬂﬂﬂ"
     _dragon.0.9="‹‹ ﬂﬂﬂﬂ "

     _dragon.1.0="‹ﬂ€€€€€€"
     _dragon.1.1="€€‹ﬂﬂ  ﬂ"
     _dragon.1.2="€€€€ ﬂ ‹"
     _dragon.1.3="€€ﬂ‹‹ ‹€"
     _dragon.1.4="ﬂ‹€€ﬂ ﬂ€"
     _dragon.1.5="€€ﬂ    ﬂ"
     _dragon.1.6="€       "
     _dragon.1.7="€       "
     _dragon.1.8="€€‹   ‹€"
     _dragon.1.9="ﬂﬂﬂﬂ €€€"
     _dragon.1.10=" ﬂﬂ€€€€€"

     _dragon.2.0="€€€€ﬂﬂ€€"
     _dragon.2.1="€€€€  €€"
     _dragon.2.2="€€€ﬂ ‹ ﬂ"
     _dragon.2.3="ﬂ ‹‹   ‹"
     _dragon.2.4=" ﬂﬂﬂﬂﬂ€€"
     _dragon.2.5="       €"
     _dragon.2.6="€    ‹‹€"
     _dragon.2.7="€ﬂ €ﬂﬂﬂ€"
     _dragon.2.8="€ ﬂﬂﬂﬂ €" */
  
  _dragon.0.0="€€ﬂ ﬂ"
  _dragon.0.1="‹‹ﬂ ‹"
  _dragon.0.2="€€ﬂ €"
  _dragon.0.3="ﬂ ‹‹ "
  _dragon.0.4=" €€ﬂ "
  _dragon.0.5="‹   ‹"
  _dragon.0.6="€€ ﬂﬂ"
  _dragon.0.7=" ﬂﬂﬂ "

  _dragon.1.0="‹ﬂﬂ ﬂ"
  _dragon.1.1="€ﬂ ﬂ "
  _dragon.1.2="‹€ﬂ €"
  _dragon.1.3="ﬂ    "
  _dragon.1.4="     "
  _dragon.1.5="‹   ‹"
  _dragon.1.6="ﬂﬂ €€"
  _dragon.1.7=" ﬂ€€€"

  _dragon.2.0="€€ €€"
  _dragon.2.1="€ﬂ ‹ﬂ"
  _dragon.2.2=" ‹  ‹"
  _dragon.2.3=" ﬂﬂﬂ€"
  _dragon.2.4="     "
  _dragon.2.5="‹   ‹"
  _dragon.2.6="ﬂ €ﬂﬂ"
  _dragon.2.7=" ﬂﬂﬂ "
  
  /* original chalice sprite */
  /* _chalice.0="ﬂ€€€€€€ﬂ"
     _chalice.1=" ﬂ€€€€ﬂ "
     _chalice.2="€      €"
     _chalice.3="€€‹  ‹€€"
     _chalice.4="€ﬂﬂ  ﬂﬂ€" */
  
  _chalice.0=" ﬂﬂﬂ "
  _chalice.1="€‹ ‹€"
  _chalice.2="€ﬂ ﬂ€"
  
   _msg0.0="   "
   _msg0.1="C  "
   _msg0.2="r b"
   _msg0.3="e y"
   _msg0.4="a ."
   _msg0.5="t ."
   _msg0.6="e ."
   _msg0.7="d  "
   _msg0.8="  |"
   _msg0.9="W ."
  _msg0.10="a ."
  _msg0.11="r R"
  _msg0.12="r o"
  _msg0.13="e b"
  _msg0.14="n i"
  _msg0.15=". n"
  _msg0.16=". e"
  _msg0.17=". t"
  _msg0.18=". t"
  _msg0.19="   "
  
   _msg1.0="A  "
   _msg1.1="R b"
   _msg1.2="e y"
   _msg1.3="x ."
   _msg1.4="x ."
   _msg1.5="  ."
   _msg1.6="M ."
   _msg1.7="i k"
   _msg1.8="k 1"
   _msg1.9="e d"
  _msg1.10="  s"
  _msg1.11="K 3"
  _msg1.12="i n"
  _msg1.13="l s"
  _msg1.14="l 4"
  _msg1.15="e t"
  _msg1.16="w 1"
  _msg1.17="a 0"
  _msg1.18="l n"
  _msg1.19="d ."
  
  _msg2.0="Call [32m-X-[30mcaliber BBS"
  _msg2.1="bbs.aholix.net:6800"

  _msg3.0="Tell [32mK1ds3ns4t10n   "
  _msg3.1="that you found this "
  _msg3.2="message and what BBS"
  _msg3.3="you were on! =)     "

  /* _bridge.0="   "
     _bridge.1="€€ "
     _bridge.2="€€ "
     _bridge.3="€€ "
     _bridge.4="€€ "
     _bridge.5="   " */
     
  /* optimized bridge */
  _bridge.0="   "
  _bridge.1=" "
  _bridge.2=" "
  _bridge.3=" "
  _bridge.4=" "
  _bridge.5="   "
  
  /* bridge with motion pre-defined sprite data */
  /* all data is indexed from left by obj.bridge.x */
  /* naming format: bwm.section.xdir.ydir.line */
  
  /* up x=0, y=-1 */
  bwm.1.0.D_UP.0="   "; bwm.2.0.D_UP.0="   "
  bwm.1.0.D_UP.1="EE "; bwm.2.0.D_UP.1=" EE"
  bwm.1.0.D_UP.2="XX "; bwm.2.0.D_UP.2=" "
  bwm.1.0.D_UP.3="XX "; bwm.2.0.D_UP.3=" "
  bwm.1.0.D_UP.4="XX "; bwm.2.0.D_UP.4=" "
  bwm.1.0.D_UP.5="   "; bwm.2.0.D_UP.5="   "
  bwm.1.0.D_UP.6="EEE"; bwm.2.0.D_UP.6="EEE"
  
  /* down x=0 y=1 */
  bwm.1.0.D_DOWN.N1="EEE"; bwm.2.0.D_DOWN.N1="EEE"
  bwm.1.0.D_DOWN.0= "   "; bwm.2.0.D_DOWN.0= "   "
  bwm.1.0.D_DOWN.1= "XX "; bwm.2.0.D_DOWN.1= " "
  bwm.1.0.D_DOWN.2= "XX "; bwm.2.0.D_DOWN.2= " "
  bwm.1.0.D_DOWN.3= "XX "; bwm.2.0.D_DOWN.3= " "
  bwm.1.0.D_DOWN.4= "EE "; bwm.2.0.D_DOWN.4= " EE"
  bwm.1.0.D_DOWN.5= "   "; bwm.2.0.D_DOWN.5= "   "
  
  /* left x=-1 y=0 */
  /* erasex=1 will be conditionally added in the draw routine */
  bwm.1.D_LEFT.0.0="   E"; bwm.2.D_LEFT.0.0="   " /* +E if erasex==1 */
  bwm.1.D_LEFT.0.1="XX E"; bwm.2.D_LEFT.0.1=" E"
  bwm.1.D_LEFT.0.2="XX E"; bwm.2.D_LEFT.0.2=" E"
  bwm.1.D_LEFT.0.3="XX E"; bwm.2.D_LEFT.0.3=" E"
  bwm.1.D_LEFT.0.4="XX E"; bwm.2.D_LEFT.0.4=" E"
  bwm.1.D_LEFT.0.5="   E"; bwm.2.D_LEFT.0.5="   " /* +E if erasex==1 */
  
  /* right x=1 y=0 */
  /* erasex=-1 will be conditionally added in the draw routine */
  /* +E if erasex==-1 */ bwm.1.D_RIGHT.0.0="   "; bwm.2.D_RIGHT.0.0="E   "
                         bwm.1.D_RIGHT.0.1="XE "; bwm.2.D_RIGHT.0.1="E "
                         bwm.1.D_RIGHT.0.2="XE "; bwm.2.D_RIGHT.0.2="E "
                         bwm.1.D_RIGHT.0.3="XE "; bwm.2.D_RIGHT.0.3="E "
                         bwm.1.D_RIGHT.0.4="XE "; bwm.2.D_RIGHT.0.4="E "
  /* +E if erasex==-1 */ bwm.1.D_RIGHT.0.5="   "; bwm.2.D_RIGHT.0.5="E   "
  
  /* up and left x=-1 y=-1 */
  /* erasex=1 will be conditionally added in the draw routine */
  bwm.1.D_LEFT.D_UP.0="   ";  bwm.2.D_LEFT.D_UP.0="   "
  bwm.1.D_LEFT.D_UP.1="XE E"; bwm.2.D_LEFT.D_UP.1=" EE" /* +E if erasex==1 */
  bwm.1.D_LEFT.D_UP.2="XX E"; bwm.2.D_LEFT.D_UP.2=" E"
  bwm.1.D_LEFT.D_UP.3="XX E"; bwm.2.D_LEFT.D_UP.3=" E"
  bwm.1.D_LEFT.D_UP.4="XX E"; bwm.2.D_LEFT.D_UP.4=" E"
  bwm.1.D_LEFT.D_UP.5="   E"; bwm.2.D_LEFT.D_UP.5="   "
  bwm.1.D_LEFT.D_UP.6="XEEE"; bwm.2.D_LEFT.D_UP.6="XEE" /* +E if erasex==1 */
  
  /* down and left x=-1` y=1 */
  /* erasex=1 will be conditionally added in the draw routine */
  bwm.1.D_LEFT.D_DOWN.N1="XEEE"; bwm.2.D_LEFT.D_DOWN.N1="XEE" /* +E if erasex==1 */
  bwm.1.D_LEFT.D_DOWN.0= "   E"; bwm.2.D_LEFT.D_DOWN.0= "   "
  bwm.1.D_LEFT.D_DOWN.1= "XX E"; bwm.2.D_LEFT.D_DOWN.1= " E"
  bwm.1.D_LEFT.D_DOWN.2= "XX E"; bwm.2.D_LEFT.D_DOWN.2= " E"
  bwm.1.D_LEFT.D_DOWN.3= "XX E"; bwm.2.D_LEFT.D_DOWN.3= " E"
  bwm.1.D_LEFT.D_DOWN.4= "XE E"; bwm.2.D_LEFT.D_DOWN.4= " EE" /* +E if erasex==1 */
  bwm.1.D_LEFT.D_DOWN.5= "   ";  bwm.2.D_LEFT.D_DOWN.5= "   "
  
  /* up and right */
  /* erasex=-1 will be conditionally added in the draw routine */
                         bwm.1.D_RIGHT.D_UP.0="   "; bwm.2.D_RIGHT.D_UP.0="X   "
  /* +E if erasex==-1 */ bwm.1.D_RIGHT.D_UP.1="EE "; bwm.2.D_RIGHT.D_UP.1="E E"
                         bwm.1.D_RIGHT.D_UP.2="XE "; bwm.2.D_RIGHT.D_UP.2="E "
                         bwm.1.D_RIGHT.D_UP.3="XE "; bwm.2.D_RIGHT.D_UP.3="E "
                         bwm.1.D_RIGHT.D_UP.4="XE "; bwm.2.D_RIGHT.D_UP.4="E "
                         bwm.1.D_RIGHT.D_UP.5="   "; bwm.2.D_RIGHT.D_UP.5="E   "
  /* +E if erasex==-1 */ bwm.1.D_RIGHT.D_UP.6="EE" ; bwm.2.D_RIGHT.D_UP.6="EEE"
  
  /* down and right */
  /* erasex=-1 will be conditionally added in the draw routine */
  /* +E if erasex==-1 */ bwm.1.D_RIGHT.D_DOWN.N1="EE";  bwm.2.D_RIGHT.D_DOWN.N1="EEE"
                         bwm.1.D_RIGHT.D_DOWN.0= "   "; bwm.2.D_RIGHT.D_DOWN.0= "E   "
                         bwm.1.D_RIGHT.D_DOWN.1= "XE "; bwm.2.D_RIGHT.D_DOWN.1= "E "
                         bwm.1.D_RIGHT.D_DOWN.2= "XE "; bwm.2.D_RIGHT.D_DOWN.2= "E "
                         bwm.1.D_RIGHT.D_DOWN.3= "XE "; bwm.2.D_RIGHT.D_DOWN.3= "E "
  /* +E if erasex==-1 */ bwm.1.D_RIGHT.D_DOWN.4= "EE "; bwm.2.D_RIGHT.D_DOWN.4= "E E"
                         bwm.1.D_RIGHT.D_DOWN.5= "   "; bwm.2.D_RIGHT.D_DOWN.5= "X   "
  
  /* object lists */
  msg_toggle=1
  
  maxmsg=3
  msg.0="MSG0"
  msg.1="MSG1"
  msg.2="MSG2"
  msg.3="MSG3"
  
  maxgate=2
  gate.0="YGATE"
  gate.1="BGATE"
  gate.2="WGATE"
  
  maxmagnetitem=5
  maxsecretitem=6
  maxitem=7
  maxgrabitem=8
  maxdrawitem=11
  item.0="YKEY"
  item.1="WKEY"
  item.2="BKEY"
  item.3="SWORD"
  item.4="BRIDGE"
  item.5="CHALICE"
  item.6="MAGNET"
  item.7="DOT"
  item.8="KNUBBERRUB"
  item.9="YORGLE"
  item.10="GRUNDLE"
  item.11="RHINDLE"
  
  maxdragon=2
  dragon.0="YORGLE"
  dragon.1="GRUNDLE"
  dragon.2="RHINDLE" 
  
  /* want lists */ 
  want.knubberrub.max=5  /* TODO: fix this. limited for now */
  want.knubberrub.0="CHALICE"
  want.knubberrub.1="SWORD"
  want.knubberrub.2="BRIDGE"
  want.knubberrub.3="YKEY"
  want.knubberrub.4="WKEY"
  want.knubberrub.5="BKEY"
  want.knubberrub.6="RHINDLE"
  want.knubberrub.7="YORGLE"
  want.knubberrub.8="GRUNDLE"
  want.knubberrub.9="MAGNET"
  
  want.yorgle.max=1
  want.yorgle.0="PL"
  want.yorgle.1="CHALICE"
  
  want.grundle.max=4
  want.grundle.0="PL"
  want.grundle.1="CHALICE"
  want.grundle.2="BRIDGE"
  want.grundle.3="MAGNET"
  want.grundle.4="BKEY"
  
  want.rhindle.max=2
  want.rhindle.0="PL"
  want.rhindle.1="CHALICE"
  want.rhindle.2="WKEY"
  
  /* fear lists */
  fear.yorgle.max=0
  fear.yorgle.0="YKEY"
  
  fear.grundle.max=0
  fear.grundle.0="NONE"
  
  fear.rhindle.max=0
  fear.rhindle.0="NONE"
  
  /* object data */
  obj.msg0.room=30
  obj.msg0.x=40
  obj.msg0.y=3
  obj.msg0.h=19
  obj.msg0.w=2
  obj.msg0.dx=0
  obj.msg0.dy=0
  obj.msg0.col="[1;47;36m"
  obj.msg0.spr.0=_msg0.0
  obj.msg0.spr.1=_msg0.1
  obj.msg0.spr.2=_msg0.2
  obj.msg0.spr.3=_msg0.3
  obj.msg0.spr.4=_msg0.4
  obj.msg0.spr.5=_msg0.5
  obj.msg0.spr.6=_msg0.6
  obj.msg0.spr.7=_msg0.7
  obj.msg0.spr.8=_msg0.8
  obj.msg0.spr.9=_msg0.9
  obj.msg0.spr.10=_msg0.10
  obj.msg0.spr.11=_msg0.11
  obj.msg0.spr.12=_msg0.12
  obj.msg0.spr.13=_msg0.13
  obj.msg0.spr.14=_msg0.14
  obj.msg0.spr.15=_msg0.15
  obj.msg0.spr.16=_msg0.16
  obj.msg0.spr.17=_msg0.17
  obj.msg0.spr.18=_msg0.18
  obj.msg0.spr.19=_msg0.19
  
  obj.msg1.room=30
  obj.msg1.x=40
  obj.msg1.y=3
  obj.msg1.h=19
  obj.msg1.w=2
  obj.msg1.dx=0
  obj.msg1.dy=0
  obj.msg1.col="[1;47;36m"
  obj.msg1.spr.0=_msg1.0
  obj.msg1.spr.1=_msg1.1
  obj.msg1.spr.2=_msg1.2
  obj.msg1.spr.3=_msg1.3
  obj.msg1.spr.4=_msg1.4
  obj.msg1.spr.5=_msg1.5
  obj.msg1.spr.6=_msg1.6
  obj.msg1.spr.7=_msg1.7
  obj.msg1.spr.8=_msg1.8
  obj.msg1.spr.9=_msg1.9
  obj.msg1.spr.10=_msg1.10
  obj.msg1.spr.11=_msg1.11
  obj.msg1.spr.12=_msg1.12
  obj.msg1.spr.13=_msg1.13
  obj.msg1.spr.14=_msg1.14
  obj.msg1.spr.15=_msg1.15
  obj.msg1.spr.16=_msg1.16
  obj.msg1.spr.17=_msg1.17
  obj.msg1.spr.18=_msg1.18
  obj.msg1.spr.19=_msg1.19
  
  obj.msg2.room=30
  obj.msg2.x=54
  obj.msg2.y=9
  obj.msg2.h=1
  obj.msg2.w=18
  obj.msg2.dx=0
  obj.msg2.dy=0
  obj.msg2.col="[1;47;30m"
  obj.msg2.spr.0=_msg2.0
  obj.msg2.spr.1=_msg2.1
  
  obj.msg3.room=30
  obj.msg3.x=54
  obj.msg3.y=13
  obj.msg3.h=3
  obj.msg3.w=19
  obj.msg3.dx=0
  obj.msg3.dy=0
  obj.msg3.col="[1;47;30m"
  obj.msg3.spr.0=_msg3.0
  obj.msg3.spr.1=_msg3.1
  obj.msg3.spr.2=_msg3.2
  obj.msg3.spr.3=_msg3.3
 
  obj.ygate.room=17
  obj.ygate.x=39
  obj.ygate.y=15
  obj.ygate.h=3
  obj.ygate.w=3
  obj.ygate.dx=0
  obj.ygate.dy=0
  obj.ygate.col="[0;47;30m"
  obj.ygate.spr.0=_gate.0
  obj.ygate.spr.1=_gate.1
  obj.ygate.spr.2=_gate.2
  obj.ygate.spr.3=_gate.3
  obj.ygate.locked=1
  obj.ygate.key="YKEY"
  
  obj.bgate.room=16
  obj.bgate.x=39
  obj.bgate.y=15
  obj.bgate.h=3
  obj.bgate.w=3
  obj.bgate.dx=0
  obj.bgate.dy=0
  obj.bgate.col="[0;47;30m"
  obj.bgate.spr.0=_gate.0
  obj.bgate.spr.1=_gate.1
  obj.bgate.spr.2=_gate.2
  obj.bgate.spr.3=_gate.3
  obj.bgate.locked=1
  obj.bgate.key="BKEY"
  
  obj.wgate.room=15
  obj.wgate.x=39
  obj.wgate.y=15
  obj.wgate.h=3
  obj.wgate.w=3
  obj.wgate.dx=0
  obj.wgate.dy=0
  obj.wgate.col="[0;47;30m"
  obj.wgate.spr.0=_gate.0
  obj.wgate.spr.1=_gate.1
  obj.wgate.spr.2=_gate.2
  obj.wgate.spr.3=_gate.3
  obj.wgate.locked=1
  obj.wgate.key="WKEY"
  
  obj.ykey.room=17 
  obj.ykey.x=17
  obj.ykey.y=11
  obj.ykey.w=2
  obj.ykey.h=0
  obj.ykey.dx=0
  obj.ykey.dy=0
  obj.ykey.spdx=0.0625
  obj.ykey.spdy=0.03125
  obj.ykey.dirx=0
  obj.ykey.diry=0
  obj.ykey.offset.x=0
  obj.ykey.offset.y=0
  obj.ykey.col="[1;33m"
  obj.ykey.spr.0=_key.0
  obj.ykey.lvl3.0=1   /* random room lower limit */
  obj.ykey.lvl3.1=29  /* random room upper limit */
  
  obj.bkey.room=29
  obj.bkey.x=17
  obj.bkey.y=11
  obj.bkey.w=2
  obj.bkey.h=0
  obj.bkey.dx=0
  obj.bkey.dy=0
  obj.bkey.spdx=0.0625
  obj.bkey.spdy=0.03125
  obj.bkey.dirx=0
  obj.bkey.diry=0
  obj.bkey.offset.x=0
  obj.bkey.offset.y=0
  obj.bkey.col="[0;30m"
  obj.bkey.spr.0=_key.0
  obj.bkey.lvl3.0=1   /* random room lower limit */
  obj.bkey.lvl3.1=18  /* random room upper limit */
  
  obj.wkey.room=14
  obj.wkey.x=17
  obj.wkey.y=11
  obj.wkey.w=2
  obj.wkey.h=0
  obj.wkey.dx=0
  obj.wkey.dy=0
  obj.wkey.spdx=0.0625
  obj.wkey.spdy=0.03125
  obj.wkey.dirx=0
  obj.wkey.diry=0
  obj.wkey.offset.x=0
  obj.wkey.offset.y=0
  obj.wkey.col="[1;37m"
  obj.wkey.spr.0=_key.0
  obj.wkey.lvl3.0=1   /* random room lower limit */
  obj.wkey.lvl3.1=22  /* random room upper limit */
  
  obj.sword.room=18
  obj.sword.x=17
  obj.sword.y=11
  obj.sword.w=2
  obj.sword.h=0
  obj.sword.dx=0
  obj.sword.dy=0
  obj.sword.spdx=0.0625
  obj.sword.spdy=0.03125
  obj.sword.dirx=0
  obj.sword.diry=0
  obj.sword.offset.x=0
  obj.sword.offset.y=0
  obj.sword.col="[1;33m"
  obj.sword.spr.0=_sword.0
  obj.sword.lvl3.0=1   /* random room lower limit */
  obj.sword.lvl3.1=29  /* random room upper limit */

  obj.magnet.type="inverse"
  obj.magnet.room=27
  obj.magnet.x=64
  obj.magnet.y=19
  obj.magnet.w=2
  obj.magnet.h=1
  obj.magnet.dx=0
  obj.magnet.dy=0
  obj.magnet.dirx=0
  obj.magnet.diry=0
  obj.magnet.offset.x=0
  obj.magnet.offset.y=0
  obj.magnet.col="[40m"
  obj.magnet.spr.0=_magnet.0
  obj.magnet.spr.1=_magnet.1
  obj.magnet.busy=0
  obj.magnet.want="NONE"
  obj.magnet.lvl3.0=1   /* random room lower limit */
  obj.magnet.lvl3.1=29  /* random room upper limit */
  
  obj.chalice.type="inverse"
  obj.chalice.room=28
  obj.chalice.x=25 /* TODO: fix */
  obj.chalice.y=5 /* TODO: fix */
  obj.chalice.w=4
  obj.chalice.h=2
  obj.chalice.dx=0
  obj.chalice.dy=0
  obj.chalice.spdx=0.25
  obj.chalice.spdy=0.125
  obj.chalice.dirx=0
  obj.chalice.diry=0
  obj.chalice.offset.x=0
  obj.chalice.offset.y=0
  obj.chalice.col="[45m" /* TODO: color cycle? */
  obj.chalice.spr.0=_chalice.0
  obj.chalice.spr.1=_chalice.1
  obj.chalice.spr.2=_chalice.2
  obj.chalice.lvl3.0=19  /* random room lower limit */
  obj.chalice.lvl3.1=26  /* random room upper limit */
  
  obj.bridge.type="inverse"
  obj.bridge.room=4
  obj.bridge.x=20 
  obj.bridge.y=14 
  obj.bridge.w=11
  obj.bridge.h=5
  obj.bridge.dx=0
  obj.bridge.dy=0
  obj.bridge.spdx=0.25
  obj.bridge.spdy=0.125
  obj.bridge.dirx=0
  obj.bridge.diry=0
  obj.bridge.offset.x=0
  obj.bridge.offset.y=0
  obj.bridge.col="[45m"
  obj.bridge.spr.0=_bridge.0
  obj.bridge.spr.1=_bridge.1
  obj.bridge.spr.2=_bridge.2
  obj.bridge.spr.3=_bridge.3
  obj.bridge.spr.4=_bridge.4
  obj.bridge.spr.5=_bridge.5
  obj.bridge.foot=3 /* width of the L shaped wall of the bridge */
  obj.bridge.gap=6  /* the walkable part of the bridge */
  obj.bridge.p2xoff=obj.bridge.foot+obj.bridge.gap /* part 2 x offset: bridge foot + brige gap */
  obj.bridge.lvl3.0=1   /* random room lower limit */
  obj.bridge.lvl3.1=29  /* random room upper limit */
  
  obj.dot.room=21  /* orig 21, test 3  */
  obj.dot.x=34     /* orig 34, test 74 */
  obj.dot.y=22     /* orig 22, test 23 */
  obj.dot.w=0
  obj.dot.h=0
  obj.dot.dx=0
  obj.dot.dy=0
  obj.dot.dirx=0
  obj.dot.diry=0
  obj.dot.offset.x=0
  obj.dot.offset.y=0
  obj.dot.col="[0;37m"
  obj.dot.spr.0=_dot.0
  obj.dot.lvl3.0=0  /* random room lower limit */
  obj.dot.lvl3.1=0  /* random room upper limit */
  
  knub="KNUBBERRUB"  /* handy shortcut because i'm too lazy to type his full name every god damn time */
  /* obj.knubberrub.type="inverse" */
  obj.knubberrub.room=2 
  obj.knubberrub.x=17 
  obj.knubberrub.y=19 /* TODO: fix */
  obj.knubberrub.w=4
  obj.knubberrub.h=2
  obj.knubberrub.dx=0
  obj.knubberrub.dy=0
  obj.knubberrub.spdx=0.03125  /* 1/32 */
  obj.knubberrub.spdy=0.015625 /* 1/64 */
  obj.knubberrub.dirx=0
  obj.knubberrub.diry=1
  obj.knubberrub.offset.x=0
  obj.knubberrub.offset.y=0
  obj.knubberrub.col="[40m"
  obj.knubberrub.frame=0  /* frame counter */
  obj.knubberrub.maxframe=_bat.maxframe
  obj.knubberrub.animspd=0.0078125 /* 1/128 */
  obj.knubberrub.spr.0=_bat.0.0
  obj.knubberrub.spr.1=_bat.0.1
  obj.knubberrub.spr.2=_bat.0.2
  obj.knubberrub.equip="NONE"
  obj.knubberrub.want="NONE"
  obj.knubberrub.fedup=0
  obj.knubberrub.maxfedup=5000 
  obj.knubberrub.seek=0
  obj.knubberrub.lvl3.0=1   /* random room lower limit */
  obj.knubberrub.lvl3.1=29  /* random room upper limit */
  
  obj.yorgle.type="dragon"
  obj.yorgle.room=30 /* TODO: fix */
  obj.yorgle.x=1 /* TODO: fix */
  obj.yorgle.y=1 /* TODO: fix */
  obj.yorgle.w=4
  obj.yorgle.h=7
  obj.yorgle.dx=0
  obj.yorgle.dy=0
  obj.yorgle.spdx=0.5
  obj.yorgle.spdy=0.25
  obj.yorgle.dirx=-1
  obj.yorgle.diry=0
  obj.yorgle.offset.x=0
  obj.yorgle.offset.y=0
  obj.yorgle.col="[43m"
  obj.yorgle.spr.0=_dragon.0.0
  obj.yorgle.spr.1=_dragon.0.1
  obj.yorgle.spr.2=_dragon.0.2
  obj.yorgle.spr.3=_dragon.0.3
  obj.yorgle.spr.4=_dragon.0.4
  obj.yorgle.spr.5=_dragon.0.5
  obj.yorgle.spr.6=_dragon.0.6
  obj.yorgle.spr.7=_dragon.0.7
  obj.yorgle.fear="NONE"
  obj.yorgle.want="NONE"
  obj.yorgle.atkwait=delayedattack
  obj.yorgle.lvl3.0=1   /* random room lower limit */
  obj.yorgle.lvl3.1=29  /* random room upper limit */
  obj.yorgle.state=DR_ALIVE
  obj.yorgle.atkstart=0
  
  obj.grundle.type="dragon"
  obj.grundle.room=30 /* TODO: fix */
  obj.grundle.x=1 /* TODO: fix */
  obj.grundle.y=1 /* TODO: fix */
  obj.grundle.w=4
  obj.grundle.h=7
  obj.grundle.dx=0
  obj.grundle.dy=0
  obj.grundle.spdx=1
  obj.grundle.spdy=1
  obj.grundle.dirx=0
  obj.grundle.diry=0
  obj.grundle.offset.x=0
  obj.grundle.offset.y=0
  obj.grundle.col="[42m"
  obj.grundle.spr.0=_dragon.0.0
  obj.grundle.spr.1=_dragon.0.1
  obj.grundle.spr.2=_dragon.0.2
  obj.grundle.spr.3=_dragon.0.3
  obj.grundle.spr.4=_dragon.0.4
  obj.grundle.spr.5=_dragon.0.5
  obj.grundle.spr.6=_dragon.0.6
  obj.grundle.spr.7=_dragon.0.7
  obj.grundle.fear="NONE"
  obj.grundle.want="NONE"
  obj.grundle.atkwait=delayedattack
  obj.grundle.lvl3.0=1   /* random room lower limit */
  obj.grundle.lvl3.1=29  /* random room upper limit */
  obj.grundle.state=DR_ALIVE
  obj.grundle.atkstart=0  
  
  obj.rhindle.type="dragon"
  obj.rhindle.room=30 /* TODO: fix */
  obj.rhindle.x=1 /* TODO: fix */
  obj.rhindle.y=1 /* TODO: fix */
  obj.rhindle.w=4
  obj.rhindle.h=7
  obj.rhindle.dx=0
  obj.rhindle.dy=0
  obj.rhindle.spdx=1
  obj.rhindle.spdy=1
  obj.rhindle.dirx=0
  obj.rhindle.diry=0
  obj.rhindle.offset.x=0
  obj.rhindle.offset.y=0
  obj.rhindle.col="[41m"
  obj.rhindle.spr.0=_dragon.0.0
  obj.rhindle.spr.1=_dragon.0.1
  obj.rhindle.spr.2=_dragon.0.2
  obj.rhindle.spr.3=_dragon.0.3
  obj.rhindle.spr.4=_dragon.0.4
  obj.rhindle.spr.5=_dragon.0.5
  obj.rhindle.spr.6=_dragon.0.6
  obj.rhindle.spr.7=_dragon.0.7
  obj.rhindle.fear="NONE"
  obj.rhindle.want="NONE"
  obj.rhindle.atkwait=delayedattack 
  obj.rhindle.lvl3.0=1   /* random room lower limit */
  obj.rhindle.lvl3.1=29  /* random room upper limit */
  obj.rhindle.state=DR_ALIVE
  obj.rhindle.atkstart=0
RETURN
 
INIT_KINGDOM:  /* room data */
  /* splash screen */
  k.0.dark=0
  k.0.c="[1;47;33m"; k.0.fc="[1;33m"; k.0.bc="[47m"; k.0.bc2="[43m"
  k.0.te=0; k.0.re=0; k.0.be=0; k.0.le=0; k.0.ci=0; k.0.co=0
  k.0.map="SPLASH_MAP"

  /* light green hall below blue maze */
  k.1.dark=0
  k.1.c="[1;47;32m"; k.1.fc="[1;32m"; k.1.bc="[47m"; k.1.bc2="[42m"
  k.1.te=8; k.1.re=2; k.1.be=16; k.1.le=3; k.1.ci=0; k.1.co=0
  k.1.map="BOTTOM_LFT_MAP"

  /* dark green hall below yellow castle */
  k.2.dark=0
  k.2.c="[0;47;32m"; k.2.fc="[0;32m"; k.2.bc="[47m"; k.2.bc2="[42m"
  k.2.te=17; k.2.re=3; k.2.be=5; k.2.le=1; k.2.ci=0; k.2.co=0
  k.2.map="BOTTOM_MID_MAP"

  /* dark orange hall above invisible maze */
  k.3.dark=0
  k.3.c="[0;47;33m"; k.3.fc="[0;33m"; k.3.bc="[47m"; k.3.bc2="[43m"
  k.3.te=6; k.3.re=1; k.3.be=29; k.3.le=2; k.3.ci=0; k.3.co=0
  k.3.map="TOP_RHT_MAP"

  /* blue maze top center */
  k.4.dark=0
  k.4.c="[0;47;34m"; k.4.fc="[0;34m"; k.4.bc="[47m"; k.4.bc2="[44m"
  k.4.te=16; k.4.re=5; k.4.be=7; k.4.le=6; k.4.ci=0; k.4.co=0
  k.4.map="BMAZE0_MAP"

  /* blue maze left side */
  k.5.dark=0
  k.5.c="[0;47;34m"; k.5.fc="[0;34m"; k.5.bc="[47m"; k.5.bc2="[44m"
  k.5.te=29; k.5.re=6; k.5.be=8; k.5.le=4; k.5.ci=0; k.5.co=0
  k.5.map="BMAZE3_MAP"

  /* blue maze bottom center */
  k.6.dark=0
  k.6.c="[0;47;34m"; k.6.fc="[0;34m"; k.6.bc="[47m"; k.6.bc2="[44m"
  k.6.te=7; k.6.re=4; k.6.be=3; k.6.le=5; k.6.ci=0; k.6.co=0
  k.6.map="BMAZE2_MAP"

  /* blue maze center */
  k.7.dark=0
  k.7.c="[0;47;34m"; k.7.fc="[0;34m"; k.7.bc="[47m"; k.7.bc2="[44m"
  k.7.te=4; k.7.re=8; k.7.be=6; k.7.le=8; k.7.ci=0; k.7.co=0
  k.7.map="BMAZE1_MAP"

  /* entrance to blue maze */
  k.8.dark=0
  k.8.c="[0;47;34m"; k.8.fc="[0;34m"; k.8.bc="[47m"; k.8.bc2="[44m"
  k.8.te=5; k.8.re=7; k.8.be=1; k.8.le=7; k.8.ci=0; k.8.co=0
  k.8.map="BMAZE4_MAP"

  /* invisible maze center */
  k.9.dark=1
  k.9.c="[0;47;37m"; k.9.fc="[0;37m"; k.9.bc="[47m"; k.9.bc2="[47m"
  IF flashlight==0 THEN k.9.fc="[22;33m"
  k.9.te=10; k.9.re=10; k.9.be=11; k.9.le=10; k.9.ci=0; k.9.co=0
  k.9.map="IMAZE1_MAP"

  /* entrance to invisible maze */
  k.10.dark=1
  k.10.c="[0;47;37m"; k.10.fc="[0;37m"; k.10.bc="[47m"; k.10.bc2="[47m"
  IF flashlight==0 THEN k.10.fc="[22;33m"
  k.10.te=3; k.10.re=9; k.10.be=9; k.10.le=9; k.10.ci=0; k.10.co=0
  k.10.map="IMAZE0_MAP"

  /* invisible maze bottom */
  k.11.dark=1
  k.11.c="[0;47;37m"; k.11.fc="[0;37m"; k.11.bc="[47m"; k.11.bc2="[47m"
  IF flashlight==0 THEN k.11.fc="[22;33m"
  k.11.te=9; k.11.re=12; k.11.be=28; k.11.le=13; k.11.ci=0; k.11.co=0
  k.11.map="IMAZE2_MAP"

  /* wyatt, your kitchen is blue */
  k.12.dark=0
  k.12.c="[1;47;34m"; k.12.fc="[1;34m"; k.12.bc="[47m"; k.12.bc2="[44m"
  k.12.te=28; k.12.re=13; k.12.be=29; k.12.le=11; k.12.ci=0; k.12.co=0
  k.12.map="MIDDLE_RHT_MAP"

  /* side hall below white castle */
  k.13.dark=0
  k.13.c="[1;47;32m"; k.13.fc="[1;32m"; k.13.bc="[47m"; k.13.bc2="[42m"
  k.13.te=15; k.13.re=11; k.13.be=14; k.13.le=12; k.13.ci=0; k.13.co=0
  k.13.map="MIDDLE_LFT_MAP"

  /* dark green top entry room */
  k.14.dark=0
  k.14.c="[0;47;32m"; k.14.fc="[0;32m"; k.14.bc="[47m"; k.14.bc2="[42m"
  k.14.te=13; k.14.re=16; k.14.be=15; k.14.le=16; k.14.ci=0; k.14.co=0
  k.14.map="BOTTOM_MAP"

  /* send me a crave case! */
  k.15.dark=0
  k.15.c="[1;47;37m"; k.15.fc="[1;37m"; k.15.bc="[47m"; k.15.bc2="[46m"
  k.15.te=14; k.15.re=15; k.15.be=13; k.15.le=15; k.15.ci=26; k.15.co=0
  k.15.map="CASTLE_MAP"

  /* black castle */
  k.16.dark=0
  k.16.c="[0;47;30m"; k.16.fc="[0;30m"; k.16.bc="[47m"; k.16.bc2="[40m"
  k.16.te=1; k.16.re=28; k.16.be=4; k.16.le=28; k.16.ci=27; k.16.co=0
  k.16.map="CASTLE_MAP"

  /* yellow castle */
  k.17.dark=0
  k.17.c="[1;47;33m"; k.17.fc="[1;33m"; k.17.bc="[47m"; k.17.bc2="[43m"
  k.17.te=6; k.17.re=3; k.17.be=2; k.17.le=1; k.17.ci=18; k.17.co=0
  k.17.map="CASTLE_MAP"

  /* yellow castle interior */
  k.18.dark=0
  k.18.c="[1;47;33m"; k.18.fc="[1;33m"; k.18.bc="[47m"; k.18.bc2="[43m"
  k.18.te=18; k.18.re=18; k.18.be=18; k.18.le=18; k.18.ci=0; k.18.co=17
  k.18.map="TOP_MAP"

  /* black castle maze top left */
  k.19.dark=1
  k.19.c="[0;47;37m"; k.19.fc="[0;37m"; k.19.bc="[47m"; k.19.bc2="[43m"
  IF flashlight==0 THEN k.19.fc="[0;33m"
  k.19.te=21; k.19.re=20; k.19.be=21; k.19.le=22; k.19.ci=0; k.19.co=0
  k.19.map="BCMAZE0_MAP"

  /* black castle maze top right */
  k.20.dark=1
  k.20.c="[0;47;37m"; k.20.fc="[0;37m"; k.20.bc="[47m"; k.20.bc2="[47m"
  IF flashlight==0 THEN k.20.fc="[0;33m"
  k.20.te=22; k.20.re=21; k.20.be=22; k.20.le=19; k.20.ci=0; k.20.co=0
  k.20.map="BCMAZE1_MAP"

  /* black castle maze bottom left */
  k.21.dark=1
  k.21.c="[0;47;37m"; k.21.fc="[0;37m"; k.21.bc="[47m"; k.21.bc2="[47m"
  IF flashlight==0 THEN k.21.fc="[0;33m"
  k.21.te=19; k.21.re=22; k.21.be=19; k.21.le=20; k.21.ci=0; k.21.co=0
  k.21.map="BCMAZE2_MAP"

  /* entrance to black castle maze */
  k.22.dark=1
  k.22.c="[0;47;37m"; k.22.fc="[0;37m"; k.22.bc="[47m"; k.22.bc2="[47m"
  IF flashlight==0 THEN k.22.fc="[0;33m"
  k.22.te=20; k.22.re=19; k.22.be=27; k.22.le=21; k.22.ci=0; k.22.co=0
  k.22.map="BCMAZE3_MAP"

  /* white castle maze top left */
  k.23.dark=0
  k.23.c="[0;47;31m"; k.23.fc="[0;31m"; k.23.bc="[47m"; k.23.bc2="[41m"
  k.23.te=25; k.23.re=24; k.23.be=25; k.23.le=24; k.23.ci=0; k.23.co=0
  k.23.map="WCMAZE0_MAP"

  /* white castle maze top right */
  k.24.dark=0
  k.24.c="[0;47;31m"; k.24.fc="[0;31m"; k.24.bc="[47m"; k.24.bc2="[41m"
  k.24.te=26; k.24.re=23; k.24.be=26; k.24.le=23; k.24.ci=0; k.24.co=0
  k.24.map="WCMAZE1_MAP"

  /* white castle maze bottom left */
  k.25.dark=0
  k.25.c="[0;47;31m"; k.25.fc="[0;31m"; k.25.bc="[47m"; k.25.bc2="[41m"
  k.25.te=23; k.25.re=26; k.25.be=23; k.25.le=26; k.25.ci=0; k.25.co=0
  k.25.map="WCMAZE2_MAP"

  /* entrance to white castle maze */
  k.26.dark=0
  k.26.c="[0;47;31m"; k.26.fc="[0;31m"; k.26.bc="[47m"; k.26.bc2="[41m"
  k.26.te=24; k.26.re=25; k.26.be=24; k.26.le=25; k.26.ci=0; k.26.co=15
  k.26.map="WCMAZE3_MAP"

  /* black castle foyer */
  k.27.dark=0
  k.27.c="[0;47;31m"; k.27.fc="[0;31m"; k.27.bc="[47m"; k.27.bc2="[41m"
  k.27.te=28; k.27.re=28; k.27.be=28; k.27.le=28; k.27.ci=0; k.27.co=16
  k.27.map="MIDDLE_MAP"

  /* the other purple room */
  k.28.dark=0
  k.28.c="[0;47;35m"; k.28.fc="[0;35m"; k.28.bc="[47m"; k.28.bc2="[45m"
  k.28.te=29; k.28.re=7; k.28.be=27; k.28.le=8; k.28.ci=0; k.28.co=0
  k.28.map="TOP_MAP"

  /* nothing to see here, red top entry room */
  k.29.dark=0
  k.29.c="[0;47;31m"; k.29.fc="[0;31m"; k.29.bc="[47m"; k.29.bc2="[41m"
  k.29.te=3; k.29.re=1; k.29.be=16; k.29.le=3; k.29.ci=0; k.29.co=0
  k.29.map="BOTTOM_MAP"

  /* roll credits */
  k.30.dark=0
  k.30.c="[0;47;35m"; k.30.fc="[0;35m"; k.30.bc="[47m"; k.30.bc2="[45m"
  k.30.te=6; k.30.re=1; k.30.be=6; k.30.le=3; k.30.ci=0; k.30.co=0
  k.30.map="BOTTOM_MID_MAP"

   k.SPLASH_MAP.1="[1;47;33m€€€€€€€€€€€€€€€€€€€€€  €€  €€  €€            €€  €€  €€  €€€€€€€€€€€€€€€€€€€€€[0m"
   k.SPLASH_MAP.2="[1;47;33m€€€€€€€€€€€€€€€€€€€€€  €€  €€  €€            €€  €€  €€  €€€€€€€€€€€€€€€€€€€€€[0m"
   k.SPLASH_MAP.3="[1;47;33m€€€                €€€€€€€€€€€€€€            €€€€€€€€€€€€€€                €€€[0m"
   k.SPLASH_MAP.4="[1;47;33m€€€                €€€€€€€€€€€€€€            €€€€€€€€€€€€€€                €€€[0m"
   k.SPLASH_MAP.5="[1;47;33m€€€            [0;40m [47;37m€€€[1;33m€€€[40m [47m€€€€€€€€€€            €€€€€€€€€€€€€€                €€€[0m"
   k.SPLASH_MAP.6="[1;47;33m€€€            [0;40m  [47;37m€€[1;33m€€[40m  [47m€€€€€€€€€€            [1;33m€€€€€€€€€€€€€€                €€€[0m"
   k.SPLASH_MAP.7="[1;47;33m€€€            [0;47;37m‹[40m ‹ [1;40;33m ‹ ‹[47m€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                [1;33m€€€[0m"
   k.SPLASH_MAP.8="[1;47;33m€€€            [0;47;30m ﬂﬂ [1;40;33m€‹‹€[47m€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                [1;33m€€€[0m"
   k.SPLASH_MAP.9="[1;47;33m€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                [1;33m€€€[0m"
  k.SPLASH_MAP.10="[1;47;33m€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                [1;33m€€€[0m"
  k.SPLASH_MAP.11="[1;47;33m€€€           ‹‹‹      €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                    [1;33m€€€[0m"
  k.SPLASH_MAP.12="[1;47;33m€€€       €ﬂ€ﬂ€‹€      €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                    [1;33m€€€[0m"
  k.SPLASH_MAP.13="[1;47;33m€€€                    €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                    [1;33m€€€[0m"
  k.SPLASH_MAP.14="[1;47;33m€€€                    €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€[0;47;37m€€€[42mﬂ  ﬂ[1;47;33m              [1;33m€€€[0m"
  k.SPLASH_MAP.15="[1;47;33m€€€                    €€€€€€€€€€€€  [0;47;30m◊◊◊◊[1;33m  €€€€€€€€€€€[0;42;37m    ﬂﬂ ‹[1;47;33m             [1;33m€€€[0m"
  k.SPLASH_MAP.16="[1;47;33m€€€                    €€€€€€€€€€€€  [0;47;30m◊◊◊◊[1;33m  €€€€€€€€€€€€[0;47;37m€€€€[42m‹ ‹[47;37m€[1;47;33m             [1;33m€€€[0m"
  k.SPLASH_MAP.17="[1;47;33m€€€                    €€€€€€€€€€€€  [0;47;30m◊◊◊◊[1;33m  €€€€€€€€€€€€[0;47;37m€€[42mﬂﬂ ﬂ[47;37m€[1;47;33m             [1;33m€€€[0m"
  k.SPLASH_MAP.18="[1;47;33m€€€                    €€€€€€€€€€€€  [0;47;30mŒŒŒŒ[1;33m  €€€€€€€€€€€€[0;42;37mﬂ      [1;47;33m             [1;33m€€€[0m"
  k.SPLASH_MAP.19="[1;47;33m€€€                                                   [0;42;37m  ‹[47;37m€€€[42m  [1;47;33m             [1;33m€€€[0m"
  k.SPLASH_MAP.20="[1;47;33m€€€                                   [1;33m€€               [0;42;37m  [47;37m€€€[42mﬂ  [1;47;33m             [1;33m€€€[0m"
  k.SPLASH_MAP.21="[1;47;33m€€€   [0;45;30m   [1;47;33m      [45;35m   [47;33m                                    [0;42;37m‹‹    ‹‹[1;47;33m             [1;33m€€€[0m"
  k.SPLASH_MAP.22="[1;47;33m€€€     [45;35m [47;33m      [45;35m [47;33m                                      [0;42;37mﬂ[47;37m€€€[42m ﬂﬂﬂ[1;47;33m             [1;33m€€€[0m"
  k.SPLASH_MAP.23="[1;47;33m€€€€€€€€[45;35m [47;33m€€€€€€[45;35m [47;33m€€€€€€€€€€€€€€€                €€€€€€€[42m‹‹ ﬂﬂﬂﬂ [47m€€€€€€€€€€€€€€€€[0m"
  k.SPLASH_MAP.24="[1;47;33m€€€€€€€€[45;35m [47;33m€€€€€€[45;35m [47;33m€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€[0m"

   k.CASTLE_MAP.1="€€€€€€€€€€€€€€€€€€€€€  €€  €€  €€            €€  €€  €€  €€€€€€€€€€€€€€€€€€€€€"
   k.CASTLE_MAP.2="€€€€€€€€€€€€€€€€€€€€€  €€  €€  €€            €€  €€  €€  €€€€€€€€€€€€€€€€€€€€€"
   k.CASTLE_MAP.3="€€€                €€€€€€€€€€€€€€            €€€€€€€€€€€€€€                €€€"
   k.CASTLE_MAP.4="€€€                €€€€€€€€€€€€€€            €€€€€€€€€€€€€€                €€€"
   k.CASTLE_MAP.5="€€€                €€€€€€€€€€€€€€            €€€€€€€€€€€€€€                €€€"
   k.CASTLE_MAP.6="€€€                €€€€€€€€€€€€€€            €€€€€€€€€€€€€€                €€€"
   k.CASTLE_MAP.7="€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€"
   k.CASTLE_MAP.8="€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€"
   k.CASTLE_MAP.9="€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€"
  k.CASTLE_MAP.10="€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€"
  k.CASTLE_MAP.11="€€€                    €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                    €€€"
  k.CASTLE_MAP.12="€€€                    €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                    €€€"
  k.CASTLE_MAP.13="€€€                    €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                    €€€"
  k.CASTLE_MAP.14="€€€                    €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                    €€€"
  k.CASTLE_MAP.15="€€€                    €€€€€€€€€€€€        €€€€€€€€€€€€                    €€€"
  k.CASTLE_MAP.16="€€€                    €€€€€€€€€€€€        €€€€€€€€€€€€                    €€€"
  k.CASTLE_MAP.17="€€€                    €€€€€€€€€€€€        €€€€€€€€€€€€                    €€€"
  k.CASTLE_MAP.18="€€€                    €€€€€€€€€€€€        €€€€€€€€€€€€                    €€€"
  k.CASTLE_MAP.19="€€€                                                                        €€€"
  k.CASTLE_MAP.20="€€€                                                                        €€€"
  k.CASTLE_MAP.21="€€€                                                                        €€€"
  k.CASTLE_MAP.22="€€€                                                                        €€€"
  k.CASTLE_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.CASTLE_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.TOP_MAP.1="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.TOP_MAP.2="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.TOP_MAP.3="€€€                                                                        €€€"
   k.TOP_MAP.4="€€€                                                                        €€€"
   k.TOP_MAP.5="€€€                                                                        €€€"
   k.TOP_MAP.6="€€€                                                                        €€€"
   k.TOP_MAP.7="€€€                                                                        €€€"
   k.TOP_MAP.8="€€€                                                                        €€€"
   k.TOP_MAP.9="€€€                                                                        €€€"
  k.TOP_MAP.10="€€€                                                                        €€€"
  k.TOP_MAP.11="€€€                                                                        €€€"
  k.TOP_MAP.12="€€€                                                                        €€€"
  k.TOP_MAP.13="€€€                                                                        €€€"
  k.TOP_MAP.14="€€€                                                                        €€€"
  k.TOP_MAP.15="€€€                                                                        €€€"
  k.TOP_MAP.16="€€€                                                                        €€€"
  k.TOP_MAP.17="€€€                                                                        €€€"
  k.TOP_MAP.18="€€€                                                                        €€€"
  k.TOP_MAP.19="€€€                                                                        €€€"
  k.TOP_MAP.20="€€€                                                                        €€€"
  k.TOP_MAP.21="€€€                                                                        €€€"
  k.TOP_MAP.22="€€€                                                                        €€€"
  k.TOP_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.TOP_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.TOP_RHT_MAP.1="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€M€€€"
   k.TOP_RHT_MAP.2="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€M€€€"
   k.TOP_RHT_MAP.3="                                                                          M   "
   k.TOP_RHT_MAP.4="                                                                          M   "
   k.TOP_RHT_MAP.5="                                                                          M   "
   k.TOP_RHT_MAP.6="                                                                          M   "
   k.TOP_RHT_MAP.7="                                                                          M   "
   k.TOP_RHT_MAP.8="                                                                          M   "
   k.TOP_RHT_MAP.9="                                                                          M   "
  k.TOP_RHT_MAP.10="                                                                          M   "
  k.TOP_RHT_MAP.11="                                                                          M   "
  k.TOP_RHT_MAP.12="                                                                          M   "
  k.TOP_RHT_MAP.13="                                                                          M   "
  k.TOP_RHT_MAP.14="                                                                          M   "
  k.TOP_RHT_MAP.15="                                                                          M   "
  k.TOP_RHT_MAP.16="                                                                          M   "
  k.TOP_RHT_MAP.17="                                                                          M   "
  k.TOP_RHT_MAP.18="                                                                          M   "
  k.TOP_RHT_MAP.19="                                                                          M   "
  k.TOP_RHT_MAP.20="                                                                          M   "
  k.TOP_RHT_MAP.21="                                                                          M   "
  k.TOP_RHT_MAP.22="                                                                          M   "
  k.TOP_RHT_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€M€€€"
  k.TOP_RHT_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€M€€€"

   k.MIDDLE_MAP.1="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.MIDDLE_MAP.2="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.MIDDLE_MAP.3="€€€                                                                        €€€"
   k.MIDDLE_MAP.4="€€€                                                                        €€€"
   k.MIDDLE_MAP.5="€€€                                                                        €€€"
   k.MIDDLE_MAP.6="€€€                                                                        €€€"
   k.MIDDLE_MAP.7="€€€                                                                        €€€"
   k.MIDDLE_MAP.8="€€€                                                                        €€€"
   k.MIDDLE_MAP.9="€€€                                                                        €€€"
  k.MIDDLE_MAP.10="€€€                                                                        €€€"
  k.MIDDLE_MAP.11="€€€                                                                        €€€"
  k.MIDDLE_MAP.12="€€€                                                                        €€€"
  k.MIDDLE_MAP.13="€€€                                                                        €€€"
  k.MIDDLE_MAP.14="€€€                                                                        €€€"
  k.MIDDLE_MAP.15="€€€                                                                        €€€"
  k.MIDDLE_MAP.16="€€€                                                                        €€€"
  k.MIDDLE_MAP.17="€€€                                                                        €€€"
  k.MIDDLE_MAP.18="€€€                                                                        €€€"
  k.MIDDLE_MAP.19="€€€                                                                        €€€"
  k.MIDDLE_MAP.20="€€€                                                                        €€€"
  k.MIDDLE_MAP.21="€€€                                                                        €€€"
  k.MIDDLE_MAP.22="€€€                                                                        €€€"
  k.MIDDLE_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.MIDDLE_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.MIDDLE_LFT_MAP.1="€€€M€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.MIDDLE_LFT_MAP.2="€€€M€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.MIDDLE_LFT_MAP.3="   M                                                                          "
   k.MIDDLE_LFT_MAP.4="   M                                                                          "
   k.MIDDLE_LFT_MAP.5="   M                                                                          "
   k.MIDDLE_LFT_MAP.6="   M                                                                          "
   k.MIDDLE_LFT_MAP.7="   M                                                                          "
   k.MIDDLE_LFT_MAP.8="   M                                                                          "
   k.MIDDLE_LFT_MAP.9="   M                                                                          "
  k.MIDDLE_LFT_MAP.10="   M                                                                          "
  k.MIDDLE_LFT_MAP.11="   M                                                                          "
  k.MIDDLE_LFT_MAP.12="   M                                                                          "
  k.MIDDLE_LFT_MAP.13="   M                                                                          "
  k.MIDDLE_LFT_MAP.14="   M                                                                          "
  k.MIDDLE_LFT_MAP.15="   M                                                                          "
  k.MIDDLE_LFT_MAP.16="   M                                                                          "
  k.MIDDLE_LFT_MAP.17="   M                                                                          "
  k.MIDDLE_LFT_MAP.18="   M                                                                          "
  k.MIDDLE_LFT_MAP.19="   M                                                                          "
  k.MIDDLE_LFT_MAP.20="   M                                                                          "
  k.MIDDLE_LFT_MAP.21="   M                                                                          "
  k.MIDDLE_LFT_MAP.22="   M                                                                          "
  k.MIDDLE_LFT_MAP.23="€€€M€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.MIDDLE_LFT_MAP.24="€€€M€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  
   k.MIDDLE_RHT_MAP.1="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€M€€€"
   k.MIDDLE_RHT_MAP.2="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€M€€€"
   k.MIDDLE_RHT_MAP.3="                                                                          M   "
   k.MIDDLE_RHT_MAP.4="                                                                          M   "
   k.MIDDLE_RHT_MAP.5="                                                                          M   "
   k.MIDDLE_RHT_MAP.6="                                                                          M   "
   k.MIDDLE_RHT_MAP.7="                                                                          M   "
   k.MIDDLE_RHT_MAP.8="                                                                          M   "
   k.MIDDLE_RHT_MAP.9="                                                                          M   "
  k.MIDDLE_RHT_MAP.10="                                                                          M   "
  k.MIDDLE_RHT_MAP.11="                                                                          M   "
  k.MIDDLE_RHT_MAP.12="                                                                          M   "
  k.MIDDLE_RHT_MAP.13="                                                                          M   "
  k.MIDDLE_RHT_MAP.14="                                                                          M   "
  k.MIDDLE_RHT_MAP.15="                                                                          M   "
  k.MIDDLE_RHT_MAP.16="                                                                          M   "
  k.MIDDLE_RHT_MAP.17="                                                                          M   "
  k.MIDDLE_RHT_MAP.18="                                                                          M   "
  k.MIDDLE_RHT_MAP.19="                                                                          M   "
  k.MIDDLE_RHT_MAP.20="                                                                          M   "
  k.MIDDLE_RHT_MAP.21="                                                                          M   "
  k.MIDDLE_RHT_MAP.22="                                                                          M   "
  k.MIDDLE_RHT_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€M€€€"
  k.MIDDLE_RHT_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€M€€€"

   k.BOTTOM_MID_MAP.1="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BOTTOM_MID_MAP.2="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BOTTOM_MID_MAP.3="                                                                              "
   k.BOTTOM_MID_MAP.4="                                                                              "
   k.BOTTOM_MID_MAP.5="                                                                              "
   k.BOTTOM_MID_MAP.6="                                                                              "
   k.BOTTOM_MID_MAP.7="                                                                              "
   k.BOTTOM_MID_MAP.8="                                                                              "
   k.BOTTOM_MID_MAP.9="                                                                              "
  k.BOTTOM_MID_MAP.10="                                                                              "
  k.BOTTOM_MID_MAP.11="                                                                              "
  k.BOTTOM_MID_MAP.12="                                                                              "
  k.BOTTOM_MID_MAP.13="                                                                              "
  k.BOTTOM_MID_MAP.14="                                                                              "
  k.BOTTOM_MID_MAP.15="                                                                              "
  k.BOTTOM_MID_MAP.16="                                                                              "
  k.BOTTOM_MID_MAP.17="                                                                              "
  k.BOTTOM_MID_MAP.18="                                                                              "
  k.BOTTOM_MID_MAP.19="                                                                              "
  k.BOTTOM_MID_MAP.20="                                                                              "
  k.BOTTOM_MID_MAP.21="                                                                              "
  k.BOTTOM_MID_MAP.22="                                                                              "
  k.BOTTOM_MID_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BOTTOM_MID_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.BOTTOM_LFT_MAP.1="€€€M€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BOTTOM_LFT_MAP.2="€€€M€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BOTTOM_LFT_MAP.3="   M                                                                          "
   k.BOTTOM_LFT_MAP.4="   M                                                                          "
   k.BOTTOM_LFT_MAP.5="   M                                                                          "
   k.BOTTOM_LFT_MAP.6="   M                                                                          "
   k.BOTTOM_LFT_MAP.7="   M                                                                          "
   k.BOTTOM_LFT_MAP.8="   M                                                                          "
   k.BOTTOM_LFT_MAP.9="   M                                                                          "
  k.BOTTOM_LFT_MAP.10="   M                                                                          "
  k.BOTTOM_LFT_MAP.11="   M                                                                          "
  k.BOTTOM_LFT_MAP.12="   M                                                                          "
  k.BOTTOM_LFT_MAP.13="   M                                                                          "
  k.BOTTOM_LFT_MAP.14="   M                                                                          "
  k.BOTTOM_LFT_MAP.15="   M                                                                          "
  k.BOTTOM_LFT_MAP.16="   M                                                                          "
  k.BOTTOM_LFT_MAP.17="   M                                                                          "
  k.BOTTOM_LFT_MAP.18="   M                                                                          "
  k.BOTTOM_LFT_MAP.19="   M                                                                          "
  k.BOTTOM_LFT_MAP.20="   M                                                                          "
  k.BOTTOM_LFT_MAP.21="   M                                                                          "
  k.BOTTOM_LFT_MAP.22="   M                                                                          "
  k.BOTTOM_LFT_MAP.23="€€€M€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BOTTOM_LFT_MAP.24="€€€M€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.BOTTOM_MAP.1="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BOTTOM_MAP.2="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BOTTOM_MAP.3="€€€                                                                        €€€"
   k.BOTTOM_MAP.4="€€€                                                                        €€€"
   k.BOTTOM_MAP.5="€€€                                                                        €€€"
   k.BOTTOM_MAP.6="€€€                                                                        €€€"
   k.BOTTOM_MAP.7="€€€                                                                        €€€"
   k.BOTTOM_MAP.8="€€€                                                                        €€€"
   k.BOTTOM_MAP.9="€€€                                                                        €€€"
  k.BOTTOM_MAP.10="€€€                                                                        €€€"
  k.BOTTOM_MAP.11="€€€                                                                        €€€"
  k.BOTTOM_MAP.12="€€€                                                                        €€€"
  k.BOTTOM_MAP.13="€€€                                                                        €€€"
  k.BOTTOM_MAP.14="€€€                                                                        €€€"
  k.BOTTOM_MAP.15="€€€                                                                        €€€"
  k.BOTTOM_MAP.16="€€€                                                                        €€€"
  k.BOTTOM_MAP.17="€€€                                                                        €€€"
  k.BOTTOM_MAP.18="€€€                                                                        €€€"
  k.BOTTOM_MAP.19="€€€                                                                        €€€"
  k.BOTTOM_MAP.20="€€€                                                                        €€€"
  k.BOTTOM_MAP.21="€€€                                                                        €€€"
  k.BOTTOM_MAP.22="€€€                                                                        €€€"
  k.BOTTOM_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BOTTOM_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.BMAZE0_MAP.1="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BMAZE0_MAP.2="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BMAZE0_MAP.3="             €€€€€        €€€€€                €€€€€        €€€€€             "
   k.BMAZE0_MAP.4="             €€€€€        €€€€€                €€€€€        €€€€€             "
   k.BMAZE0_MAP.5="             €€€€€        €€€€€                €€€€€        €€€€€             "
   k.BMAZE0_MAP.6="             €€€€€        €€€€€                €€€€€        €€€€€             "
   k.BMAZE0_MAP.7="€€€€€        €€€€€        €€€€€€€€€        €€€€€€€€€        €€€€€        €€€€€"
   k.BMAZE0_MAP.8="€€€€€        €€€€€        €€€€€€€€€        €€€€€€€€€        €€€€€        €€€€€"
   k.BMAZE0_MAP.9="€€€€€        €€€€€        €€€€€€€€€        €€€€€€€€€        €€€€€        €€€€€"
  k.BMAZE0_MAP.10="€€€€€        €€€€€        €€€€€€€€€        €€€€€€€€€        €€€€€        €€€€€"
  k.BMAZE0_MAP.11="€€€€€        €€€€€                                          €€€€€        €€€€€"
  k.BMAZE0_MAP.12="€€€€€        €€€€€                                          €€€€€        €€€€€"
  k.BMAZE0_MAP.13="€€€€€        €€€€€                                          €€€€€        €€€€€"
  k.BMAZE0_MAP.14="€€€€€        €€€€€                                          €€€€€        €€€€€"
  k.BMAZE0_MAP.15="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€        €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BMAZE0_MAP.16="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€        €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BMAZE0_MAP.17="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€        €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BMAZE0_MAP.18="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€        €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BMAZE0_MAP.19="         €€€€                  €€€€        €€€€                  €€€€         "
  k.BMAZE0_MAP.20="         €€€€                  €€€€        €€€€                  €€€€         "
  k.BMAZE0_MAP.21="         €€€€                  €€€€        €€€€                  €€€€         "
  k.BMAZE0_MAP.22="         €€€€                  €€€€        €€€€                  €€€€         "
  k.BMAZE0_MAP.23="€€€€     €€€€     €€€€€€€€€€€€€€€€€        €€€€€€€€€€€€€€€€€     €€€€     €€€€"
  k.BMAZE0_MAP.24="€€€€     €€€€     €€€€€€€€€€€€€€€€€        €€€€€€€€€€€€€€€€€     €€€€     €€€€"

   k.BMAZE1_MAP.1="€€€€     €€€€     €€€€€€€€€€€€€€€€€        €€€€€€€€€€€€€€€€€     €€€€     €€€€"
   k.BMAZE1_MAP.2="€€€€     €€€€     €€€€€€€€€€€€€€€€€        €€€€€€€€€€€€€€€€€     €€€€     €€€€"
   k.BMAZE1_MAP.3="         €€€€              €€€€€€€€        €€€€€€€€              €€€€         "
   k.BMAZE1_MAP.4="         €€€€              €€€€€€€€        €€€€€€€€              €€€€         "
   k.BMAZE1_MAP.5="         €€€€              €€€€€€€€        €€€€€€€€              €€€€         "
   k.BMAZE1_MAP.6="         €€€€              €€€€€€€€        €€€€€€€€              €€€€         "
   k.BMAZE1_MAP.7="€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€        €€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€"
   k.BMAZE1_MAP.8="€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€        €€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€"
   k.BMAZE1_MAP.9="€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€        €€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€"
  k.BMAZE1_MAP.10="€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€        €€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€"
  k.BMAZE1_MAP.11="                  €€€€     €€€€€€€€        €€€€€€€€     €€€€                  "
  k.BMAZE1_MAP.12="                  €€€€     €€€€€€€€        €€€€€€€€     €€€€                  "
  k.BMAZE1_MAP.13="                  €€€€     €€€€€€€€        €€€€€€€€     €€€€                  "
  k.BMAZE1_MAP.14="                  €€€€     €€€€€€€€        €€€€€€€€     €€€€                  "
  k.BMAZE1_MAP.15="€€€€     €€€€     €€€€     €€€€€€€€        €€€€€€€€     €€€€     €€€€     €€€€"
  k.BMAZE1_MAP.16="€€€€     €€€€     €€€€     €€€€€€€€        €€€€€€€€     €€€€     €€€€     €€€€"
  k.BMAZE1_MAP.17="€€€€     €€€€     €€€€     €€€€€€€€        €€€€€€€€     €€€€     €€€€     €€€€"
  k.BMAZE1_MAP.18="€€€€     €€€€     €€€€     €€€€                €€€€     €€€€     €€€€     €€€€"
  k.BMAZE1_MAP.19="         €€€€     €€€€     €€€€                €€€€     €€€€     €€€€         "
  k.BMAZE1_MAP.20="         €€€€     €€€€     €€€€                €€€€     €€€€     €€€€         "
  k.BMAZE1_MAP.21="         €€€€     €€€€     €€€€                €€€€     €€€€     €€€€         "
  k.BMAZE1_MAP.22="         €€€€     €€€€     €€€€                €€€€     €€€€     €€€€         "
  k.BMAZE1_MAP.23="€€€€€€€€€€€€€     €€€€     €€€€                €€€€     €€€€     €€€€€€€€€€€€€"
  k.BMAZE1_MAP.24="€€€€€€€€€€€€€     €€€€     €€€€                €€€€     €€€€     €€€€€€€€€€€€€"

   k.BMAZE2_MAP.1="€€€€€€€€€€€€€     €€€€     €€€€                €€€€     €€€€     €€€€€€€€€€€€€"
   k.BMAZE2_MAP.2="€€€€€€€€€€€€€     €€€€     €€€€                €€€€     €€€€     €€€€€€€€€€€€€"
   k.BMAZE2_MAP.3="         €€€€              €€€€                €€€€              €€€€         "
   k.BMAZE2_MAP.4="         €€€€              €€€€                €€€€              €€€€         "
   k.BMAZE2_MAP.5="         €€€€              €€€€                €€€€              €€€€         "
   k.BMAZE2_MAP.6="         €€€€              €€€€                €€€€              €€€€         "
   k.BMAZE2_MAP.7="€€€€     €€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€     €€€€"
   k.BMAZE2_MAP.8="€€€€     €€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€     €€€€"
   k.BMAZE2_MAP.9="€€€€     €€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€     €€€€"
  k.BMAZE2_MAP.10="€€€€     €€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€     €€€€"
  k.BMAZE2_MAP.11="€€€€                                                                      €€€€"
  k.BMAZE2_MAP.12="€€€€                                                                      €€€€"
  k.BMAZE2_MAP.13="€€€€                                                                      €€€€"
  k.BMAZE2_MAP.14="€€€€                                                                      €€€€"
  k.BMAZE2_MAP.15="€€€€€€€€€€€€€                                                    €€€€€€€€€€€€€"
  k.BMAZE2_MAP.16="€€€€€€€€€€€€€                                                    €€€€€€€€€€€€€"
  k.BMAZE2_MAP.17="€€€€€€€€€€€€€                                                    €€€€€€€€€€€€€"
  k.BMAZE2_MAP.18="€€€€€€€€€€€€€                                                    €€€€€€€€€€€€€"
  k.BMAZE2_MAP.19="         €€€€                                                    €€€€         "
  k.BMAZE2_MAP.20="         €€€€                                                    €€€€         "
  k.BMAZE2_MAP.21="         €€€€                                                    €€€€         "
  k.BMAZE2_MAP.22="         €€€€                                                    €€€€         "
  k.BMAZE2_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BMAZE2_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.BMAZE3_MAP.1="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BMAZE3_MAP.2="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BMAZE3_MAP.3="                                                                              "
   k.BMAZE3_MAP.4="                                                                              "
   k.BMAZE3_MAP.5="                                                                              "
   k.BMAZE3_MAP.6="                                                                              "
   k.BMAZE3_MAP.7="€€€€€€€€€€€€€€€€€€    €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€    €€€€€€€€€€€€€€€€€€"
   k.BMAZE3_MAP.8="€€€€€€€€€€€€€€€€€€    €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€    €€€€€€€€€€€€€€€€€€"
   k.BMAZE3_MAP.9="€€€€€€€€€€€€€€€€€€    €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€    €€€€€€€€€€€€€€€€€€"
  k.BMAZE3_MAP.10="€€€€€€€€€€€€€€€€€€    €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€    €€€€€€€€€€€€€€€€€€"
  k.BMAZE3_MAP.11="€€€€                                €€€€€€                                €€€€"
  k.BMAZE3_MAP.12="€€€€                                €€€€€€                                €€€€"
  k.BMAZE3_MAP.13="€€€€                                €€€€€€                                €€€€"
  k.BMAZE3_MAP.14="€€€€                                €€€€€€                                €€€€"
  k.BMAZE3_MAP.15="€€€€     €€€€€€€€€€€€€€€€€€€€€€     €€€€€€     €€€€€€€€€€€€€€€€€€€€€€     €€€€"
  k.BMAZE3_MAP.16="€€€€     €€€€€€€€€€€€€€€€€€€€€€     €€€€€€     €€€€€€€€€€€€€€€€€€€€€€     €€€€"
  k.BMAZE3_MAP.17="€€€€     €€€€€€€€€€€€€€€€€€€€€€     €€€€€€     €€€€€€€€€€€€€€€€€€€€€€     €€€€"
  k.BMAZE3_MAP.18="€€€€     €€€€€€€€€€€€€€€€€€€€€€     €€€€€€     €€€€€€€€€€€€€€€€€€€€€€     €€€€"
  k.BMAZE3_MAP.19="         €€€€              €€€€     €€€€€€     €€€€              €€€€         "
  k.BMAZE3_MAP.20="         €€€€              €€€€     €€€€€€     €€€€              €€€€         "
  k.BMAZE3_MAP.21="         €€€€              €€€€     €€€€€€     €€€€              €€€€         "
  k.BMAZE3_MAP.22="         €€€€              €€€€     €€€€€€     €€€€              €€€€         "
  k.BMAZE3_MAP.23="€€€€€€€€€€€€€     €€€€     €€€€     €€€€€€     €€€€     €€€€     €€€€€€€€€€€€€"
  k.BMAZE3_MAP.24="€€€€€€€€€€€€€     €€€€     €€€€     €€€€€€     €€€€     €€€€     €€€€€€€€€€€€€"

   k.BMAZE4_MAP.1="€€€€€€€€€€€€€     €€€€     €€€€     €€€€€€     €€€€     €€€€     €€€€€€€€€€€€€"
   k.BMAZE4_MAP.2="€€€€€€€€€€€€€     €€€€     €€€€     €€€€€€     €€€€     €€€€     €€€€€€€€€€€€€"
   k.BMAZE4_MAP.3="         €€€€     €€€€     €€€€                €€€€     €€€€     €€€€         "
   k.BMAZE4_MAP.4="         €€€€     €€€€     €€€€                €€€€     €€€€     €€€€         "
   k.BMAZE4_MAP.5="         €€€€     €€€€     €€€€                €€€€     €€€€     €€€€         "
   k.BMAZE4_MAP.6="         €€€€     €€€€     €€€€                €€€€     €€€€     €€€€         "
   k.BMAZE4_MAP.7="€€€€     €€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€     €€€€"
   k.BMAZE4_MAP.8="€€€€     €€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€     €€€€"
   k.BMAZE4_MAP.9="€€€€     €€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€     €€€€"
  k.BMAZE4_MAP.10="€€€€     €€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€     €€€€"
  k.BMAZE4_MAP.11="         €€€€     €€€€                                  €€€€     €€€€         "
  k.BMAZE4_MAP.12="         €€€€     €€€€                                  €€€€     €€€€         "
  k.BMAZE4_MAP.13="         €€€€     €€€€                                  €€€€     €€€€         "
  k.BMAZE4_MAP.14="         €€€€     €€€€                                  €€€€     €€€€         "
  k.BMAZE4_MAP.15="€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€"
  k.BMAZE4_MAP.16="€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€"
  k.BMAZE4_MAP.17="€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€"
  k.BMAZE4_MAP.18="€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€"
  k.BMAZE4_MAP.19="                                                                              "
  k.BMAZE4_MAP.20="                                                                              "
  k.BMAZE4_MAP.21="                                                                              "
  k.BMAZE4_MAP.22="                                                                              "
  k.BMAZE4_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BMAZE4_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.IMAZE0_MAP.1="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.IMAZE0_MAP.2="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.IMAZE0_MAP.3="        €€€€                                                      €€€€        "
   k.IMAZE0_MAP.4="        €€€€                                                      €€€€        "
   k.IMAZE0_MAP.5="        €€€€                                                      €€€€        "
   k.IMAZE0_MAP.6="        €€€€                                                      €€€€        "
   k.IMAZE0_MAP.7="€€€€    €€€€         €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€         €€€€    €€€€"
   k.IMAZE0_MAP.8="€€€€    €€€€         €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€         €€€€    €€€€"
   k.IMAZE0_MAP.9="€€€€    €€€€         €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€         €€€€    €€€€"
  k.IMAZE0_MAP.10="€€€€    €€€€         €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€         €€€€    €€€€"
  k.IMAZE0_MAP.11="        €€€€                       €€€€€€€€                       €€€€        "
  k.IMAZE0_MAP.12="        €€€€                       €€€€€€€€                       €€€€        "
  k.IMAZE0_MAP.13="        €€€€                       €€€€€€€€                       €€€€        "
  k.IMAZE0_MAP.14="        €€€€                       €€€€€€€€                       €€€€        "
  k.IMAZE0_MAP.15="€€€€€€€€€€€€     €€€€              €€€€€€€€              €€€€     €€€€€€€€€€€€"
  k.IMAZE0_MAP.16="€€€€€€€€€€€€     €€€€              €€€€€€€€              €€€€     €€€€€€€€€€€€"
  k.IMAZE0_MAP.17="€€€€€€€€€€€€     €€€€              €€€€€€€€              €€€€     €€€€€€€€€€€€"
  k.IMAZE0_MAP.18="€€€€€€€€€€€€     €€€€              €€€€€€€€              €€€€     €€€€€€€€€€€€"
  k.IMAZE0_MAP.19="                 €€€€              €€€€€€€€              €€€€                 "
  k.IMAZE0_MAP.20="                 €€€€              €€€€€€€€              €€€€                 "
  k.IMAZE0_MAP.21="                 €€€€              €€€€€€€€              €€€€                 "
  k.IMAZE0_MAP.22="                 €€€€              €€€€€€€€              €€€€                 "
  k.IMAZE0_MAP.23="€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€"
  k.IMAZE0_MAP.24="€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€"

   k.IMAZE1_MAP.1="€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€"
   k.IMAZE1_MAP.2="€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€"
   k.IMAZE1_MAP.3="                          €€€€     €€€€€€€€     €€€€                          "
   k.IMAZE1_MAP.4="                          €€€€     €€€€€€€€     €€€€                          "
   k.IMAZE1_MAP.5="                          €€€€     €€€€€€€€     €€€€                          "
   k.IMAZE1_MAP.6="                          €€€€     €€€€€€€€     €€€€                          "
   k.IMAZE1_MAP.7="€€€€             €€€€€€€€€€€€€     €€€€€€€€     €€€€€€€€€€€€€             €€€€"
   k.IMAZE1_MAP.8="€€€€             €€€€€€€€€€€€€     €€€€€€€€     €€€€€€€€€€€€€             €€€€"
   k.IMAZE1_MAP.9="€€€€             €€€€€€€€€€€€€     €€€€€€€€     €€€€€€€€€€€€€             €€€€"
  k.IMAZE1_MAP.10="€€€€             €€€€€€€€€€€€€     €€€€€€€€     €€€€€€€€€€€€€             €€€€"
  k.IMAZE1_MAP.11="                 €€€€                                    €€€€                 "
  k.IMAZE1_MAP.12="                 €€€€                                    €€€€                 "
  k.IMAZE1_MAP.13="                 €€€€                                    €€€€                 "
  k.IMAZE1_MAP.14="                 €€€€                                    €€€€                 "
  k.IMAZE1_MAP.15="€€€€€€€€€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€€€€€€€€€"
  k.IMAZE1_MAP.16="€€€€€€€€€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€€€€€€€€€"
  k.IMAZE1_MAP.17="€€€€€€€€€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€€€€€€€€€"
  k.IMAZE1_MAP.18="€€€€€€€€€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€€€€€€€€€"
  k.IMAZE1_MAP.19="        €€€€     €€€€     €€€€                  €€€€     €€€€     €€€€        "
  k.IMAZE1_MAP.20="        €€€€     €€€€     €€€€                  €€€€     €€€€     €€€€        "
  k.IMAZE1_MAP.21="        €€€€     €€€€     €€€€                  €€€€     €€€€     €€€€        "
  k.IMAZE1_MAP.22="        €€€€     €€€€     €€€€                  €€€€     €€€€     €€€€        "
  k.IMAZE1_MAP.23="€€€€    €€€€     €€€€     €€€€     €€€€€€€€     €€€€     €€€€     €€€€    €€€€"
  k.IMAZE1_MAP.24="€€€€    €€€€     €€€€     €€€€     €€€€€€€€     €€€€     €€€€     €€€€    €€€€"

   k.IMAZE2_MAP.1="€€€€    €€€€     €€€€     €€€€     €€€€€€€€     €€€€     €€€€     €€€€    €€€€"
   k.IMAZE2_MAP.2="€€€€    €€€€     €€€€     €€€€     €€€€€€€€     €€€€     €€€€     €€€€    €€€€"
   k.IMAZE2_MAP.3="        €€€€              €€€€     €€€€€€€€     €€€€              €€€€        "
   k.IMAZE2_MAP.4="        €€€€              €€€€     €€€€€€€€     €€€€              €€€€        "
   k.IMAZE2_MAP.5="        €€€€              €€€€     €€€€€€€€     €€€€              €€€€        "
   k.IMAZE2_MAP.6="        €€€€              €€€€     €€€€€€€€     €€€€              €€€€        "
   k.IMAZE2_MAP.7="        €€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€        "
   k.IMAZE2_MAP.8="        €€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€        "
   k.IMAZE2_MAP.9="        €€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€        "
  k.IMAZE2_MAP.10="        €€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€        "
  k.IMAZE2_MAP.11="                                   €€€€€€€€                                   "
  k.IMAZE2_MAP.12="                                   €€€€€€€€                                   "
  k.IMAZE2_MAP.13="                                   €€€€€€€€                                   "
  k.IMAZE2_MAP.14="                                   €€€€€€€€                                   "
  k.IMAZE2_MAP.15="        €€€€€€€€€€€€€€€€€€         €€€€€€€€         €€€€€€€€€€€€€€€€€€        "
  k.IMAZE2_MAP.16="        €€€€€€€€€€€€€€€€€€         €€€€€€€€         €€€€€€€€€€€€€€€€€€        "
  k.IMAZE2_MAP.17="        €€€€€€€€€€€€€€€€€€         €€€€€€€€         €€€€€€€€€€€€€€€€€€        "
  k.IMAZE2_MAP.18="        €€€€€€€€€€€€€€€€€€         €€€€€€€€         €€€€€€€€€€€€€€€€€€        "
  k.IMAZE2_MAP.19="        €€€€                       €€€€€€€€                       €€€€        "
  k.IMAZE2_MAP.20="        €€€€                       €€€€€€€€                       €€€€        "
  k.IMAZE2_MAP.21="        €€€€                       €€€€€€€€                       €€€€        "
  k.IMAZE2_MAP.22="        €€€€                       €€€€€€€€                       €€€€        "
  k.IMAZE2_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.IMAZE2_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.BCMAZE0_MAP.1="€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BCMAZE0_MAP.2="€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BCMAZE0_MAP.3="                   €€€€                   €€€€                                "
   k.BCMAZE0_MAP.4="                   €€€€                   €€€€                                "
   k.BCMAZE0_MAP.5="                   €€€€                   €€€€                                "
   k.BCMAZE0_MAP.6="                   €€€€                   €€€€                                "
   k.BCMAZE0_MAP.7="€€€€€€€€€€€€€€€€€€€€€€€                   €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BCMAZE0_MAP.8="€€€€€€€€€€€€€€€€€€€€€€€                   €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BCMAZE0_MAP.9="€€€€€€€€€€€€€€€€€€€€€€€                   €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE0_MAP.10="€€€€€€€€€€€€€€€€€€€€€€€                   €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE0_MAP.11="                                                                              "
  k.BCMAZE0_MAP.12="                                                                              "
  k.BCMAZE0_MAP.13="                                                                              "
  k.BCMAZE0_MAP.14="                                                                              "
  k.BCMAZE0_MAP.15="€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€"
  k.BCMAZE0_MAP.16="€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€"
  k.BCMAZE0_MAP.17="€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€"
  k.BCMAZE0_MAP.18="€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€"
  k.BCMAZE0_MAP.19="          €€€€                                     €€€€                       "
  k.BCMAZE0_MAP.20="          €€€€                                     €€€€                       "
  k.BCMAZE0_MAP.21="          €€€€                                     €€€€                       "
  k.BCMAZE0_MAP.22="          €€€€                                     €€€€                       "
  k.BCMAZE0_MAP.23="€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE0_MAP.24="€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.BCMAZE1_MAP.1="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BCMAZE1_MAP.2="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BCMAZE1_MAP.3="                                    €€€€                                  €€€€"
   k.BCMAZE1_MAP.4="                                    €€€€                                  €€€€"
   k.BCMAZE1_MAP.5="                                    €€€€                                  €€€€"
   k.BCMAZE1_MAP.6="                                    €€€€                                  €€€€"
   k.BCMAZE1_MAP.7="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€"
   k.BCMAZE1_MAP.8="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€"
   k.BCMAZE1_MAP.9="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€"
  k.BCMAZE1_MAP.10="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€"
  k.BCMAZE1_MAP.11="                           €€€€                                  €€€€         "
  k.BCMAZE1_MAP.12="                           €€€€                                  €€€€         "
  k.BCMAZE1_MAP.13="                           €€€€                                  €€€€         "
  k.BCMAZE1_MAP.14="                           €€€€                                  €€€€         "
  k.BCMAZE1_MAP.15="€€€€€€€€€         €€€€€€€€€€€€€€€€€€€€€€€€€€€€€         €€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE1_MAP.16="€€€€€€€€€         €€€€€€€€€€€€€€€€€€€€€€€€€€€€€         €€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE1_MAP.17="€€€€€€€€€         €€€€€€€€€€€€€€€€€€€€€€€€€€€€€         €€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE1_MAP.18="€€€€€€€€€         €€€€€€€€€€€€€€€€€€€€€€€€€€€€€         €€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE1_MAP.19="                  €€€€              €€€                 €€€€              €€€€"
  k.BCMAZE1_MAP.20="                  €€€€              €€€                 €€€€              €€€€"
  k.BCMAZE1_MAP.21="                  €€€€              €€€                 €€€€              €€€€"
  k.BCMAZE1_MAP.22="                  €€€€              €€€                 €€€€              €€€€"
  k.BCMAZE1_MAP.23="€€€€     €€€€     €€€€     €€€€     €€€€€€     €€€€     €€€€     €€€€     €€€€"
  k.BCMAZE1_MAP.24="€€€€     €€€€     €€€€     €€€€     €€€€€€     €€€€     €€€€     €€€€     €€€€"

   k.BCMAZE2_MAP.1="€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BCMAZE2_MAP.2="€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BCMAZE2_MAP.3="€€€€                             €€€€                                         "
   k.BCMAZE2_MAP.4="€€€€                             €€€€                                         "
   k.BCMAZE2_MAP.5="€€€€                             €€€€                                         "
   k.BCMAZE2_MAP.6="€€€€                             €€€€                                         "
   k.BCMAZE2_MAP.7="€€€€      €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BCMAZE2_MAP.8="€€€€      €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BCMAZE2_MAP.9="€€€€      €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE2_MAP.10="€€€€      €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE2_MAP.11="          €€€€                            €€€€                                "
  k.BCMAZE2_MAP.12="          €€€€                            €€€€                                "
  k.BCMAZE2_MAP.13="          €€€€                            €€€€                                "
  k.BCMAZE2_MAP.14="          €€€€                            €€€€                                "
  k.BCMAZE2_MAP.15="€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE2_MAP.16="€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE2_MAP.17="€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE2_MAP.18="€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE2_MAP.19="€€€€               €€€€          €€€€              €€€€                       "
  k.BCMAZE2_MAP.20="€€€€               €€€€          €€€€              €€€€                       "
  k.BCMAZE2_MAP.21="€€€€               €€€€          €€€€              €€€€                       "
  k.BCMAZE2_MAP.22="€€€€               €€€€          €€€€              €€€€                       "
  k.BCMAZE2_MAP.23="€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE2_MAP.24="€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.BCMAZE3_MAP.1="€€€€     €€€€     €€€€     €€€€     €€€€€€     €€€€     €€€€     €€€€     €€€€"
   k.BCMAZE3_MAP.2="€€€€     €€€€     €€€€     €€€€     €€€€€€     €€€€     €€€€     €€€€     €€€€"
   k.BCMAZE3_MAP.3="         €€€€              €€€€     €€€€€€     €€€€              €€€€         "
   k.BCMAZE3_MAP.4="         €€€€              €€€€     €€€€€€     €€€€              €€€€         "
   k.BCMAZE3_MAP.5="         €€€€              €€€€     €€€€€€     €€€€              €€€€         "
   k.BCMAZE3_MAP.6="         €€€€              €€€€     €€€€€€     €€€€              €€€€         "
   k.BCMAZE3_MAP.7="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BCMAZE3_MAP.8="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.BCMAZE3_MAP.9="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE3_MAP.10="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE3_MAP.11="                                                                              "
  k.BCMAZE3_MAP.12="                                                                              "
  k.BCMAZE3_MAP.13="                                                                              "
  k.BCMAZE3_MAP.14="                                                                              "
  k.BCMAZE3_MAP.15="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE3_MAP.16="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE3_MAP.17="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE3_MAP.18="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE3_MAP.19="                                                                              "
  k.BCMAZE3_MAP.20="                                                                              "
  k.BCMAZE3_MAP.21="                                                                              "
  k.BCMAZE3_MAP.22="                                                                              "
  k.BCMAZE3_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.BCMAZE3_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.WCMAZE0_MAP.1="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.WCMAZE0_MAP.2="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.WCMAZE0_MAP.3="                                                                              "
   k.WCMAZE0_MAP.4="                                                                              "
   k.WCMAZE0_MAP.5="                                                                              "
   k.WCMAZE0_MAP.6="                                                                              "
   k.WCMAZE0_MAP.7="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.WCMAZE0_MAP.8="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.WCMAZE0_MAP.9="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE0_MAP.10="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE0_MAP.11="                           €€€€                €€€€                           "
  k.WCMAZE0_MAP.12="                           €€€€                €€€€                           "
  k.WCMAZE0_MAP.13="                           €€€€                €€€€                           "
  k.WCMAZE0_MAP.14="                           €€€€                €€€€                           "
  k.WCMAZE0_MAP.15="€€€€€€€€€€€€€€€€€€€€€€     €€€€                €€€€     €€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE0_MAP.16="€€€€€€€€€€€€€€€€€€€€€€     €€€€                €€€€     €€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE0_MAP.17="€€€€€€€€€€€€€€€€€€€€€€     €€€€                €€€€     €€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE0_MAP.18="€€€€€€€€€€€€€€€€€€€€€€     €€€€                €€€€     €€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE0_MAP.19="€€€€              €€€€     €€€€     €€€€€€     €€€€     €€€€              €€€€"
  k.WCMAZE0_MAP.20="€€€€              €€€€     €€€€     €€€€€€     €€€€     €€€€              €€€€"
  k.WCMAZE0_MAP.21="€€€€              €€€€     €€€€     €€€€€€     €€€€     €€€€              €€€€"
  k.WCMAZE0_MAP.22="€€€€              €€€€     €€€€     €€€€€€     €€€€     €€€€              €€€€"
  k.WCMAZE0_MAP.23="€€€€     €€€€     €€€€€€€€€€€€€     €€€€€€     €€€€€€€€€€€€€     €€€€     €€€€"
  k.WCMAZE0_MAP.24="€€€€     €€€€     €€€€€€€€€€€€€     €€€€€€     €€€€€€€€€€€€€     €€€€     €€€€"

   k.WCMAZE1_MAP.1="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.WCMAZE1_MAP.2="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.WCMAZE1_MAP.3="                                    €€€€€€                                    "
   k.WCMAZE1_MAP.4="                                    €€€€€€                                    "
   k.WCMAZE1_MAP.5="                                    €€€€€€                                    "
   k.WCMAZE1_MAP.6="                                    €€€€€€                                    "
   k.WCMAZE1_MAP.7="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.WCMAZE1_MAP.8="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.WCMAZE1_MAP.9="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE1_MAP.10="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE1_MAP.11="                           €€€€     €€€€€€     €€€€                           "
  k.WCMAZE1_MAP.12="                           €€€€     €€€€€€     €€€€                           "
  k.WCMAZE1_MAP.13="                           €€€€     €€€€€€     €€€€                           "
  k.WCMAZE1_MAP.14="                           €€€€     €€€€€€     €€€€                           "
  k.WCMAZE1_MAP.15="€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€"
  k.WCMAZE1_MAP.16="€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€"
  k.WCMAZE1_MAP.17="€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€"
  k.WCMAZE1_MAP.18="€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€"
  k.WCMAZE1_MAP.19="€€€€     €€€€     €€€€                                  €€€€     €€€€     €€€€"
  k.WCMAZE1_MAP.20="€€€€     €€€€     €€€€                                  €€€€     €€€€     €€€€"
  k.WCMAZE1_MAP.21="€€€€     €€€€     €€€€                                  €€€€     €€€€     €€€€"
  k.WCMAZE1_MAP.22="€€€€     €€€€     €€€€                                  €€€€     €€€€     €€€€"
  k.WCMAZE1_MAP.23="€€€€     €€€€€€€€€€€€€     €€€€                €€€€     €€€€€€€€€€€€€     €€€€"
  k.WCMAZE1_MAP.24="€€€€     €€€€€€€€€€€€€     €€€€                €€€€     €€€€€€€€€€€€€     €€€€"

   k.WCMAZE2_MAP.1="€€€€     €€€€     €€€€€€€€€€€€€     €€€€€€     €€€€€€€€€€€€€     €€€€     €€€€"
   k.WCMAZE2_MAP.2="€€€€     €€€€     €€€€€€€€€€€€€     €€€€€€     €€€€€€€€€€€€€     €€€€     €€€€"
   k.WCMAZE2_MAP.3="€€€€     €€€€                                                    €€€€     €€€€"
   k.WCMAZE2_MAP.4="€€€€     €€€€                                                    €€€€     €€€€"
   k.WCMAZE2_MAP.5="€€€€     €€€€                                                    €€€€     €€€€"
   k.WCMAZE2_MAP.6="€€€€     €€€€                                                    €€€€     €€€€"
   k.WCMAZE2_MAP.7="€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€"
   k.WCMAZE2_MAP.8="€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€"
   k.WCMAZE2_MAP.9="€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€"
  k.WCMAZE2_MAP.10="€€€€     €€€€     €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€     €€€€     €€€€"
  k.WCMAZE2_MAP.11="         €€€€     €€€€                                  €€€€     €€€€         "
  k.WCMAZE2_MAP.12="         €€€€     €€€€                                  €€€€     €€€€         "
  k.WCMAZE2_MAP.13="         €€€€     €€€€                                  €€€€     €€€€         "
  k.WCMAZE2_MAP.14="         €€€€     €€€€                                  €€€€     €€€€         "
  k.WCMAZE2_MAP.15="€€€€€€€€€€€€€€€€€€€€€€                                  €€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE2_MAP.16="€€€€€€€€€€€€€€€€€€€€€€                                  €€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE2_MAP.17="€€€€€€€€€€€€€€€€€€€€€€                                  €€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE2_MAP.18="€€€€€€€€€€€€€€€€€€€€€€                                  €€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE2_MAP.19="                                                                              "
  k.WCMAZE2_MAP.20="                                                                              "
  k.WCMAZE2_MAP.21="                                                                              "
  k.WCMAZE2_MAP.22="                                                                              "
  k.WCMAZE2_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE2_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"

   k.WCMAZE3_MAP.1="€€€€     €€€€€€€€€€€€€     €€€€                €€€€     €€€€€€€€€€€€€     €€€€"
   k.WCMAZE3_MAP.2="€€€€     €€€€€€€€€€€€€     €€€€                €€€€     €€€€€€€€€€€€€     €€€€"
   k.WCMAZE3_MAP.3="€€€€                       €€€€                €€€€                       €€€€"
   k.WCMAZE3_MAP.4="€€€€                       €€€€                €€€€                       €€€€"
   k.WCMAZE3_MAP.5="€€€€                       €€€€                €€€€                       €€€€"
   k.WCMAZE3_MAP.6="€€€€                       €€€€                €€€€                       €€€€"
   k.WCMAZE3_MAP.7="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.WCMAZE3_MAP.8="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
   k.WCMAZE3_MAP.9="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE3_MAP.10="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE3_MAP.11="         €€€€                                                    €€€€         "
  k.WCMAZE3_MAP.12="         €€€€                                                    €€€€         "
  k.WCMAZE3_MAP.13="         €€€€                                                    €€€€         "
  k.WCMAZE3_MAP.14="         €€€€                                                    €€€€         "
  k.WCMAZE3_MAP.15="€€€€     €€€€                                                    €€€€     €€€€"
  k.WCMAZE3_MAP.16="€€€€     €€€€                                                    €€€€     €€€€"
  k.WCMAZE3_MAP.17="€€€€     €€€€                                                    €€€€     €€€€"
  k.WCMAZE3_MAP.18="€€€€     €€€€                                                    €€€€     €€€€"
  k.WCMAZE3_MAP.19="         €€€€                                                    €€€€         "
  k.WCMAZE3_MAP.20="         €€€€                                                    €€€€         "
  k.WCMAZE3_MAP.21="         €€€€                                                    €€€€         "
  k.WCMAZE3_MAP.22="         €€€€                                                    €€€€         "
  k.WCMAZE3_MAP.23="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
  k.WCMAZE3_MAP.24="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€                €€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"
RETURN

PHENOM_LOGO:  /* P H E N O M   P R O D U C T I O N S */
   phenommaxline=13
   phenom.1=" [0;40;30m[29C[1;37m.."
   phenom.2=" [0;40;30m[8C[1m‹[0m€[1m€€€€€€‹  [47m [40m€€   €€€  [47m∞‹[40m‹[47m‹[40m€€[47m‹[40m [47m∞‹[40m€€   €€[0m€[1;30mﬂ  [0m‹[1;47m‹‹[40m€[47m‹‹[0m‹ [1;30mﬂ[0m€[1m€€[47m‹[40m ..€€€[0m€[1;30mﬂ"
   phenom.3=" [10C[1;37m€€€[0mﬂ[1;30mﬂ[37m€€›-ﬂ€€   €€€  [47m±[40m€€ﬂﬂﬂﬂ ﬁ€€€€  €€›_ [47m‹[40m€€ﬂﬂﬂ€€[47m‹[40m∞ﬁ€€€[47m‹[40m‹€€€€[0mƒ[1m˙ ˙"
   phenom.4=" [6C[1;30;40m∞ [1;37m˙[0m-[1m€€€‹‹€€› [47m≤[40m€€€€€€€€  [47m≤[40m€€€€[47m±∞[40m ﬁ€€›€€ €€[47mﬂ[40m ﬁ€€›   ﬁ€€›ﬁ€[47m‹[40mﬂ€€[47m€[40mﬂ€€  [30m∞"
   phenom.5="   [1;30;40m∞ ∞∞∞∞  [1;37m€€€ﬂﬂﬂﬂ  [47m≤[40m€€ﬂﬂﬂ€€€  [47m≤[40m€€‹‹‹‹ ﬁ€€› €€€[47m€[40m›  €€€   €€€ ﬁ€[47mﬂ[40mﬂﬁ€[0mﬂ[1mﬁ€€ [30m∞∞∞∞ ∞"
   phenom.6=" [10C[1;47;37m±[40m€€[0m›    ‹€[1m€€[0m› ﬁ[1;47mﬂ[40m€€  [47m±±≤≤≤ﬂﬂ[40m ﬁ€€›  €[47m≤≤ﬂ[0m‹  ﬂ[1;47mﬂ€[40m€€[47m±ﬂ[0mﬂ [1mﬁ[47m≤±[0m‹   [1mﬁ€€[0m‹[1;30m‹"
   phenom.7=" [15C[1;30;40m∞[26C∞[16C∞[7C[0mﬂ"
   phenom.8="  [1;37;40m‹‹‹‹[0m‹[1;30m‹[0mƒ[1m-‹‹‹[0m‹[1;30m‹   [0m‹[1m‹‹[0m‹[1;30m‹  [37m‹‹‹[0m‹[1;30m‹   [37m‹‹  ‹‹   ‹‹‹ ‹‹‹‹‹ ‹‹[0m‹[1;30m‹ [0m‹[1m‹‹[0m‹   [1m‹‹  [30m‹[37m‹‹ -[0m‹[1m‹[0m‹"
   phenom.9="  [1;37;47m≤[40m€€ﬂ€€[30m‹ [47;37m≤[40m€ﬂ€[47m‹[40m [30m‹[47;37m‹[40m€ﬂﬂ€€[47m‹[40m €€ﬂ[47mﬂ[40m€[0m‹  [1;47m≤[40m€[30mﬂ[0mﬂ[1;47mﬂ[40m€ ﬁ€€ﬂ[0mﬂ [1mﬂ[47m≤[40m€ﬂ..[47m≤≤[40m [30m‹[47;37m‹[40m€ﬂﬂ€[47m€‹[40m €€[47m‹[0m‹[1;30m‹[47;37m±[40m€ [47m‹[40m€ﬂﬂ[47mﬂ[40m-˙"
   phenom.10=" -[1;37;47m±[40m€€‹€€[30mﬂ [37m€€‹€€[30mﬂ[37mﬁ€›˙˙-€[47m€[40m €€ [30m€[37m€€[0m› [1m€€  €€ €€[5C[47m±[40m€-  €€ [0mﬁ[1m€›   [47m≤≤[0m›[1m€€€€›€€ ﬂ[47mﬂ[40m€[47m‹[0m‹[1;30m‹"
  phenom.11="  [1;37m€€[47mﬂ[40mﬂ[0mﬂ[1;30mﬂ  [37m€€€[47m‹[40m . €€‹‹€€[47mﬂ[40m €€‹[47m‹[40m€€[30mﬂ [37m€€[47m‹‹[40m€€ ﬁ€€‹[0m‹[1;30m‹ [37m€€   €€  €€‹‹€€[47mﬂ[40m €€ [47mﬂ[40m€[47m€[40m€ €‹‹€€[47m±[0m"
  phenom.12=" [1;37m ﬂﬂ[30mﬂ  sM [37mﬂﬂ ﬂﬂ   [0mﬂ[1mﬂﬂ[0mﬂ[1;30mﬂ  [37mﬂﬂﬂﬂ[0mﬂ    ﬂ[1mﬂﬂ[0mﬂ   ﬂ[1mﬂﬂ[0mﬂ ﬂ[1mﬂ[0mﬂ  [1;30mﬂ[0mﬂ[1mﬂ   [0mﬂ[1mﬂﬂ[0mﬂ[1;30mﬂ  [0mﬂ[1mﬂ  [0mﬂ[1mﬂﬂ [30mﬂ[0mﬂ[1mﬂﬂ[0mﬂ"
  phenom.13="[49C[1;30;40mhttps://www.phenomprod.com"
RETURN

/* background colors *** foreground colors */
/*     black=40      ***     black=30      */ 
/*       red=41      ***       red=31      */
/*     green=42      ***     green=32      */
/*    yellow=43      ***    yellow=33      */
/*      blue=44      ***      blue=34      */
/*   magenta=45      ***   magenta=35      */
/*      cyan=46      ***      cyan=36      */
/*     white=47      ***     white=37      */

/** ERROR CHECKING *******************************************************/
CHECK:;if ARG() & ARG(1)~="###PANIC" then return ARG(1)
  getcarrier;if result="TRUE" then if ARG() then return ARG(1);else return
  logentry "Lost Carrier!!";bufferflush;exit
  
SYNTAX:;ERROR:;IOERR:;e1="n1 Error: "rc" ("errortext(rc)")"
  e2="  Line: "left(sigl,4)"File:";c="`"fp", "ver"'";e2=e2" "c;tr e1;tr e2
  logentry e1;logentry e2;e=strip(translate(sourceline(sigl),"\{",""))
  do while e~="";e3="Source: "left(e,37);tr e3;logentry e3;e=substr(e,38);end
  bufferflush
/******************************** PHENOM PRODUCTIONS www.phenomprod.com  **\
\**************************************** -X-caliber bbs.aholix.net:6800 **/